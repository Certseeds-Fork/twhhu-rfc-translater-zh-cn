{
  "title": {
    "text": "RFC 7508: Securing Header Fields with S/MIME",
    "zh-CHS": "RFC 7508"
  },
  "number": 7508,
  "created_at": "2021-10-30 21:39:36.615392+08:00",
  "updated_by": "",
  "contents": [
    {
      "indent": 0,
      "text": "Independent Submission                                       L. Cailleux\nRequest for Comments: 7508                                        DGA MI\nCategory: Experimental                                        C. Bonatti\nISSN: 2070-1721                                                     IECA\n                                                              April 2015",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 19,
      "text": "Securing Header Fields with S/MIME",
      "zh-CHS": "使用S/MIME保护头字段"
    },
    {
      "indent": 0,
      "text": "Abstract",
      "zh-CHS": "摘要"
    },
    {
      "indent": 3,
      "text": "This document describes how the S/MIME protocol can be extended in order to secure message header fields defined in RFC 5322. This technology provides security services such as data integrity, non-repudiation, and confidentiality. This extension is referred to as 'Secure Headers'.",
      "zh-CHS": "本文档描述了如何扩展S/MIME协议以保护RFC 5322中定义的消息头字段。该技术提供数据完整性、不可否认性和保密性等安全服务。此扩展名称为“安全标头”。"
    },
    {
      "indent": 0,
      "text": "Status of This Memo",
      "zh-CHS": "关于下段备忘"
    },
    {
      "indent": 3,
      "text": "This document is not an Internet Standards Track specification; it is published for examination, experimental implementation, and evaluation.",
      "zh-CHS": "本文件不是互联网标准跟踪规范；它是为检查、实验实施和评估而发布的。"
    },
    {
      "indent": 3,
      "text": "This document defines an Experimental Protocol for the Internet community. This is a contribution to the RFC Series, independently of any other RFC stream. The RFC Editor has chosen to publish this document at its discretion and makes no statement about its value for implementation or deployment. Documents approved for publication by the RFC Editor are not a candidate for any level of Internet Standard; see Section 2 of RFC 5741.",
      "zh-CHS": "本文档为互联网社区定义了一个实验协议。这是对RFC系列的贡献，独立于任何其他RFC流。RFC编辑器已选择自行发布此文档，并且未声明其对实现或部署的价值。RFC编辑批准发布的文件不适用于任何级别的互联网标准；见RFC 5741第2节。"
    },
    {
      "indent": 3,
      "text": "Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc7508.",
      "zh-CHS": "有关本文件当前状态、任何勘误表以及如何提供反馈的信息，请访问http://www.rfc-editor.org/info/rfc7508."
    },
    {
      "indent": 0,
      "text": "Copyright Notice",
      "zh-CHS": "版权公告"
    },
    {
      "indent": 3,
      "text": "Copyright (c) 2015 IETF Trust and the persons identified as the document authors. All rights reserved.",
      "zh-CHS": "版权所有（c）2015 IETF信托基金和确定为文件作者的人员。版权所有。"
    },
    {
      "indent": 3,
      "text": "This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.",
      "zh-CHS": "本文件受BCP 78和IETF信托有关IETF文件的法律规定的约束(http://trustee.ietf.org/license-info)自本文件出版之日起生效。请仔细阅读这些文件，因为它们描述了您对本文件的权利和限制。"
    },
    {
      "indent": 0,
      "text": "Table of Contents",
      "zh-CHS": "目录"
    },
    {
      "indent": 3,
      "text": "1. Introduction ....................................................2\n2. Terminology and Conventions Used in This Document ...............3\n3. Context .........................................................4\n4. Mechanisms to Secure Message Header Fields ......................6\n   4.1. ASN.1 Syntax of Secure Header Fields .......................7\n   4.2. Secure Header Fields Length and Format .....................8\n   4.3. Canonicalization Algorithm .................................8\n   4.4. Header Field Statuses ......................................8\n   4.5. Signature Process ..........................................9\n        4.5.1. Signature Generation Process ........................9\n        4.5.2. Signature Verification Process .....................10\n   4.6. Encryption and Decryption Processes .......................11\n        4.6.1. Encryption Process .................................11\n        4.6.2. Decryption Process .................................12\n5. Case of Triple Wrapping ........................................13\n6. Security Gateways ..............................................13\n7. Security Considerations ........................................13\n8. IANA Considerations ............................................14\n9. References .....................................................14\n   9.1. Normative References ......................................14\n   9.2. Informative References ....................................15\nAppendix A. Formal Syntax of Secure Header ........................16\nAppendix B. Example of Secure Header Fields .......................18\nAcknowledgements ..................................................19\nAuthors' Addresses ................................................19",
      "raw": true,
      "toc": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "1. Introduction",
      "section_title": true,
      "zh-CHS": "1. 介绍"
    },
    {
      "indent": 3,
      "text": "The S/MIME [RFC5751] standard defines a data encapsulation format for the achievement of end-to-end security services such as integrity, authentication, non-repudiation, and confidentiality. By default, S/MIME secures message body parts, at the exclusion of the message header fields.",
      "zh-CHS": "S/MIME[RFC5751]标准定义了一种数据封装格式，用于实现端到端安全服务，如完整性、身份验证、不可否认性和机密性。默认情况下，S/MIME保护消息正文部分，不包括消息头字段。"
    },
    {
      "indent": 3,
      "text": "S/MIME provides an alternative solution to secure header fields: \"the sending client MAY wrap a full MIME message in a message/rfc822 wrapper in order to apply S/MIME security services to header fields\". However, the S/MIME solution doesn't provide any guidance regarding what subset of message header fields to secure, procedures for clients to reconcile the \"inner\" and \"outer\" headers, or procedures for client interpretation or display of any failures.",
      "zh-CHS": "S/MIME提供了另一种保护头字段的解决方案：“发送客户端可以将完整的MIME消息包装在消息/rfc822包装器中，以便将S/MIME安全服务应用于头字段”。但是，S/MIME解决方案没有提供任何有关要保护的消息头字段子集、客户端协调“内部”和“外部”头的过程、客户端解释或显示任何故障的过程的指导。"
    },
    {
      "indent": 3,
      "text": "Several other security specifications supplement S/MIME features but fail to address the target requirement set of this document. Such other security specifications include DomainKeys Identified Mail (DKIM) [RFC6376], STARTTLS [RFC3207], TLS with IMAP [RFC2595], and an",
      "zh-CHS": "其他几个安全规范补充了S/MIME特性，但未能满足本文档的目标需求集。此类其他安全规范包括域密钥标识邮件（DKIM）[RFC6376]、STARTTLS[RFC3207]、带有IMAP的TLS[RFC2595]和"
    },
    {
      "indent": 3,
      "text": "Internet-Draft referred to as \"Protected Headers\" [PRHDRS]. An explanation of what these services accomplish and why they do not solve this problem can be found in subsequent sections.",
      "zh-CHS": "互联网草案称为“受保护的标题”[PRHDRS]。关于这些服务完成了什么以及为什么它们不能解决这个问题的解释可以在后面的章节中找到。"
    },
    {
      "indent": 3,
      "text": "The goal of this document is to define end-to-end secure header field mechanisms compliant with S/MIME standard. This technique is based on the signed attribute fields of a Cryptographic Message Syntax (CMS) [RFC5652] signature.",
      "zh-CHS": "本文档的目标是定义符合S/MIME标准的端到端安全头字段机制。该技术基于加密消息语法（CMS）[RFC5652]签名的签名属性字段。"
    },
    {
      "indent": 0,
      "text": "2. Terminology and Conventions Used in This Document",
      "section_title": true,
      "zh-CHS": "2. 本文件中使用的术语和惯例"
    },
    {
      "indent": 3,
      "text": "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in [RFC2119].",
      "zh-CHS": "本文件中的关键词“必须”、“不得”、“必需”、“应”、“不应”、“应”、“不应”、“建议”、“可”和“可选”应按照[RFC2119]中所述进行解释。"
    },
    {
      "indent": 3,
      "text": "The terms Message User Agent (MUA), Message Submission Agent (MSA), and Message Transfer Agent (MTA) are defined in the email architecture document [RFC5598].",
      "zh-CHS": "电子邮件体系结构文档[RFC5598]中定义了邮件用户代理（MUA）、邮件提交代理（MSA）和邮件传输代理（MTA）这三个术语。"
    },
    {
      "indent": 3,
      "text": "The term Domain Confidentiality Authority (DCA) is defined in the S/MIME Domain Security specification [RFC3183].",
      "zh-CHS": "术语域保密机构（DCA）在S/MIME域安全规范[RFC3183]中定义。"
    },
    {
      "indent": 3,
      "text": "End-to-end Internet Mail exchanges are performed between message originators and recipients.",
      "zh-CHS": "在邮件发起人和收件人之间执行端到端的Internet邮件交换。"
    },
    {
      "indent": 3,
      "text": "The term message header fields is described in [RFC5322]. A header field is composed of a name and a value.",
      "zh-CHS": "[RFC5322]中描述了术语消息头字段。标题字段由名称和值组成。"
    },
    {
      "indent": 3,
      "text": "Secure Headers technology uses header field statuses required to provide a confidentiality service toward message headers. The following three terms are used to describe the field statuses:",
      "zh-CHS": "安全标头技术使用所需的标头字段状态为消息标头提供保密服务。以下三个术语用于描述字段状态："
    },
    {
      "indent": 3,
      "text": "- duplicated (the default status). When this status is present or if no status is specified, the signature process embeds the header field value in the digital signature, but the value is also present in the message header fields.",
      "zh-CHS": "- 重复（默认状态）。当此状态存在或未指定状态时，签名过程将在数字签名中嵌入标头字段值，但该值也存在于消息标头字段中。"
    },
    {
      "indent": 3,
      "text": "- deleted. When this status is present, the signature process embeds the header field value in the digital signature, and the encryption process deletes this field from the message to preserve its confidentiality.",
      "zh-CHS": "- 删除。当此状态存在时，签名过程将头字段值嵌入数字签名中，加密过程从消息中删除此字段以保持其机密性。"
    },
    {
      "indent": 3,
      "text": "- modified. When this status is present, the signature process embeds the header field value in the digital signature, and the encryption process modifies the value of the header field in the message. This preserves confidentiality and informs a receiver's",
      "zh-CHS": "- 被改进的。当此状态存在时，签名过程将头字段值嵌入数字签名中，加密过程修改消息中头字段的值。这可以保护机密性并通知接收者"
    },
    {
      "indent": 6,
      "text": "noncompliant MUA that secure headers are being used. New values for each field might be configured by the sender (i.e., \"This header is secured; use a compliant client.\").",
      "zh-CHS": "正在使用安全标头的不符合MUA。每个字段的新值可能由发送方配置（即，“此标头是安全的；使用兼容的客户端”）。"
    },
    {
      "indent": 3,
      "text": "The term non-repudiation is used throughout this document in deference to the usage in the S/MIME Message Specification [RFC5751]. It is recognized that this term carries with it much baggage, and that there is some disagreement as to its proper meaning and usage. However, in the context of this document, the term merely refers to one set of possible security services that a conforming implementation might be able to provide. This document specifies no normative requirements for non-repudiation.",
      "zh-CHS": "根据S/MIME消息规范[RFC5751]中的用法，本文档中使用了术语不可否认性。人们认识到，这一术语带有许多包袱，对其正确含义和用法存在一些分歧。然而，在本文件的上下文中，该术语仅指一致性实现可能提供的一组可能的安全服务。本文件未规定不可抵赖性的规范性要求。"
    },
    {
      "indent": 0,
      "text": "3. Context",
      "section_title": true,
      "zh-CHS": "3. 上下文"
    },
    {
      "indent": 3,
      "text": "Over the Internet, email use has grown and today represents a fundamental service. Meanwhile, continually increasing threat levels are motivating the implementation of security services.",
      "zh-CHS": "在互联网上，电子邮件的使用量不断增长，如今已成为一项基本服务。与此同时，不断增加的威胁水平正在推动安全服务的实施。"
    },
    {
      "indent": 3,
      "text": "Historically, SMTP [RFC5321] and the Internet Message Format (IMF) [RFC5322] don't provide, by default, security services. The S/MIME standard [RFC5751] was published in order to address these needs. S/MIME defines a data encapsulation format for the provision of end-to-end security services such as integrity, authentication, non-repudiation, and confidentiality. By default, S/MIME secures message body parts, at the exclusion of the message header fields. In order to protect message header fields (for instance, the \"Subject\", \"To\", \"From\", or customized fields), several solutions exist.",
      "zh-CHS": "历史上，SMTP[RFC5321]和Internet消息格式（IMF）[RFC5322]默认情况下不提供安全服务。为了满足这些需求，发布了S/MIME标准[RFC5751]。S/MIME定义了一种数据封装格式，用于提供端到端安全服务，如完整性、身份验证、不可否认性和机密性。默认情况下，S/MIME保护消息正文部分，不包括消息头字段。为了保护消息头字段（例如，“主题”、“收件人”、“发件人”或自定义字段），存在几种解决方案。"
    },
    {
      "indent": 3,
      "text": "In Section 3.1 of [RFC5751], S/MIME defines an encapsulation mechanism:",
      "zh-CHS": "在[RFC5751]的第3.1节中，S/MIME定义了一种封装机制："
    },
    {
      "indent": 6,
      "text": "[...] the sending client MAY wrap a full MIME message in a message/rfc822 wrapper in order to apply S/MIME security services to these header fields. It is up to the receiving client to decide how to present this \"inner\" header along with the unprotected \"outer\" header.",
      "zh-CHS": "[…]发送客户端可以将完整的MIME消息包装在message/rfc822包装器中，以便将S/MIME安全服务应用于这些头字段。由接收客户端决定如何显示此“内部”标头和未受保护的“外部”标头。"
    },
    {
      "indent": 3,
      "text": "However, some use cases are not addressed, especially in the case of message encryption. What happens when header fields are encrypted? How does the receiving client display these header fields? How can a subset of header fields be secured? S/MIME doesn't address these issues.",
      "zh-CHS": "但是，有些用例没有得到解决，特别是在消息加密的情况下。头字段加密时会发生什么情况？接收客户端如何显示这些标题字段？如何保护标题字段的子集？S/MIME不能解决这些问题。"
    },
    {
      "indent": 3,
      "text": "Some partial header protection is provided by the S/MIME Certificate Handling specification [RFC5750]:",
      "zh-CHS": "S/MIME证书处理规范[RFC5750]提供了一些部分头保护："
    },
    {
      "indent": 6,
      "text": "Receiving agents MUST check that the address in the From or Sender header of a mail message matches an Internet mail address, if present, in the signer's certificate, if mail addresses are present in the certificate.",
      "zh-CHS": "接收代理必须检查邮件消息的发件人或发件人标头中的地址是否与签名者证书中的Internet邮件地址（如果存在）匹配（如果证书中存在邮件地址）。"
    },
    {
      "indent": 3,
      "text": "In some cases, this may provide assurance of the integrity of the From or Sender header values. However, the solution in RFC 5750 only provides a matching mechanism between email addresses and provides no protection to other header fields.",
      "zh-CHS": "在某些情况下，这可以保证From或Sender头值的完整性。但是，RFC 5750中的解决方案仅提供电子邮件地址之间的匹配机制，而不提供对其他标头字段的保护。"
    },
    {
      "indent": 3,
      "text": "Other security specifications (introduced below) exist such as DKIM, STARTTLS and TLS with IMAP, but they meet other needs (signing domain, secure channels, etc.).",
      "zh-CHS": "存在其他安全规范（下文介绍），如DKIM、STARTTLS和带有IMAP的TLS，但它们满足其他需求（签名域、安全通道等）。"
    },
    {
      "indent": 3,
      "text": "STARTTLS and TLS with IMAP provide secure channels between components of the email system (MUA, MSA, MTA, etc.), but end-to-end integrity cannot be guaranteed.",
      "zh-CHS": "带有IMAP的STARTTLS和TLS提供电子邮件系统组件（MUA、MSA、MTA等）之间的安全通道，但无法保证端到端的完整性。"
    },
    {
      "indent": 3,
      "text": "DKIM defines a domain-level authentication framework for email. While this permits integrity and origination checks on message header fields and the message body, it does this for a domain actor (usually the SMTP service or equivalent) and not for the entity that is sending, and thus signing, the message. (Extensions to DKIM might be able to solve this issue by authenticating the sender and making a statement of this fact as part of the signed message headers.) DKIM is also deficient for our purposes, as it does not provide a confidentially service.",
      "zh-CHS": "DKIM为电子邮件定义了域级身份验证框架。虽然这允许对邮件头字段和邮件正文进行完整性和原始信息检查，但它是为域参与者（通常是SMTP服务或等效服务）而不是为发送邮件并进行签名的实体执行的。（对DKIM的扩展可能能够通过验证发送方并在签名消息头中声明这一事实来解决此问题。）DKIM对于我们来说也是有缺陷的，因为它不提供保密服务。"
    },
    {
      "indent": 3,
      "text": "An Internet-Draft referred to as \"Protected Headers\" [PRHDRS] has been proposed. Mechanisms described in that document are the following:",
      "zh-CHS": "已经提出了一份称为“受保护的头文件”[PRHDRS]的互联网草案。该文件中描述的机制如下："
    },
    {
      "indent": 6,
      "text": "[...] a digest value is computed over the canonicalized version of some selected header fields. This technique resembles header protection in [RFC4871]. Then the digest value is included in a signed attribute field of a CMS signature.",
      "zh-CHS": "[…]在某些选定标题字段的规范化版本上计算摘要值。这种技术类似于[RFC4871]中的头保护。然后，摘要值包含在CMS签名的签名属性字段中。"
    },
    {
      "indent": 3,
      "text": "(Note that RFC 4871 has been obsoleted by RFC 6376.)",
      "zh-CHS": "（请注意，RFC 4871已被RFC 6376淘汰。）"
    },
    {
      "indent": 3,
      "text": "That specification doesn't address all conceivable requirements as noted below. If the protected header field has been altered, the original value cannot be determined by the recipient. In addition, the encryption service cannot provide confidentiality for fields that must remain present in the message header during transport.",
      "zh-CHS": "该规范并未解决所有可能的要求，如下所述。如果已更改受保护的标头字段，则收件人无法确定原始值。此外，加密服务无法为传输期间必须保留在消息头中的字段提供机密性。"
    },
    {
      "indent": 3,
      "text": "This document proposes a technology for securing message header fields. It's referred to as \"Secure Headers\". It is based on S/MIME and CMS standards. It provides security services such as data integrity, confidentiality, and non-repudiation of the sender. Secure Headers is backward compatible with other S/MIME clients. S/MIME clients who have not implemented Secure Headers technology need merely ignore specific signed attributes fields in a CMS signature (which is the default behavior).",
      "zh-CHS": "本文档提出了一种保护消息头字段的技术。它被称为“安全头”。它基于S/MIME和CMS标准。它提供安全服务，如数据完整性、机密性和发送方的不可否认性。安全标头与其他S/MIME客户端向后兼容。未实现安全头技术的S/MIME客户端只需忽略CMS签名中的特定签名属性字段（这是默认行为）。"
    },
    {
      "indent": 0,
      "text": "4. Mechanisms to Secure Message Header Fields",
      "section_title": true,
      "zh-CHS": "4. 保护消息头字段的机制"
    },
    {
      "indent": 3,
      "text": "Secure Headers technology involves the description of a security policy. This policy MUST describe a secure message profile and list the header fields to secure. How this security policy is agreed upon or communicated is beyond the scope of this document.",
      "zh-CHS": "安全标头技术涉及安全策略的描述。此策略必须描述安全消息配置文件，并列出要保护的头字段。本安全政策的约定或传达方式超出了本文件的范围。"
    },
    {
      "indent": 3,
      "text": "Secure headers are based on the signed attributes field as defined in CMS. The details are as follows. The message header fields to be secured are integrated in a structure (SecureHeaderFields structure) that is encapsulated in the signed attributes structure of the SignerInfo object. There is only one value of HeaderFields encoded into a single SignedAttribute in a signature. See Appendix A for an example. For each header field present in the secure signature, a status can be set. Then, as described in Section 5.4 of CMS [RFC5652], the message digest calculation process computes a message digest on the content together with the signed attributes. Details of the signature generation process are in Section 4.5.1 of this document.",
      "zh-CHS": "安全标头基于CMS中定义的签名属性字段。详情如下。要保护的消息头字段集成在一个结构（SecureHeaderFields结构）中，该结构封装在SignerInfo对象的signed attributes结构中。签名中只有一个HeaderFields值编码到单个SignedAttribute中。有关示例，请参见附录A。对于安全签名中存在的每个标头字段，可以设置状态。然后，如CMS[RFC5652]第5.4节所述，消息摘要计算过程计算内容上的消息摘要以及签名属性。签名生成过程的详细信息见本文件第4.5.1节。"
    },
    {
      "indent": 3,
      "text": "Verification of secure header fields is based on the signature verification process described in CMS. At the end of this process, a comparison between the secure header fields and the corresponding message header fields is performed. If they match, the signature is valid. Otherwise, the signature is invalid. Details of the signature verification process are in Section 4.5.2 of this document.",
      "zh-CHS": "安全标头字段的验证基于CMS中描述的签名验证过程。在该过程结束时，将执行安全标头字段与相应消息标头字段之间的比较。如果它们匹配，则签名有效。否则，签名无效。签名验证过程的详细信息见本文件第4.5.2节。"
    },
    {
      "indent": 3,
      "text": "Non-conforming S/MIME clients will ignore the signed attribute containing the SecureHeaderFields structure, and only perform the verification process described in CMS. This guarantees backward compatibility.",
      "zh-CHS": "不符合要求的S/MIME客户端将忽略包含SecureHeaderFields结构的已签名属性，并且只执行CMS中描述的验证过程。这保证了向后兼容性。"
    },
    {
      "indent": 3,
      "text": "Secure headers provide security services such as data integrity, non-repudiation, and confidentiality.",
      "zh-CHS": "安全标头提供数据完整性、不可否认性和机密性等安全服务。"
    },
    {
      "indent": 3,
      "text": "For different reasons (e.g., usability, limits of IMAP [RFC3501]), encryption and decryption processes are performed by a third party. The third party that performs these processes is referred to in the Domain Security specification as a Domain Confidentiality Authority (DCA). Details of the encryption and decryption processes are in Sections 4.6.1 and 4.6.2 of this document.",
      "zh-CHS": "出于不同的原因（例如，可用性、IMAP[RFC3501]的限制），加密和解密过程由第三方执行。执行这些过程的第三方在域安全规范中称为域保密机构（DCA）。加密和解密过程的详细信息见本文件第4.6.1节和第4.6.2节。"
    },
    {
      "indent": 3,
      "text": "The architecture of Secure Headers is presented below. The MUA performs the signature generation process (C) and signature verification process (F). The DCA performs the message encryption process (D) and message decryption process (E). The encryption and decryption processes are optional.",
      "zh-CHS": "下面介绍了安全头的体系结构。MUA执行签名生成过程（C）和签名验证过程（F）。DCA执行消息加密过程（D）和消息解密过程（E）。加密和解密过程是可选的。"
    },
    {
      "indent": 5,
      "text": "        A Domain                             B Domain\n+----------------------+             +----------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "+-----+          +-----+             +-----+          +-----+\n| MUA | -------> | DCA | ----------> | DCA |--------> | MUA |\n|  C  |          |  D  |             |  E  |          |  F  |\n+-----+          +-----+             +-----+          +-----+\n        SignedMsg        EncryptedMsg        SignedMsg",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 18,
      "text": "Figure 1: Architecture of Secure Headers",
      "zh-CHS": "图1：安全头的体系结构"
    },
    {
      "indent": 0,
      "text": "4.1. ASN.1 Syntax of Secure Header Fields",
      "section_title": true,
      "zh-CHS": "4.1. ASN.1安全标头字段的语法"
    },
    {
      "indent": 3,
      "text": "The ASN.1 syntax [ASN1-88] of the SecureHeaderFields structure is as follows:",
      "zh-CHS": "SecureHeaderFields结构的ASN.1语法[ASN1-88]如下所示："
    },
    {
      "indent": 6,
      "text": "SecureHeaderFields ::= SET {\n   canonAlgorithm Algorithm,\n   secHeaderFields HeaderFields }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "id-aa-secureHeaderFieldsIdentifier OBJECT IDENTIFIER ::= {\n   iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)\n   pkcs-9(9) smime(16) id-aa(2) secureHeaderFieldsIdentifier(55) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "Algorithm ::= ENUMERATED {\n   canonAlgorithmSimple(0),\n   canonAlgorithmRelaxed(1) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFields ::= SEQUENCE SIZE (1..MAX) OF HeaderField",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderField ::= SEQUENCE {\n   field-Name HeaderFieldName,\n   field-Value HeaderFieldValue,\n   field-Status HeaderFieldStatus DEFAULT duplicated }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldName ::= VisibleString (FROM (ALL EXCEPT (\":\")))\n     -- This description matches the description of\n     -- field name in Sections 2.2 and 3.6.8 of RFC 5322",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldValue ::= UTF8String\n     -- This description matches the description of\n     -- field body in Section 2.2 of RFC 5322 as\n     -- extended by Section 3.1 of RFC 6532.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldStatus ::= INTEGER {\n   duplicated(0), deleted(1), modified(2) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "4.2. Secure Header Fields Length and Format",
      "section_title": true,
      "zh-CHS": "4.2. 安全标头字段长度和格式"
    },
    {
      "indent": 3,
      "text": "This specification requires MUA security capabilities in order to process well-formed headers, as specified in IMF. Notice that it includes long header fields and folded header fields.",
      "zh-CHS": "本规范要求MUA安全功能，以便处理格式良好的报头，如IMF中所述。请注意，它包括长标题字段和折叠标题字段。"
    },
    {
      "indent": 0,
      "text": "4.3. Canonicalization Algorithm",
      "section_title": true,
      "zh-CHS": "4.3. 规范化算法"
    },
    {
      "indent": 3,
      "text": "During a message transfer through a messaging system, some components might modify headers (i.e., adding or deleting space, changing or lowercase or uppercase). This might lead to a comparison mismatch of header fields. This emphasizes the need of a conversion process in order to transform data to their canonical form. This process is named the canonicalization process.",
      "zh-CHS": "在通过消息传递系统传输消息的过程中，某些组件可能会修改消息头（即，添加或删除空格、更改大小写或大写）。这可能会导致标题字段的比较不匹配。这强调了转换过程的需要，以便将数据转换为其规范形式。这个过程被称为规范化过程。"
    },
    {
      "indent": 3,
      "text": "Two canonicalization algorithms are considered here, according to Section 3.4 of the DKIM specification [RFC6376]. The \"simple\" algorithm doesn't allow any modification, whereas the \"relaxed\" algorithm accepts slight modifications like space replacement or line reformatting. Given the scope of this document, canonicalization mechanisms only involve header fields.",
      "zh-CHS": "根据DKIM规范[RFC6376]第3.4节，这里考虑两种规范化算法。“简单”算法不允许任何修改，而“松弛”算法接受轻微修改，如空间替换或行重新格式化。鉴于本文档的范围，规范化机制只涉及头字段。"
    },
    {
      "indent": 3,
      "text": "Implementations SHOULD use the \"relaxed\" algorithm to promote interoperability with non-conforming SMTP products.",
      "zh-CHS": "实施应使用“宽松”算法来促进与不合格SMTP产品的互操作性。"
    },
    {
      "indent": 0,
      "text": "4.4. Header Field Statuses",
      "section_title": true,
      "zh-CHS": "4.4. 标题字段状态"
    },
    {
      "indent": 3,
      "text": "Header field statuses are necessary to provide a confidentiality service for message headers. In this specification, the confidentiality of header fields is provided by the DCA. This point is described in Section 4. The DCA performs the message encryption process and message decryption process; these processes are described in detail in Sections 4.6.1 and 4.6.2. Although header field statuses are embedded in the signature, the signature processes",
      "zh-CHS": "标头字段状态是为消息标头提供保密服务所必需的。在本规范中，头字段的机密性由DCA提供。这一点在第4节中描述。DCA执行消息加密处理和消息解密处理；第4.6.1节和第4.6.2节详细描述了这些过程。虽然签名中嵌入了标题字段状态，但签名过程"
    },
    {
      "indent": 3,
      "text": "(generation and verification) ignore them. The header field status defaults to \"duplicated\". If the header field is confidential, the header field status MUST be either \"deleted\" or \"modified\".",
      "zh-CHS": "（生成和验证）忽略它们。标题字段状态默认为“重复”。如果标题字段为机密字段，则标题字段状态必须为“已删除”或“已修改”。"
    },
    {
      "indent": 0,
      "text": "4.5. Signature Process",
      "section_title": true,
      "zh-CHS": "4.5. 签名过程"
    },
    {
      "indent": 0,
      "text": "4.5.1. Signature Generation Process",
      "section_title": true,
      "zh-CHS": "4.5.1. 签名生成过程"
    },
    {
      "indent": 3,
      "text": "During the signature generation process, the sender's MUA MUST embed the SecureHeaderFields structure in the signed attributes, as described in CMS. The SecureHeaderFields structure MUST include a canonicalization algorithm.",
      "zh-CHS": "在签名生成过程中，发送方的MUA必须将SecureHeaderFields结构嵌入签名属性中，如CMS中所述。SecureHeaderFields结构必须包括规范化算法。"
    },
    {
      "indent": 3,
      "text": "The sender's MUA MUST have a list of header fields to secure, statuses, and a canonicalization algorithm, as defined by the security policy.",
      "zh-CHS": "发送方的MUA必须具有要保护的标题字段列表、状态和规范化算法，如安全策略所定义。"
    },
    {
      "indent": 3,
      "text": "Header fields (names and values) embedded in signed attributes MUST be the same as those included in the initial message.",
      "zh-CHS": "嵌入在签名属性中的头字段（名称和值）必须与初始消息中包含的头字段相同。"
    },
    {
      "indent": 3,
      "text": "If different headers share the same name, all instances MUST be included in the SecureHeaderFields structure.",
      "zh-CHS": "如果不同的头共享相同的名称，则所有实例都必须包含在SecureHeaderFields结构中。"
    },
    {
      "indent": 3,
      "text": "If multiple signatures are used, as explained in the CMS and Multiple Signer [RFC4853] specifications, the SecureHeaderFields structure MUST be the same in each SignerInfos object.",
      "zh-CHS": "如CMS和多签名者[RFC4853]规范所述，如果使用多个签名，则每个SignerInfos对象中的SecureHeaderFields结构必须相同。"
    },
    {
      "indent": 3,
      "text": "If a header field is present and its value is empty, HeaderFieldValue MUST have a zero-length field-Value.",
      "zh-CHS": "如果存在标头字段且其值为空，则HeaderFieldValue必须具有零长度字段值。"
    },
    {
      "indent": 3,
      "text": "Considering secure header mechanisms, the signature generation process MUST perform the following steps:",
      "zh-CHS": "考虑到安全标头机制，签名生成过程必须执行以下步骤："
    },
    {
      "indent": 6,
      "text": "1) Select the relevant header fields to secure. This subset of headers is defined according the security policy.",
      "zh-CHS": "1) 选择要保护的相关标题字段。此标头子集是根据安全策略定义的。"
    },
    {
      "indent": 6,
      "text": "2) Apply the canonicalization algorithm for each selected header field.",
      "zh-CHS": "2) 为每个选定的标题字段应用规范化算法。"
    },
    {
      "indent": 6,
      "text": "3) Complete the following fields in the SecureHeaderFields structure according to the initial message: HeaderFieldName, HeaderFieldValue, and HeaderFieldStatus.",
      "zh-CHS": "3) 根据初始消息填写SecureHeaderFields结构中的以下字段：HeaderFieldName、HeaderFieldValue和HeaderFieldStatus。"
    },
    {
      "indent": 6,
      "text": "4) Complete the algorithm field according to the canonicalization algorithm configured.",
      "zh-CHS": "4) 根据配置的规范化算法填写算法字段。"
    },
    {
      "indent": 6,
      "text": "5) Embed the SecureHeaderFields structure in the signed attributes of the SignerInfos object.",
      "zh-CHS": "5) 将SecureHeaderFields结构嵌入SignerInfos对象的已签名属性中。"
    },
    {
      "indent": 6,
      "text": "6) Compute the signature generation process as described in Section 5.5 of CMS [RFC5652].",
      "zh-CHS": "6) 计算CMS[RFC5652]第5.5节中所述的签名生成过程。"
    },
    {
      "indent": 0,
      "text": "4.5.2. Signature Verification Process",
      "section_title": true,
      "zh-CHS": "4.5.2. 签名验证过程"
    },
    {
      "indent": 3,
      "text": "During the signature verification process, the receiver's MUA compares header fields embedded in the SecureHeaderFields structure with those present in the message. For this purpose, it uses the canonicalization algorithm identified in the signed attributes. If a mismatch appears during the comparison process, the receiver's MUA MUST invalidate the signature. The MUA MUST display information on the validity of each header field. It MUST also display the values embedded in the signature.",
      "zh-CHS": "在签名验证过程中，接收方的MUA将SecureHeaderFields结构中嵌入的头字段与消息中存在的头字段进行比较。为此，它使用签名属性中标识的规范化算法。如果在比较过程中出现不匹配，则接收器的MUA必须使签名无效。MUA必须显示每个标题字段的有效性信息。它还必须显示嵌入在签名中的值。"
    },
    {
      "indent": 3,
      "text": "The receiver's MUA MUST know the list of mandatory header fields in order to verify their presence in the message. If a header field defined in a message is in the secure header list, it MUST be included in the SecureHeaderFields structure. Otherwise, the receiver's MUA MUST warn the user that a non-secure header is present.",
      "zh-CHS": "接收方的MUA必须知道强制标头字段的列表，以便验证其在消息中的存在。如果消息中定义的标头字段位于安全标头列表中，则必须将其包含在SecureHeaderFields结构中。否则，接收方的MUA必须警告用户存在不安全的报头。"
    },
    {
      "indent": 3,
      "text": "Considering secure header mechanisms, the signature verification process MUST perform the following steps:",
      "zh-CHS": "考虑到安全标头机制，签名验证过程必须执行以下步骤："
    },
    {
      "indent": 6,
      "text": "1) Execute the signature verification process as described Section 5.6 of CMS [RFC5652]. If the signature appears to be invalid, the process ends. Otherwise, the process continues.",
      "zh-CHS": "1) 执行CMS[RFC5652]第5.6节所述的签名验证过程。如果签名无效，则过程结束。否则，该过程将继续。"
    },
    {
      "indent": 6,
      "text": "2) Read the type of canonicalization algorithm specified in the SecureHeaderFields structure.",
      "zh-CHS": "2) 读取SecureHeaderFields结构中指定的规范化算法类型。"
    },
    {
      "indent": 6,
      "text": "3) For each field present in the signature, find the matching header in the message. If there is no matching header, the verification process MUST warn the user, specifying the missing header name. The signature is tagged as invalid. Note that any header fields encrypted as per Section 4.6 (i.e., status of \"deleted\" or \"modified\") have been are already restored by the DCA when the signature verification process is performed by the MUA.",
      "zh-CHS": "3) 对于签名中的每个字段，在消息中查找匹配的标头。如果没有匹配的头，验证过程必须警告用户，指定缺少的头名称。签名被标记为无效。请注意，当MUA执行签名验证过程时，DCA已恢复根据第4.6节加密的任何标题字段（即“已删除”或“已修改”状态）。"
    },
    {
      "indent": 6,
      "text": "4) Compute the canonicalization algorithm for each header field value in the message. If the \"simple\" algorithm is used, the steps described in Section 3.4.1 of DKIM [RFC6376] are performed. If the relaxed algorithm is used, the steps described in Section 3.4.2 of DKIM [RFC6376] are performed.",
      "zh-CHS": "4) 计算消息中每个标头字段值的规范化算法。如果使用“简单”算法，则执行DKIM[RFC6376]第3.4.1节中描述的步骤。如果使用松弛算法，则执行DKIM[RFC6376]第3.4.2节中描述的步骤。"
    },
    {
      "indent": 6,
      "text": "5) For each field, compare the value stored in the SecureHeaderFields structure with the value returned by the canonicalization algorithm. If the values don't match, the verification process MUST warn the user. This warning MUST mention mismatching fields. The signature is tagged as invalid. If all the comparisons succeed, the verification process MUST also notify the user (i.e., using an appropriate icon).",
      "zh-CHS": "5) 对于每个字段，将存储在SecureHeaderFields结构中的值与规范化算法返回的值进行比较。如果值不匹配，验证过程必须警告用户。此警告必须提及不匹配的字段。签名被标记为无效。如果所有比较都成功，验证过程还必须通知用户（即使用适当的图标）。"
    },
    {
      "indent": 6,
      "text": "6) Verify that no secure header has been added to the message header, given the initial fields. If an extra header field has been added, the verification process MUST warn the user. This warning MUST mention extra fields. The signature is tagged as invalid. This step is only performed if the sender and the recipient share the same security policy.",
      "zh-CHS": "6) 确认在给定初始字段的情况下，没有向消息头添加任何安全头。如果添加了额外的标题字段，则验证过程必须警告用户。此警告必须提及额外字段。签名被标记为无效。仅当发件人和收件人共享相同的安全策略时，才执行此步骤。"
    },
    {
      "indent": 6,
      "text": "7) Verify that each mandatory header in the security policy and present in the message is also embedded in the SecureHeaderFields structure. If such headers are missing, the verification process MUST warn the user and indicate the names of the missing headers.",
      "zh-CHS": "7) 验证安全策略中以及消息中存在的每个必填标头是否也嵌入到SecureHeaderFields结构中。如果缺少此类头，验证过程必须警告用户并指明缺少头的名称。"
    },
    {
      "indent": 3,
      "text": "The MUA MUST display the properties of each secure header field (name, value, and status) and the canonicalization algorithm used.",
      "zh-CHS": "MUA必须显示每个安全头字段（名称、值和状态）的属性以及使用的规范化算法。"
    },
    {
      "indent": 0,
      "text": "4.6. Encryption and Decryption Processes",
      "section_title": true,
      "zh-CHS": "4.6. 加密和解密过程"
    },
    {
      "indent": 3,
      "text": "Encryption and decryption operations are not performed by MUAs. This is mainly justified by limitations of existing email delivery protocols, for example, IMAP. The solution developed here relies on concepts explained in Section 4 of the Domain Security specification [RFC3183]. A fundamental component of the architecture is the Domain Confidentiality Authority (DCA). Its purpose is to encrypt and decrypt messages instead of that being performed by senders and receivers (respectively).",
      "zh-CHS": "MUA不执行加密和解密操作。这主要是因为现有电子邮件传递协议（例如IMAP）的局限性。这里开发的解决方案依赖于域安全规范[RFC3183]第4节中解释的概念。该体系结构的一个基本组件是域保密机构（DCA）。它的目的是加密和解密消息，而不是由发送方和接收方（分别）执行。"
    },
    {
      "indent": 0,
      "text": "4.6.1. Encryption Process",
      "section_title": true,
      "zh-CHS": "4.6.1. 加密过程"
    },
    {
      "indent": 3,
      "text": "All the computations presented in this section MUST be performed only if the following conditions are verified:",
      "zh-CHS": "只有在验证以下条件时，才能执行本节中的所有计算："
    },
    {
      "indent": 6,
      "text": "- The content to be encrypted MUST consist of a signed message (application/pkcs7-mime with SignedData, or multipart/signed) as shown in Section 3.4 of the S/MIME specification [RFC5751].",
      "zh-CHS": "- 如S/mime规范[RFC5751]第3.4节所示，要加密的内容必须包含签名消息（带签名数据的应用程序/pkcs7 mime，或多部分/签名）。"
    },
    {
      "indent": 6,
      "text": "- A SecureHeaderFields structure MUST be included in the signedAttrs field of the SignerInfo object of the signature.",
      "zh-CHS": "- 签名的SignerInfo对象的signedAttrs字段中必须包含SecureHeaderFields结构。"
    },
    {
      "indent": 3,
      "text": "All the mechanisms described below MUST start at the beginning of the encryption process, as explained in CMS. They are performed by the sender's DCA. For extraction of the field status, the following steps MUST be performed for each field included in the SecureHeaderFields structure:",
      "zh-CHS": "下面描述的所有机制必须在加密过程开始时启动，如CMS中所述。它们由发送方的DCA执行。要提取字段状态，必须对SecureHeaderFields结构中包含的每个字段执行以下步骤："
    },
    {
      "indent": 6,
      "text": "1. If the status is \"duplicated\", the field is left at its existing value.",
      "zh-CHS": "1. 如果状态为“复制”，则该字段保留其现有值。"
    },
    {
      "indent": 6,
      "text": "2. If the status is \"deleted\", the header field (name and value) is removed from the message. Mandatory header fields specified in [RFC5322] MUST be kept.",
      "zh-CHS": "2. 如果状态为“已删除”，则从消息中删除标题字段（名称和值）。必须保留[RFC5322]中指定的必填标头字段。"
    },
    {
      "indent": 6,
      "text": "3. If the status is \"modified\", the header value is replaced by a new value, as configured in the DCA.",
      "zh-CHS": "3. 如果状态为“修改”，则标题值将替换为DCA中配置的新值。"
    },
    {
      "indent": 0,
      "text": "4.6.2. Decryption Process",
      "section_title": true,
      "zh-CHS": "4.6.2. 解密过程"
    },
    {
      "indent": 3,
      "text": "All the computations presented in this section MUST be performed only if the following conditions are verified:",
      "zh-CHS": "只有在验证以下条件时，才能执行本节中的所有计算："
    },
    {
      "indent": 6,
      "text": "- The decrypted content MUST consist of a signature object or a multipart object, where one part is a detached signature, as shown in Section 3.4 of the S/MIME specification [RFC5751].",
      "zh-CHS": "- 解密内容必须由签名对象或多部分对象组成，其中一部分是分离的签名，如S/MIME规范[RFC5751]第3.4节所示。"
    },
    {
      "indent": 6,
      "text": "- A SecureHeaderFields structure MUST be included in the SignerInfo object of the signature.",
      "zh-CHS": "- 签名的SignerInfo对象中必须包含SecureHeaderFields结构。"
    },
    {
      "indent": 3,
      "text": "All the mechanisms described below MUST start at the end of the decryption process, as explained in CMS. They are executed by the receiver's DCA. The following steps MUST be performed for each field included in the SecureHeaderFields structure:",
      "zh-CHS": "下面描述的所有机制必须在解密过程结束时启动，如CMS中所述。它们由接收方的DCA执行。必须对SecureHeaderFields结构中包含的每个字段执行以下步骤："
    },
    {
      "indent": 6,
      "text": "1. If the status is \"duplicated\", the field is left at its existing value.",
      "zh-CHS": "1. 如果状态为“复制”，则该字段保留其现有值。"
    },
    {
      "indent": 6,
      "text": "2. If the status is \"deleted\", the DCA MUST write a header field (name and value) in the message. This header MUST be compliant with the information embedded in the signature.",
      "zh-CHS": "2. 如果状态为“已删除”，DCA必须在消息中写入标题字段（名称和值）。此标题必须与签名中嵌入的信息一致。"
    },
    {
      "indent": 6,
      "text": "3. If the status is \"modified\", the DCA MUST rewrite a header field in the message. This header MUST be compliant with the SecureHeaderFields structure.",
      "zh-CHS": "3. 如果状态为“已修改”，DCA必须重写消息中的标题字段。此标头必须符合SecureHeaderFields结构。"
    },
    {
      "indent": 0,
      "text": "5. Case of Triple Wrapping",
      "section_title": true,
      "zh-CHS": "5. 三包一例"
    },
    {
      "indent": 3,
      "text": "Secure Headers mechanisms MAY be used with triple wrapping, as described in Enhanced Security Services (ESS) [RFC2634]. In this case, a SecureHeaderFields structure MAY be present in the inner signature, the outer signature, or both. In the last case, the two SecureHeaderFields structures MAY differ. One MAY consider the encapsulation of a header field in the inner signature in order to satisfy confidentiality needs. On the contrary, an outer signature encapsulation MAY help for delivery purposes. The sender's MUA and receiver's MUA must have a security policy for triple wrapping. This security policy MUST be composed of two parts -- one for the inner signature and the other for the outer signature.",
      "zh-CHS": "如增强安全服务（ESS）[RFC2634]中所述，安全头机制可与三重包装一起使用。在这种情况下，SecureHeaderFields结构可能存在于内部签名、外部签名或两者中。在最后一种情况下，两个SecureHeaderFields结构可能不同。可以考虑在内部签名中封装报头字段，以满足机密性需求。相反，外部签名封装可能有助于交付目的。发送方的MUA和接收方的MUA必须具有三重包装的安全策略。此安全策略必须由两部分组成——一部分用于内部签名，另一部分用于外部签名。"
    },
    {
      "indent": 0,
      "text": "6. Security Gateways",
      "section_title": true,
      "zh-CHS": "6. 安全网关"
    },
    {
      "indent": 3,
      "text": "Some security gateways sign or verify messages that pass through them. Compliant gateways MUST apply the process described in Section 4.5.",
      "zh-CHS": "一些安全网关对通过它们的消息进行签名或验证。符合要求的网关必须采用第4.5节所述的流程。"
    },
    {
      "indent": 3,
      "text": "For noncompliant gateways, the presence of a SecureHeaderFields structure does not change their behavior.",
      "zh-CHS": "对于不兼容的网关，SecureHeaderFields结构的存在不会改变它们的行为。"
    },
    {
      "indent": 3,
      "text": "In some case, gateways MUST generate a new signature or insert signerInfos into the signedData block. The format of signatures generated by gateways is outside the scope of this document.",
      "zh-CHS": "在某些情况下，网关必须生成新签名或将signerInfos插入signedData块。网关生成的签名格式不在本文档范围内。"
    },
    {
      "indent": 0,
      "text": "7. Security Considerations",
      "section_title": true,
      "zh-CHS": "7. 安全考虑"
    },
    {
      "indent": 3,
      "text": "This specification describes an extension of the S/MIME standard. It provides message header integrity, non-repudiation, and confidentiality. The signature and encryption processes are complementary. However, according to the security policy, only the signature mechanism is applicable. In this case, the signature process is implemented between MUAs. The encryption process requires signed messages with the Secure Headers extension. If required, the encryption process is implemented by DCAs.",
      "zh-CHS": "本规范描述了S/MIME标准的扩展。它提供消息头完整性、不可否认性和机密性。签名和加密过程是互补的。然而，根据安全策略，只有签名机制才适用。在这种情况下，签名过程在MUA之间实现。加密过程需要具有安全标头扩展名的签名消息。如果需要，加密过程由DCAs实现。"
    },
    {
      "indent": 3,
      "text": "This specification doesn't address end-to-end confidentiality for message header fields. Messages sent and received by MUAs could be transmitted as plaintext. In order to avoid interception, the use of TLS is recommended between MUAs and DCAs (uplink and downlink). Another solution might be the use of S/MIME between MUAs and DCAs in the same domain.",
      "zh-CHS": "此规范不解决消息头字段的端到端机密性问题。MUAs发送和接收的消息可以以明文形式传输。为了避免拦截，建议在MUA和DCA（上行链路和下行链路）之间使用TLS。另一种解决方案可能是在同一域中的MUA和DCA之间使用S/MIME。"
    },
    {
      "indent": 3,
      "text": "For the header field confidentiality mechanism to be effective, all DCAs supporting confidentiality must support Secure Headers processing. Otherwise, there is a risk that headers are not obscured",
      "zh-CHS": "为了使标头字段机密性机制有效，所有支持机密性的DCA必须支持安全的标头处理。否则，可能会出现标题未被遮挡的风险"
    },
    {
      "indent": 3,
      "text": "upon encryption or not restored upon decryption. In the former case, confidentiality of the header fields is compromised. In the latter case, the integrity of the headers will appear to be compromised.",
      "zh-CHS": "加密或解密时不恢复。在前一种情况下，报头字段的机密性受到损害。在后一种情况下，报头的完整性将受到损害。"
    },
    {
      "indent": 0,
      "text": "8. IANA Considerations",
      "section_title": true,
      "zh-CHS": "8. IANA考虑"
    },
    {
      "indent": 3,
      "text": "IANA has registered value 65, mod-sMimeSecureHeadersV1, in the \"SMI Security for S/MIME Module Identifier (1.2.840.113549.1.9.16.0)\" registry.",
      "zh-CHS": "IANA在“S/MIME模块标识符的SMI安全性（1.2.840.113549.1.9.16.0）”注册表中注册了值65，mod-sMimeSecureHeadersV1。"
    },
    {
      "indent": 3,
      "text": "IANA has also registered value 55, id-aa-secureHeaderFieldsIdentifier, in the \"SMI Security for S/MIME Attributes (1.2.840.113549.1.9.16.2)\" registry. This value will be used to identify an authenticated attribute carried within a CMS wrapper [RFC5652]. This attribute OID appears in Section 4.1 and again in the reference definition in Appendix A.",
      "zh-CHS": "IANA还在“S/MIME属性的SMI安全性（1.2.840.113549.1.9.16.2）”注册表中注册了值55，id aa SecureHeaderFieldIdentifier。此值将用于标识CMS包装器[RFC5652]中携带的经过身份验证的属性。该属性OID出现在第4.1节和附录A的参考定义中。"
    },
    {
      "indent": 0,
      "text": "9. References",
      "section_title": true,
      "zh-CHS": "9. 工具书类"
    },
    {
      "indent": 0,
      "text": "9.1. Normative References",
      "section_title": true,
      "zh-CHS": "9.1. 规范性引用文件"
    },
    {
      "indent": 3,
      "text": "[RFC2119] Bradner, S., \"Key words for use in RFCs to Indicate Requirement Levels\", BCP 14, RFC 2119, March 1997, <http://www.rfc-editor.org/info/rfc2119>.",
      "zh-CHS": "[RFC2119]Bradner，S.，“RFC中用于表示需求水平的关键词”，BCP 14，RFC 2119，1997年3月<http://www.rfc-editor.org/info/rfc2119>."
    },
    {
      "indent": 3,
      "text": "[RFC2634] Hoffman, P., Ed., \"Enhanced Security Services for S/MIME\", RFC 2634, June 1999, <http://www.rfc-editor.org/info/rfc2634>.",
      "zh-CHS": "[RFC2634]Hoffman，P.，Ed.，“S/MIME的增强安全服务”，RFC 2634，1999年6月<http://www.rfc-editor.org/info/rfc2634>."
    },
    {
      "indent": 3,
      "text": "[RFC4853] Housley, R., \"Cryptographic Message Syntax (CMS) Multiple Signer Clarification\", RFC 4853, April 2007, <http://www.rfc-editor.org/info/rfc4853>.",
      "zh-CHS": "[RFC4853]Housley，R.，“加密消息语法（CMS）多签名者澄清”，RFC 4853，2007年4月<http://www.rfc-editor.org/info/rfc4853>."
    },
    {
      "indent": 3,
      "text": "[RFC5322] Resnick, P., Ed., \"Internet Message Format\", RFC 5322, October 2008, <http://www.rfc-editor.org/info/rfc5322>.",
      "zh-CHS": "[RFC5322]Resnick，P.，Ed.，“互联网信息格式”，RFC5222008年10月<http://www.rfc-editor.org/info/rfc5322>."
    },
    {
      "indent": 3,
      "text": "[RFC5652] Housley, R., \"Cryptographic Message Syntax (CMS)\", STD 70, RFC 5652, September 2009, <http://www.rfc-editor.org/info/rfc5652>.",
      "zh-CHS": "[RFC5652]Housley，R.，“加密消息语法（CMS）”，STD 70，RFC 56522009年9月<http://www.rfc-editor.org/info/rfc5652>."
    },
    {
      "indent": 3,
      "text": "[RFC6376] Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed., \"DomainKeys Identified Mail (DKIM) Signatures\", STD 76, RFC 6376, September 2011, <http://www.rfc-editor.org/info/rfc6376>.",
      "zh-CHS": "[RFC6376]Crocker，D.，Ed.，Hansen，T.，Ed.，和M.Kucherawy，Ed.，“域密钥识别邮件（DKIM）签名”，STD 76，RFC 63762011年9月<http://www.rfc-editor.org/info/rfc6376>."
    },
    {
      "indent": 3,
      "text": "[ASN1-88] CCITT, Recommendation X.208: Specification of Abstract Syntax Notation One (ASN.1), 1988.",
      "zh-CHS": "[ASN1-88]CCITT，建议X.208：抽象语法符号1规范（ASN.1），1988年。"
    },
    {
      "indent": 0,
      "text": "9.2. Informative References",
      "section_title": true,
      "zh-CHS": "9.2. 资料性引用"
    },
    {
      "indent": 3,
      "text": "[PRHDRS] Liao, L. and J. Schwenk, \"Header Protection for S/MIME\", draft-liao-smimeheaderprotect-05, Work in Progress, June 2009.",
      "zh-CHS": "[PRHDRS]Liao，L.和J.Schwenk，“S/MIME的头保护”，草稿-Liao-smimeheaderprotect-05，正在进行的工作，2009年6月。"
    },
    {
      "indent": 3,
      "text": "[RFC2595] Newman, C., \"Using TLS with IMAP, POP3 and ACAP\", RFC 2595, June 1999, <http://www.rfc-editor.org/info/rfc2595>.",
      "zh-CHS": "[RFC2595]Newman，C.，“将TLS与IMAP、POP3和ACAP一起使用”，RFC2595，1999年6月<http://www.rfc-editor.org/info/rfc2595>."
    },
    {
      "indent": 3,
      "text": "[RFC3183] Dean, T. and W. Ottaway, \"Domain Security Services using S/MIME\", RFC 3183, October 2001, <http://www.rfc-editor.org/info/rfc3183>.",
      "zh-CHS": "[RFC3183]Dean，T.和W.Ottaway，“使用S/MIME的域安全服务”，RFC 31832001年10月<http://www.rfc-editor.org/info/rfc3183>."
    },
    {
      "indent": 3,
      "text": "[RFC3207] Hoffman, P., \"SMTP Service Extension for Secure SMTP over Transport Layer Security\", RFC 3207, February 2002, <http://www.rfc-editor.org/info/rfc3207>.",
      "zh-CHS": "[RFC3207]Hoffman，P.，“传输层安全SMTP的SMTP服务扩展”，RFC 3207，2002年2月<http://www.rfc-editor.org/info/rfc3207>."
    },
    {
      "indent": 3,
      "text": "[RFC3501] Crispin, M., \"INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1\", RFC 3501, March 2003, <http://www.rfc-editor.org/info/rfc3501>.",
      "zh-CHS": "[RFC3501]Crispin，M.，“互联网消息访问协议-版本4rev1”，RFC 35012003年3月<http://www.rfc-editor.org/info/rfc3501>."
    },
    {
      "indent": 3,
      "text": "[RFC5321] Klensin, J., \"Simple Mail Transfer Protocol\", RFC 5321, October 2008, <http://www.rfc-editor.org/info/rfc5321>.",
      "zh-CHS": "[RFC5321]Klensin，J.，“简单邮件传输协议”，RFC 53212008年10月<http://www.rfc-editor.org/info/rfc5321>."
    },
    {
      "indent": 3,
      "text": "[RFC5598] Crocker, D., \"Internet Mail Architecture\", RFC 5598, July 2009, <http://www.rfc-editor.org/info/rfc5598>.",
      "zh-CHS": "[RFC5598]Crocker，D.，“互联网邮件体系结构”，RFC 55982009年7月<http://www.rfc-editor.org/info/rfc5598>."
    },
    {
      "indent": 3,
      "text": "[RFC5750] Ramsdell, B. and S. Turner, \"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Certificate Handling\", RFC 5750, January 2010, <http://www.rfc-editor.org/info/rfc5750>.",
      "zh-CHS": "[RFC5750]Ramsdell，B.和S.Turner，“安全/多用途Internet邮件扩展（S/MIME）版本3.2证书处理”，RFC 57502010年1月<http://www.rfc-editor.org/info/rfc5750>."
    },
    {
      "indent": 3,
      "text": "[RFC5751] Ramsdell, B. and S. Turner, \"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification\", RFC 5751, January 2010, <http://www.rfc-editor.org/info/rfc5751>.",
      "zh-CHS": "[RFC5751]Ramsdell，B.和S.Turner，“安全/多用途Internet邮件扩展（S/MIME）版本3.2消息规范”，RFC 57512010年1月<http://www.rfc-editor.org/info/rfc5751>."
    },
    {
      "indent": 0,
      "text": "Appendix A. Formal Syntax of Secure Header",
      "section_title": true,
      "zh-CHS": "附录A.安全标头的形式语法"
    },
    {
      "indent": 3,
      "text": "Note: The ASN.1 module contained herein uses the 1988 version of ASN.1 notation [ASN1-88] for the purposes of alignment with the existing S/MIME specifications. The SecureHeaderFields structure is defined as follows:",
      "zh-CHS": "注：为了与现有S/MIME规范保持一致，本文包含的ASN.1模块使用了1988年版本的ASN.1符号[ASN1-88]。SecureHeaderFields结构定义如下："
    },
    {
      "indent": 5,
      "text": "mod-SMimeSecureHeadersV1\n  { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)\n  pkcs-9(9) smime(16) modules(0) secure-headers-v1(65) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "DEFINITIONS IMPLICIT TAGS ::=",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "BEGIN",
      "zh-CHS": "开始"
    },
    {
      "indent": 5,
      "text": "IMPORTS",
      "zh-CHS": "进口"
    },
    {
      "indent": 7,
      "text": "id-aa\n     FROM SecureMimeMessageV3dot1\n          { iso(1) member-body(2) us(840) rsadsi(113549)\n          pkcs(1) pkcs-9(9) smime(16) modules(0)\n          msg-v3dot1(21) };",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "-- id-aa is the arc with all new authenticated and\n-- unauthenticated attributes produced by the S/MIME\n-- Working Group",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "id-aa-secureHeaderFieldsIdentifier OBJECT IDENTIFIER ::= {\n   id-aa secure-headers(55) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "SecureHeaderFields ::= SET {\n     canonAlgorithm Algorithm,\n     secHeaderFields HeaderFields }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "Algorithm ::= ENUMERATED {\n     canonAlgorithmSimple(0),\n     canonAlgorithmRelaxed(1) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFields ::= SEQUENCE SIZE (1..MAX) OF HeaderField",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderField ::= SEQUENCE {\n     field-Name HeaderFieldName,\n     field-Value HeaderFieldValue,\n     field-Status HeaderFieldStatus DEFAULT duplicated }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldName ::= VisibleString (FROM (ALL EXCEPT (\":\")))\n     -- This description matches with the description of\n     -- field name in the Sections 2.2 and 3.6.8 of RFC 5322",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldValue ::= UTF8String\n     -- This description matches with the description of\n     -- field body in the Section 2.2 of RFC 5322 as\n     -- extended by Section 3.1 of RFC 6532.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "HeaderFieldStatus ::= INTEGER {\n     duplicated(0), deleted(1), modified(2) }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 6,
      "text": "END",
      "zh-CHS": "终止"
    },
    {
      "indent": 0,
      "text": "Appendix B. Example of Secure Header Fields",
      "section_title": true,
      "zh-CHS": "附录B.安全标题字段示例"
    },
    {
      "indent": 3,
      "text": "In the following example, the header fields subject, x-ximf-primary-precedence, and x-ximf-correspondance-type are secured and integrated in a SecureHeaderFields structure. This example should produce a valid signature.",
      "zh-CHS": "在下面的示例中，标题字段subject、x-ximf-primary-preference和x-ximf-correspondance-type是安全的，并集成在SecureHeaderFields结构中。此示例应生成有效的签名。"
    },
    {
      "indent": 3,
      "text": "Extract from the message header fields:",
      "zh-CHS": "从消息头字段中提取："
    },
    {
      "indent": 6,
      "text": "From: John Doe <jdoe@example.com>\nTo: Mary Smith <mary@example.com>\nsubject: This is a test of Ext.\nx-ximf-primary-precedence: priority\nx-ximf-correspondance-type: official",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The SecureHeaderFields structure extracted from the signature:",
      "zh-CHS": "从签名中提取的SecureHeaderFields结构："
    },
    {
      "indent": 3,
      "text": "2286  150: SEQUENCE {\n2289   11:   OBJECT IDENTIFIER '1 2 840 113549 1 9 16 2 80'\n2302  134:   SET {\n2305  131:     SET {\n2308    4:       ENUMERATED 1\n2314  123:       SEQUENCE {\n2316   40:         SEQUENCE {\n2318   25:           VisibleString 'x-ximf-primary-precedence'\n2345    8:           UTF8String 'priority'\n2355    1:           INTEGER 0\n         :           }\n2358   41:         SEQUENCE {\n2360   26:           VisibleString 'x-ximf-correspondance-type'\n2388    8:           UTF8String 'official'\n2398    1:           INTEGER 0\n         :           }\n2401   36:         SEQUENCE {\n2403    7:           VisibleString 'subject'\n2412   22:           UTF8String 'This is a test of Ext.'\n2436    1:           INTEGER 0\n         :           }\n         :         }\n         :       }\n         :     }\n         :   }",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The example is displayed as an output of Peter Gutmann's \"dumpasn1\" program.",
      "zh-CHS": "该示例显示为Peter Gutmann的“dumpasn1”程序的输出。"
    },
    {
      "indent": 3,
      "text": "OID used in this example is nonofficial.",
      "zh-CHS": "本例中使用的OID是非官方的。"
    },
    {
      "indent": 0,
      "text": "Acknowledgements",
      "zh-CHS": "致谢"
    },
    {
      "indent": 3,
      "text": "The authors would like to thank Jim Schaad, Alexey Melnikov, Damien Roque, Thibault Cassan, William Ottaway, and Sean Turner who kindly provided reviews of the document and/or suggestions for improvement. As always, all errors and omissions are the responsibility of the authors.",
      "zh-CHS": "作者要感谢Jim Schaad、Alexey Melnikov、Damien Roque、Thibault Cassan、William Ottaway和Sean Turner，他们友好地提供了文件审查和/或改进建议。一如既往，所有错误和遗漏均由作者负责。"
    },
    {
      "indent": 0,
      "text": "Authors' Addresses",
      "zh-CHS": "作者地址"
    },
    {
      "indent": 3,
      "text": "Laurent CAILLEUX DGA MI BP 7 35998 RENNES CEDEX 9 France",
      "zh-CHS": "劳伦特·凯勒英国石油公司DGA 7 35998雷恩塞德斯9法国"
    },
    {
      "indent": 3,
      "text": "EMail: laurent.cailleux@intradef.gouv.fr",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Chris Bonatti IECA, Inc. 3057 Nutley Street, Suite 106 Fairfax, VA 22031 United States",
      "zh-CHS": "Chris Bonatti IECA，Inc.美国弗吉尼亚州费尔法克斯市努特利街3057号106室，邮编22031"
    },
    {
      "indent": 3,
      "text": "EMail: bonatti252@ieca.com",
      "raw": true,
      "zh-CHS": " "
    }
  ]
}