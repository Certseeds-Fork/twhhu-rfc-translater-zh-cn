{
  "title": {
    "text": "RFC 8618: Compacted-DNS (C-DNS): A Format for DNS Packet Capture",
    "zh-CHS": "RFC 8618"
  },
  "number": 8618,
  "created_at": "2021-10-27 23:39:41.038751+08:00",
  "updated_by": "",
  "contents": [
    {
      "indent": 0,
      "text": "Internet Engineering Task Force (IETF)                      J. Dickinson\nRequest for Comments: 8618                                      J. Hague\nCategory: Standards Track                                   S. Dickinson\nISSN: 2070-1721                                               Sinodun IT\n                                                            T. Manderson\n                                                                   ICANN\n                                                                 J. Bond\n                                              Wikimedia Foundation, Inc.\n                                                          September 2019",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": "Compacted-DNS (C-DNS): A Format for DNS Packet Capture",
      "zh-CHS": "压缩DNS（C-DNS）：用于DNS数据包捕获的格式"
    },
    {
      "indent": 0,
      "text": "Abstract",
      "zh-CHS": "摘要"
    },
    {
      "indent": 3,
      "text": "This document describes a data representation for collections of DNS messages. The format is designed for efficient storage and transmission of large packet captures of DNS traffic; it attempts to minimize the size of such packet capture files but retain the full DNS message contents along with the most useful transport metadata. It is intended to assist with the development of DNS traffic-monitoring applications.",
      "zh-CHS": "本文档描述DNS消息集合的数据表示。该格式设计用于高效存储和传输DNS流量的大数据包捕获；它试图最小化此类数据包捕获文件的大小，但保留完整的DNS消息内容以及最有用的传输元数据。它旨在帮助开发DNS流量监控应用程序。"
    },
    {
      "indent": 0,
      "text": "Status of This Memo",
      "zh-CHS": "关于下段备忘"
    },
    {
      "indent": 3,
      "text": "This is an Internet Standards Track document.",
      "zh-CHS": "这是一份互联网标准跟踪文件。"
    },
    {
      "indent": 3,
      "text": "This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 7841.",
      "zh-CHS": "本文件是互联网工程任务组（IETF）的产品。它代表了IETF社区的共识。它已经接受了公众审查，并已被互联网工程指导小组（IESG）批准出版。有关互联网标准的更多信息，请参见RFC 7841第2节。"
    },
    {
      "indent": 3,
      "text": "Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at https://www.rfc-editor.org/info/rfc8618.",
      "zh-CHS": "有关本文件当前状态、任何勘误表以及如何提供反馈的信息，请访问https://www.rfc-editor.org/info/rfc8618."
    },
    {
      "indent": 0,
      "text": "Copyright Notice",
      "zh-CHS": "版权公告"
    },
    {
      "indent": 3,
      "text": "Copyright (c) 2019 IETF Trust and the persons identified as the document authors. All rights reserved.",
      "zh-CHS": "版权（c）2019 IETF信托基金和被确定为文件作者的人员。版权所有。"
    },
    {
      "indent": 3,
      "text": "This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.",
      "zh-CHS": "本文件受BCP 78和IETF信托有关IETF文件的法律规定的约束(https://trustee.ietf.org/license-info)自本文件出版之日起生效。请仔细阅读这些文件，因为它们描述了您对本文件的权利和限制。从本文件中提取的代码组件必须包括信托法律条款第4.e节中所述的简化BSD许可证文本，并提供简化BSD许可证中所述的无担保。"
    },
    {
      "indent": 0,
      "text": "Table of Contents",
      "zh-CHS": "目录"
    },
    {
      "indent": 3,
      "text": "1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4\n2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   5\n3.  Data Collection Use Cases . . . . . . . . . . . . . . . . . .   5\n4.  Design Considerations . . . . . . . . . . . . . . . . . . . .   8\n5.  Choice of CBOR  . . . . . . . . . . . . . . . . . . . . . . .  10\n6.  C-DNS Format Conceptual Overview  . . . . . . . . . . . . . .  10\n  6.1.  Block Parameters  . . . . . . . . . . . . . . . . . . . .  14\n  6.2.  Storage Parameters  . . . . . . . . . . . . . . . . . . .  14\n    6.2.1.  Optional Data Items . . . . . . . . . . . . . . . . .  15\n    6.2.2.  Optional RRs and OPCODEs  . . . . . . . . . . . . . .  16\n    6.2.3.  Storage Flags . . . . . . . . . . . . . . . . . . . .  17\n    6.2.4.  IP Address Storage  . . . . . . . . . . . . . . . . .  17\n7.  C-DNS Format Detailed Description . . . . . . . . . . . . . .  18\n  7.1.  Map Quantities and Indexes  . . . . . . . . . . . . . . .  18\n  7.2.  Tabular Representation  . . . . . . . . . . . . . . . . .  18\n  7.3.  \"File\"  . . . . . . . . . . . . . . . . . . . . . . . . .  19\n    7.3.1.  \"FilePreamble\"  . . . . . . . . . . . . . . . . . . .  20\n      7.3.1.1.  \"BlockParameters\" . . . . . . . . . . . . . . . .  20\n        7.3.1.1.1.  \"StorageParameters\" . . . . . . . . . . . . .  21\n          7.3.1.1.1.1.  \"StorageHints\"  . . . . . . . . . . . . .  22\n        7.3.1.1.2.  \"CollectionParameters\"  . . . . . . . . . . .  24\n    7.3.2.  \"Block\" . . . . . . . . . . . . . . . . . . . . . . .  25\n      7.3.2.1.  \"BlockPreamble\" . . . . . . . . . . . . . . . . .  26\n      7.3.2.2.  \"BlockStatistics\" . . . . . . . . . . . . . . . .  27\n      7.3.2.3.  \"BlockTables\" . . . . . . . . . . . . . . . . . .  28\n        7.3.2.3.1.  \"ClassType\" . . . . . . . . . . . . . . . . .  29\n        7.3.2.3.2.  \"QueryResponseSignature\"  . . . . . . . . . .  30\n        7.3.2.3.3.  \"Question\"  . . . . . . . . . . . . . . . . .  33\n        7.3.2.3.4.  \"RR\"  . . . . . . . . . . . . . . . . . . . .  34\n        7.3.2.3.5.  \"MalformedMessageData\"  . . . . . . . . . . .  34",
      "raw": true,
      "toc": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "      7.3.2.4.  \"QueryResponse\" . . . . . . . . . . . . . . . . .  35\n        7.3.2.4.1.  \"ResponseProcessingData\"  . . . . . . . . . .  36\n        7.3.2.4.2.  \"QueryResponseExtended\" . . . . . . . . . . .  37\n      7.3.2.5.  \"AddressEventCount\" . . . . . . . . . . . . . . .  38\n      7.3.2.6.  \"MalformedMessage\"  . . . . . . . . . . . . . . .  39\n8.  Versioning  . . . . . . . . . . . . . . . . . . . . . . . . .  39\n9.  C-DNS to PCAP . . . . . . . . . . . . . . . . . . . . . . . .  40\n  9.1.  Name Compression  . . . . . . . . . . . . . . . . . . . .  42\n10. Data Collection . . . . . . . . . . . . . . . . . . . . . . .  42\n  10.1.  Matching Algorithm . . . . . . . . . . . . . . . . . . .  43\n  10.2.  Message Identifiers  . . . . . . . . . . . . . . . . . .  45\n    10.2.1.  Primary ID (Required)  . . . . . . . . . . . . . . .  45\n    10.2.2.  Secondary ID (Optional)  . . . . . . . . . . . . . .  46\n  10.3.  Algorithm Parameters . . . . . . . . . . . . . . . . . .  46\n  10.4.  Algorithm Requirements . . . . . . . . . . . . . . . . .  46\n  10.5.  Algorithm Limitations  . . . . . . . . . . . . . . . . .  47\n  10.6.  Workspace  . . . . . . . . . . . . . . . . . . . . . . .  47\n  10.7.  Output . . . . . . . . . . . . . . . . . . . . . . . . .  47\n  10.8.  Post-Processing  . . . . . . . . . . . . . . . . . . . .  47\n11. Implementation Guidance . . . . . . . . . . . . . . . . . . .  47\n  11.1.  Optional Data  . . . . . . . . . . . . . . . . . . . . .  48\n  11.2.  Trailing Bytes . . . . . . . . . . . . . . . . . . . . .  48\n  11.3.  Limiting Collection of RDATA . . . . . . . . . . . . . .  49\n  11.4.  Timestamps . . . . . . . . . . . . . . . . . . . . . . .  49\n12. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  49\n  12.1.  Transport Types  . . . . . . . . . . . . . . . . . . . .  49\n  12.2.  Data Storage Flags . . . . . . . . . . . . . . . . . . .  50\n  12.3.  Response-Processing Flags  . . . . . . . . . . . . . . .  51\n  12.4.  AddressEvent Types . . . . . . . . . . . . . . . . . . .  51\n13. Security Considerations . . . . . . . . . . . . . . . . . . .  52\n14. Privacy Considerations  . . . . . . . . . . . . . . . . . . .  52\n15. References  . . . . . . . . . . . . . . . . . . . . . . . . .  53\n  15.1.  Normative References . . . . . . . . . . . . . . . . . .  53\n  15.2.  Informative References . . . . . . . . . . . . . . . . .  55\nAppendix A.  CDDL . . . . . . . . . . . . . . . . . . . . . . . .  58\nAppendix B.  DNS Name Compression Example . . . . . . . . . . . .  69\n  B.1.  NSD Compression Algorithm . . . . . . . . . . . . . . . .  70\n  B.2.  Knot Authoritative Compression Algorithm  . . . . . . . .  70\n  B.3.  Observed Differences  . . . . . . . . . . . . . . . . . .  71\nAppendix C.  Comparison of Binary Formats . . . . . . . . . . . .  71\n  C.1.  Comparison with Full PCAP Files . . . . . . . . . . . . .  74\n  C.2.  Simple versus Block Coding  . . . . . . . . . . . . . . .  74\n  C.3.  Binary versus Text Formats  . . . . . . . . . . . . . . .  75\n  C.4.  Performance . . . . . . . . . . . . . . . . . . . . . . .  75\n  C.5.  Conclusions . . . . . . . . . . . . . . . . . . . . . . .  75\n  C.6.  Block Size Choice . . . . . . . . . . . . . . . . . . . .  76",
      "raw": true,
      "toc": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Appendix D.  Data Fields for Traffic Regeneration . . . . . . . .  77\n  D.1.  Recommended Fields for Traffic Regeneration . . . . . . .  77\n  D.2.  Issues with Small Data Captures . . . . . . . . . . . . .  77\nAcknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  78\nAuthors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  79",
      "raw": true,
      "toc": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "1. Introduction",
      "section_title": true,
      "zh-CHS": "1. 介绍"
    },
    {
      "indent": 3,
      "text": "There has long been a need for server operators to collect DNS Queries and Responses on authoritative and recursive name servers for monitoring and analysis. This data is used in a number of ways, including traffic monitoring, analyzing network attacks, and \"day in the life\" (DITL) [ditl] analysis.",
      "zh-CHS": "长期以来，服务器运营商需要在权威和递归名称服务器上收集DNS查询和响应，以便进行监视和分析。这些数据有多种用途，包括流量监测、分析网络攻击和“日常生活”（DITL）[DITL]分析。"
    },
    {
      "indent": 3,
      "text": "A wide variety of tools already exist that facilitate the collection of DNS traffic data, such as the DNS Statistics Collector (DSC) [dsc], packetq [packetq], dnscap [dnscap], and dnstap [dnstap]. However, there is no standard exchange format for large DNS packet captures. The PCAP (\"packet capture\") [pcap] format or the PCAP Next Generation (PCAP-NG) [pcapng] format is typically used in practice for packet captures, but these file formats can contain a great deal of additional information that is not directly pertinent to DNS traffic analysis and thus unnecessarily increases the capture file size. Additionally, these tools and formats typically have no filter mechanism to selectively record only certain fields at capture time, requiring post-processing for anonymization or pseudonymization of data to protect user privacy.",
      "zh-CHS": "已经存在各种各样的工具来促进DNS流量数据的收集，例如DNS统计收集器（DSC）[DSC]、packetq[packetq]、dnscap[dnscap]和dnstap[dnstap]。但是，没有用于大型DNS数据包捕获的标准交换格式。PCAP（“数据包捕获”）[PCAP]格式或PCAP下一代（PCAP-NG）[pcapng]格式通常在实践中用于数据包捕获，但这些文件格式可能包含大量与DNS流量分析不直接相关的附加信息，因此不必要地增加捕获文件的大小。此外，这些工具和格式通常没有过滤机制，在捕获时仅选择性地记录某些字段，需要对数据进行匿名或假名化后处理，以保护用户隐私。"
    },
    {
      "indent": 3,
      "text": "There has also been work on using text-based formats to describe DNS packets (for example, see [dnsxml] and [RFC8427]), but this work is largely aimed at producing convenient representations of single messages.",
      "zh-CHS": "也有关于使用基于文本的格式来描述DNS数据包的工作（例如，请参见[dnsxml]和[RFC8427]），但这项工作主要是为了方便地表示单个消息。"
    },
    {
      "indent": 3,
      "text": "Many DNS operators may receive hundreds of thousands of Queries per second on a single name server instance, so a mechanism to minimize the storage and transmission size (and therefore upload overhead) of the data collected is highly desirable.",
      "zh-CHS": "许多DNS运营商每秒可能会在单个名称服务器实例上接收数十万个查询，因此非常需要一种机制来最小化所收集数据的存储和传输大小（从而减少上传开销）。"
    },
    {
      "indent": 3,
      "text": "The format described in this document, C-DNS (Compacted-DNS), focuses on the problem of capturing and storing large packet capture files of DNS traffic with the following goals in mind:",
      "zh-CHS": "本文档中描述的格式C-DNS（压缩DNS）侧重于捕获和存储DNS流量的大型数据包捕获文件的问题，并牢记以下目标："
    },
    {
      "indent": 3,
      "text": "o Minimize the file size for storage and transmission.",
      "zh-CHS": "o 最小化存储和传输的文件大小。"
    },
    {
      "indent": 3,
      "text": "o Minimize the overhead of producing the packet capture file and the cost of any further (general-purpose) compression of the file.",
      "zh-CHS": "o 将生成数据包捕获文件的开销和进一步（通用）压缩文件的成本降至最低。"
    },
    {
      "indent": 3,
      "text": "This document contains:",
      "zh-CHS": "本文件包括："
    },
    {
      "indent": 3,
      "text": "o A discussion of some common use cases in which DNS data is collected; see Section 3.",
      "zh-CHS": "o 讨论收集DNS数据的一些常见用例；见第3节。"
    },
    {
      "indent": 3,
      "text": "o A discussion of the major design considerations in developing an efficient data representation for collections of DNS messages; see Section 4.",
      "zh-CHS": "o 讨论为DNS消息集合开发有效数据表示时的主要设计考虑事项；见第4节。"
    },
    {
      "indent": 3,
      "text": "o A description of why the Concise Binary Object Representation (CBOR) [RFC7049] was chosen for this format; see Section 5.",
      "zh-CHS": "o 说明为何为该格式选择简明二进制对象表示法（CBOR）[RFC7049]；见第5节。"
    },
    {
      "indent": 3,
      "text": "o A conceptual overview of the C-DNS format; see Section 6.",
      "zh-CHS": "o C-DNS格式的概念概述；见第6节。"
    },
    {
      "indent": 3,
      "text": "o The definition of the C-DNS format for the collection of DNS messages; see Section 7.",
      "zh-CHS": "o 用于收集DNS消息的C-DNS格式的定义；见第7节。"
    },
    {
      "indent": 3,
      "text": "o Notes on converting C-DNS data to PCAP format; see Section 9.",
      "zh-CHS": "o 关于将C-DNS数据转换为PCAP格式的说明；见第9节。"
    },
    {
      "indent": 3,
      "text": "o Some high-level implementation considerations for applications designed to produce C-DNS; see Section 10.",
      "zh-CHS": "o 设计用于产生C-DNS的应用程序的一些高级实现注意事项；见第10节。"
    },
    {
      "indent": 0,
      "text": "2. Terminology",
      "section_title": true,
      "zh-CHS": "2. 术语"
    },
    {
      "indent": 3,
      "text": "The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all capitals, as shown here.",
      "zh-CHS": "本文件中的关键词“必须”、“不得”、“必需”、“应”、“不应”、“建议”、“不建议”、“可”和“可选”在所有大写字母出现时（如图所示）应按照BCP 14[RFC2119][RFC8174]所述进行解释。"
    },
    {
      "indent": 3,
      "text": "\"Packet\" refers to an individual IPv4 or IPv6 packet. Typically, packets are UDP datagrams, but such packets may also be part of a TCP data stream. \"Message\", unless otherwise qualified, refers to a DNS payload extracted from a UDP datagram or a TCP data stream.",
      "zh-CHS": "“数据包”指单个IPv4或IPv6数据包。通常，数据包是UDP数据报，但此类数据包也可能是TCP数据流的一部分。除非另有限定，“消息”是指从UDP数据报或TCP数据流提取的DNS有效负载。"
    },
    {
      "indent": 3,
      "text": "The parts of DNS messages are named as they are in [RFC1035]. Specifically, the DNS message has five sections: Header, Question, Answer, Authority, and Additional.",
      "zh-CHS": "DNS消息的部分按[RFC1035]中的名称命名。具体来说，DNS消息有五个部分：标题、问题、答案、权限和附加信息。"
    },
    {
      "indent": 0,
      "text": "3. Data Collection Use Cases",
      "section_title": true,
      "zh-CHS": "3. 数据收集用例"
    },
    {
      "indent": 3,
      "text": "From a purely server operator perspective, collecting full packet captures of all packets going into or out of a name server provides the most comprehensive picture of network activity. However, there are several design choices or other limitations that are common to many DNS installations and operators.",
      "zh-CHS": "从纯服务器运营商的角度来看，收集进入或离开名称服务器的所有数据包的完整数据包捕获提供了最全面的网络活动图片。但是，许多DNS安装和运营商都有一些设计选择或其他限制。"
    },
    {
      "indent": 3,
      "text": "o DNS servers are hosted in a variety of situations:",
      "zh-CHS": "o DNS服务器托管在多种情况下："
    },
    {
      "indent": 6,
      "text": "* Self-hosted servers",
      "zh-CHS": "* 自托管服务器"
    },
    {
      "indent": 6,
      "text": "* Third-party hosting (including multiple third parties)",
      "zh-CHS": "* 第三方托管（包括多个第三方）"
    },
    {
      "indent": 6,
      "text": "* Third-party hardware (including multiple third parties)",
      "zh-CHS": "* 第三方硬件（包括多个第三方）"
    },
    {
      "indent": 3,
      "text": "o Data is collected under different conditions:",
      "zh-CHS": "o 在不同条件下收集数据："
    },
    {
      "indent": 6,
      "text": "* On well-provisioned servers running in a steady state",
      "zh-CHS": "* 在配置良好的服务器上以稳定状态运行"
    },
    {
      "indent": 6,
      "text": "* On heavily loaded servers",
      "zh-CHS": "* 在负载沉重的服务器上"
    },
    {
      "indent": 6,
      "text": "* On virtualized servers",
      "zh-CHS": "* 在虚拟化服务器上"
    },
    {
      "indent": 6,
      "text": "* On servers that are under DoS attack",
      "zh-CHS": "* 在受到DoS攻击的服务器上"
    },
    {
      "indent": 6,
      "text": "* On servers that are unwitting intermediaries in DoS attacks",
      "zh-CHS": "* 在DoS攻击中作为不知情中介的服务器上"
    },
    {
      "indent": 3,
      "text": "o Traffic can be collected via a variety of mechanisms:",
      "zh-CHS": "o 可以通过多种机制收集流量："
    },
    {
      "indent": 6,
      "text": "* Within the name server implementation itself",
      "zh-CHS": "* 在名称服务器实现本身中"
    },
    {
      "indent": 6,
      "text": "* On the same hardware as the name server itself",
      "zh-CHS": "* 在与名称服务器本身相同的硬件上"
    },
    {
      "indent": 6,
      "text": "* Using a network tap on an adjacent host to listen to DNS traffic",
      "zh-CHS": "* 在相邻主机上使用网络点击监听DNS流量"
    },
    {
      "indent": 6,
      "text": "* Using port mirroring to listen from another host",
      "zh-CHS": "* 使用端口镜像从另一台主机侦听"
    },
    {
      "indent": 3,
      "text": "o The capabilities of data collection (and upload) networks vary:",
      "zh-CHS": "o 数据收集（和上传）网络的功能各不相同："
    },
    {
      "indent": 6,
      "text": "* Out-of-band networks with the same capacity as the in-band network",
      "zh-CHS": "* 与带内网络容量相同的带外网络"
    },
    {
      "indent": 6,
      "text": "* Out-of-band networks with less capacity than the in-band network",
      "zh-CHS": "* 容量小于带内网络的带外网络"
    },
    {
      "indent": 6,
      "text": "* Everything being on the in-band network",
      "zh-CHS": "* 一切都在带内网络上"
    },
    {
      "indent": 3,
      "text": "Thus, there is a wide range of use cases, from very limited data collection environments (third-party hardware, servers that are under attack, packet capture on the name server itself and no out-of-band network) to \"limitless\" environments (self-hosted, well-provisioned servers, using a network tap or port mirroring with out-of-band networks with the same capacity as the in-band network). In the",
      "zh-CHS": "因此，从非常有限的数据收集环境（第三方硬件、受到攻击的服务器、名称服务器本身上的数据包捕获以及没有带外网络）到“无限”环境，存在着广泛的用例（自托管、资源调配良好的服务器，使用网络分接或端口镜像，带外网络的容量与带内网络的容量相同）"
    },
    {
      "indent": 3,
      "text": "former case, it is infeasible to reliably collect full packet captures, especially if the server is under attack. In the latter case, collection of full packet captures may be reasonable.",
      "zh-CHS": "在前一种情况下，可靠地收集完整的数据包捕获是不可行的，尤其是当服务器受到攻击时。在后一种情况下，收集完整数据包捕获可能是合理的。"
    },
    {
      "indent": 3,
      "text": "As a result of these restrictions, the C-DNS data format is designed with the most limited use case in mind, such that:",
      "zh-CHS": "由于这些限制，C-DNS数据格式的设计考虑了最有限的用例，例如："
    },
    {
      "indent": 3,
      "text": "o Data collection will occur on the same hardware as the name server itself",
      "zh-CHS": "o 数据收集将在与名称服务器本身相同的硬件上进行"
    },
    {
      "indent": 3,
      "text": "o Collected data will be stored on the same hardware as the name server itself, at least temporarily",
      "zh-CHS": "o 收集的数据将与名称服务器本身存储在同一硬件上，至少是暂时存储"
    },
    {
      "indent": 3,
      "text": "o Collected data being returned to some central analysis system will use the same network interface as the DNS Queries and Responses",
      "zh-CHS": "o 返回到某个中央分析系统的收集数据将使用与DNS查询和响应相同的网络接口"
    },
    {
      "indent": 3,
      "text": "o There can be multiple third-party servers involved",
      "zh-CHS": "o 可能涉及多个第三方服务器"
    },
    {
      "indent": 3,
      "text": "Because of these considerations, a major factor in the design of the format is minimal storage size of the capture files.",
      "zh-CHS": "由于这些考虑，格式设计中的一个主要因素是捕获文件的最小存储大小。"
    },
    {
      "indent": 3,
      "text": "Another significant consideration for any application that records DNS traffic is that the running of the name server software and the transmission of DNS Queries and Responses are the most important jobs of a name server; capturing data is not. Any data collection system co-located with the name server needs to be intelligent enough to carefully manage its CPU, disk, memory, and network utilization. This leads to designing a format that requires a relatively low overhead to produce and minimizes the requirement for further potentially costly compression.",
      "zh-CHS": "记录DNS流量的任何应用程序的另一个重要考虑因素是名称服务器软件的运行以及DNS查询和响应的传输是名称服务器最重要的工作；捕获数据并非易事。任何与名称服务器共存的数据采集系统都需要足够智能，以便仔细管理其CPU、磁盘、内存和网络利用率。这将导致设计一种格式，该格式需要相对较低的开销来生成，并最大限度地减少对进一步的潜在昂贵压缩的需求。"
    },
    {
      "indent": 3,
      "text": "However, it is also essential that interoperability with less restricted infrastructure is maintained. In particular, it is highly desirable that the collection format should facilitate the re-creation of common formats (such as PCAP) that are as close to the original as is realistic, given the restrictions above.",
      "zh-CHS": "然而，保持与限制较少的基础设施的互操作性也是至关重要的。特别是，考虑到上述限制，收集格式应该有助于重新创建尽可能接近原始格式的通用格式（如PCAP）。"
    },
    {
      "indent": 0,
      "text": "4. Design Considerations",
      "section_title": true,
      "zh-CHS": "4. 设计考虑"
    },
    {
      "indent": 3,
      "text": "This section presents some of the major design considerations used in the development of the C-DNS format.",
      "zh-CHS": "本节介绍了C-DNS格式开发中使用的一些主要设计注意事项。"
    },
    {
      "indent": 3,
      "text": "1. The basic unit of data is a combined DNS Query and the associated Response (a \"Query/Response (Q/R) data item\"). The same structure will be used for unmatched Queries and Responses. Queries without Responses will be captured omitting the Response data. Responses without Queries will be captured omitting the Query data (but using the Question section from the Response, if present, as an identifying QNAME).",
      "zh-CHS": "1. 数据的基本单位是一个组合的DNS查询和相关的响应（“查询/响应（Q/R）数据项”）。相同的结构将用于不匹配的查询和响应。将捕获没有响应的查询，而忽略响应数据。将捕获不带查询的响应，忽略查询数据（但使用响应中的问题部分（如果存在）作为标识QNAME）。"
    },
    {
      "indent": 7,
      "text": "* Rationale: A Query and the associated Response represent the basic level of a client's interaction with the server. Also, combining the Query and Response into one item often reduces storage requirements due to commonality in the data of the two messages.",
      "zh-CHS": "* 理由：查询和相关响应表示客户端与服务器交互的基本级别。此外，由于两条消息的数据具有共性，因此将查询和响应组合到一个项目中通常会减少存储需求。"
    },
    {
      "indent": 7,
      "text": "In the context of generating a C-DNS file, it is assumed that only those DNS payloads that can be parsed to produce a well-formed DNS message are stored in the structured Query/ Response data items of the C-DNS format and that all other messages will (optionally) be recorded as separate malformed messages. Parsing a well-formed message means, at a minimum, the following:",
      "zh-CHS": "在生成C-DNS文件的上下文中，假设只有那些可被解析以生成格式良好的DNS消息的DNS有效负载存储在C-DNS格式的结构化查询/响应数据项中，并且所有其他消息（可选）将被记录为单独的格式错误的消息。解析格式良好的消息至少意味着："
    },
    {
      "indent": 7,
      "text": "* The packet has a well-formed 12-byte DNS Header with a recognized OPCODE.",
      "zh-CHS": "* 该数据包具有格式良好的12字节DNS报头，带有可识别的操作码。"
    },
    {
      "indent": 7,
      "text": "* The section counts are consistent with the section contents.",
      "zh-CHS": "* 章节数量与章节内容一致。"
    },
    {
      "indent": 7,
      "text": "* All of the Resource Records (RRs) can be fully parsed.",
      "zh-CHS": "* 所有资源记录（RRs）都可以完全解析。"
    },
    {
      "indent": 3,
      "text": "2. All top-level fields in each Query/Response data item will be optional.",
      "zh-CHS": "2. 每个查询/响应数据项中的所有顶级字段都是可选的。"
    },
    {
      "indent": 7,
      "text": "* Rationale: Different operators will have different requirements for data to be available for analysis. Operators with minimal requirements should not have to pay the cost of recording full data, though this will limit the ability to perform certain kinds of data analysis and also to reconstruct packet captures. For example, omitting the RRs from a Response will reduce the C-DNS file size; in principle, Responses can be synthesized if there is enough context. Operators may have different policies for collecting user data and can choose to omit or anonymize certain fields at capture time, e.g., client address.",
      "zh-CHS": "* 理由：不同的操作员对可用于分析的数据有不同的要求。具有最低要求的操作员不必支付记录完整数据的成本，尽管这将限制执行某些类型的数据分析以及重构数据包捕获的能力。例如，从响应中省略RRs将减小C-DNS文件的大小；原则上，如果有足够的上下文，可以合成响应。运营商可能有不同的收集用户数据的策略，并且可以选择在捕获时省略或匿名某些字段，例如客户端地址。"
    },
    {
      "indent": 3,
      "text": "3. Multiple Query/Response data items will be collected into blocks in the format. Common data in a block will be abstracted and referenced from individual Query/Response data items by indexing. The maximum number of Query/Response data items in a block will be configurable.",
      "zh-CHS": "3. 多个查询/响应数据项将按以下格式收集到块中。块中的公共数据将通过索引从单个查询/响应数据项中提取和引用。可配置块中查询/响应数据项的最大数量。"
    },
    {
      "indent": 7,
      "text": "* Rationale: This blocking and indexing action provides a significant reduction in the volume of file data generated. Although this introduces complexity, it provides compression of the data that makes use of knowledge of the DNS message structure.",
      "zh-CHS": "* 理由：这种阻塞和索引操作大大减少了生成的文件数据量。尽管这引入了复杂性，但它利用DNS消息结构的知识提供了数据压缩。"
    },
    {
      "indent": 7,
      "text": "* It is anticipated that the files produced can be subject to further compression using general-purpose compression tools. Measurements show that blocking significantly reduces the CPU required to perform such strong compression. See Appendix C.2.",
      "zh-CHS": "* 预计生成的文件可以使用通用压缩工具进行进一步压缩。测量结果表明，阻塞显著减少了执行这种强压缩所需的CPU。见附录C.2。"
    },
    {
      "indent": 7,
      "text": "* Examples of commonality between DNS messages are that in most cases the QUESTION RR is the same in the Query and Response and that there is a finite set of Query \"signatures\" (based on a subset of attributes). For many authoritative servers, there is very likely to be a finite set of Responses that are generated, of which a large number are NXDOMAIN.",
      "zh-CHS": "* DNS消息之间的共性示例是，在大多数情况下，问题RR在查询和响应中是相同的，并且存在一组有限的查询“签名”（基于属性子集）。对于许多权威服务器，很可能会生成有限的响应集，其中大量响应是在域中生成的。"
    },
    {
      "indent": 3,
      "text": "4. Traffic metadata can optionally be included in each block. Specifically, counts of some types of non-DNS packets (e.g., ICMP, TCP resets) sent to the server may be of interest.",
      "zh-CHS": "4. 流量元数据可以选择性地包含在每个块中。具体地说，发送到服务器的某些类型的非DNS数据包（例如，ICMP、TCP重置）的计数可能是令人感兴趣的。"
    },
    {
      "indent": 3,
      "text": "5. The wire-format content of malformed DNS messages may optionally be recorded.",
      "zh-CHS": "5. 可以选择性地记录格式错误的DNS消息的有线格式内容。"
    },
    {
      "indent": 7,
      "text": "* Rationale: Any structured capture format that does not capture the DNS payload byte for byte will be limited to some extent in that it cannot represent malformed DNS messages. Only those messages that can be fully parsed and transformed into the structured format can be fully represented. Note, however, that this can result in rather misleading statistics. For example, a malformed Query that cannot be represented in the C-DNS format will lead to the (well-formed) DNS Response with error code FORMERR appearing as \"unmatched\". Therefore, it can greatly aid downstream analysis to have the wire format of the malformed DNS messages available directly in the C-DNS file.",
      "zh-CHS": "* 理由：任何不逐字节捕获DNS有效负载的结构化捕获格式都会受到一定程度的限制，因为它不能表示格式错误的DNS消息。只有那些可以完全解析并转换为结构化格式的消息才能完全表示。然而，请注意，这可能会导致误导性的统计数据。例如，无法以C-DNS格式表示的格式错误的查询将导致（格式正确的）DNS响应，错误代码FORMERR显示为“不匹配”。因此，在C-DNS文件中直接提供格式错误的DNS消息的有线格式可以极大地帮助下游分析。"
    },
    {
      "indent": 0,
      "text": "5. Choice of CBOR",
      "section_title": true,
      "zh-CHS": "5. CBOR的选择"
    },
    {
      "indent": 3,
      "text": "This document presents a detailed format description for C-DNS. The format uses CBOR [RFC7049].",
      "zh-CHS": "本文档提供了C-DNS的详细格式说明。该格式使用CBOR[RFC7049]。"
    },
    {
      "indent": 3,
      "text": "The choice of CBOR was made taking a number of factors into account.",
      "zh-CHS": "CBOR的选择考虑了许多因素。"
    },
    {
      "indent": 3,
      "text": "o CBOR is a binary representation and thus is economical in storage space.",
      "zh-CHS": "o CBOR是一种二进制表示，因此在存储空间上是经济的。"
    },
    {
      "indent": 3,
      "text": "o Other binary representations were investigated, and whilst all had attractive features, none had a significant advantage over CBOR. See Appendix C for some discussion of this.",
      "zh-CHS": "o 研究了其他二进制表示法，虽然所有表示法都具有吸引人的特征，但没有一种表示法比CBOR具有显著优势。有关这方面的一些讨论，请参见附录C。"
    },
    {
      "indent": 3,
      "text": "o CBOR is an IETF specification and is familiar to IETF participants. It is based on the now-common ideas of lists and objects and thus requires very little familiarization for those in the wider industry.",
      "zh-CHS": "o CBOR是IETF规范，IETF参与者熟悉。它是基于现在对列表和对象的常见想法，因此对更广泛行业的人来说几乎不需要熟悉。"
    },
    {
      "indent": 3,
      "text": "o CBOR is a simple format and can easily be implemented from scratch if necessary. Formats that are more complex require library support, which may present problems on unusual platforms.",
      "zh-CHS": "o CBOR是一种简单的格式，如果需要，可以很容易地从头开始实现。更复杂的格式需要库支持，这在不寻常的平台上可能会出现问题。"
    },
    {
      "indent": 3,
      "text": "o CBOR can also be easily converted to text formats such as JSON [RFC8259] for debugging and other human inspection requirements.",
      "zh-CHS": "o CBOR还可以轻松转换为JSON[RFC8259]等文本格式，用于调试和其他人工检查需求。"
    },
    {
      "indent": 3,
      "text": "o CBOR data schemas can be described using the Concise Data Definition Language (CDDL) [RFC8610].",
      "zh-CHS": "o CBOR数据模式可以使用简明数据定义语言（CDDL）[RFC8610]来描述。"
    },
    {
      "indent": 0,
      "text": "6. C-DNS Format Conceptual Overview",
      "section_title": true,
      "zh-CHS": "6. C-DNS格式概念概述"
    },
    {
      "indent": 3,
      "text": "The following figures show purely schematic representations of the C-DNS format to convey the high-level structure of the C-DNS format. Section 7 provides a detailed discussion of the CBOR representation and individual elements.",
      "zh-CHS": "下图显示了C-DNS格式的纯示意图，以传达C-DNS格式的高级结构。第7节详细讨论了CBOR表示和各个要素。"
    },
    {
      "indent": 3,
      "text": "Figure 1 shows the C-DNS format at the top level, including the file header and data blocks. The Query/Response data items, Address/Event Count data items, and Malformed Message data items link to various Block Tables.",
      "zh-CHS": "图1显示了顶层的C-DNS格式，包括文件头和数据块。查询/响应数据项、地址/事件计数数据项和格式错误的消息数据项链接到各种块表。"
    },
    {
      "indent": 19,
      "text": "+-------+\n+ C-DNS |\n+-------+--------------------------+\n| File Type Identifier             |\n+----------------------------------+\n| File Preamble                    |\n| +--------------------------------+\n| | Format Version                 |\n| +--------------------------------+\n| | Block Parameters               |\n+-+--------------------------------+\n| Block                            |\n| +--------------------------------+\n| | Block Preamble                 |\n| +--------------------------------+\n| | Block Statistics               |\n| +--------------------------------+\n| | Block Tables                   |\n| +--------------------------------+\n| | Query/Response data items      |\n| +--------------------------------+\n| | Address/Event Count data items |\n| +--------------------------------+\n| | Malformed Message data items   |\n+-+--------------------------------+\n| Block                            |\n| +--------------------------------+\n| | Block Preamble                 |\n| +--------------------------------+\n| | Block Statistics               |\n| +--------------------------------+\n| | Block Tables                   |\n| +--------------------------------+\n| | Query/Response data items      |\n| +--------------------------------+\n| | Address/Event Count data items |\n| +--------------------------------+\n| | Malformed Message data items   |\n+-+--------------------------------+\n| Further Blocks...                |\n+----------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 24,
      "text": "Figure 1: The C-DNS Format",
      "zh-CHS": "图1：C-DNS格式"
    },
    {
      "indent": 3,
      "text": "Figure 2 shows some more-detailed relationships within each Block, specifically those between the Query/Response data item and the relevant Block Tables. Some fields have been omitted for clarity.",
      "zh-CHS": "图2显示了每个块内的一些更详细的关系，特别是查询/响应数据项和相关块表之间的关系。为了清楚起见，省略了一些字段。"
    },
    {
      "indent": 3,
      "text": "+----------------+\n| Query/Response |\n+-------------------------+\n| Time Offset             |\n+-------------------------+            +------------------+\n| Client Address          |---------+->| IP Address array |\n+-------------------------+         |  +------------------+\n| Client Port             |         |\n+-------------------------+         |  +------------------+\n| Transaction ID          |     +---)->| Name/RDATA array |<--------+\n+-------------------------+     |   |  +------------------+         |\n| Query Signature         |--+  |   |                               |\n+-------------------------+  |  |   |  +-----------------+          |\n| Client Hoplimit (q)     |  +--)---)->| Query Signature |          |\n+-------------------------+     |   |  +-----------------+-------+  |\n| Response Delay (r)      |     |   +--| Server Address          |  |\n+-------------------------+     |      +-------------------------+  |\n| Query Name              |--+--+      | Server Port             |  |\n+-------------------------+  |         +-------------------------+  |\n| Query Size (q)          |  |         | Transport Flags         |  |\n+-------------------------+  |         +-------------------------+  |\n| Response Size (r)       |  |         | QR Type                 |  |\n+-------------------------+  |         +-------------------------+  |\n| Response Processing (r) |  |         | QR Signature Flags      |  |\n| +-----------------------+  |         +-------------------------+  |\n| | Bailiwick             |--+         | Query OPCODE (q)        |  |\n| +-----------------------+            +-------------------------+  |\n| | Flags                 |            | QR DNS Flags            |  |\n+-+-----------------------+            +-------------------------+  |\n| Extra Query Info (q)    |            | Query RCODE (q)         |  |\n| +-----------------------+            +-------------------------+  |\n| | Question              |--+---+  +--+-Query Class/Type (q)    |  |\n| +-----------------------+      |  |  +-------------------------+  |\n| | Answer                |--+   |  |  | Query QDCOUNT (q)       |  |\n| +-----------------------+  |   |  |  +-------------------------+  |\n| | Authority             |--+   |  |  | Query ANCOUNT (q)       |  |\n| +-----------------------+  |   |  |  +-------------------------+  |\n| | Additional            |--+   |  |  | Query NSCOUNT (q)       |  |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "+-+-----------------------+  |   |  |  +-------------------------+  |\n| Extra Response Info (r) |  |-+ |  |  | Query ARCOUNT (q)       |  |\n| +-----------------------+  | | |  |  +-------------------------+  |\n| | Answer                |--+ | |  |  | Query EDNS version (q)  |  |\n| +-----------------------+  | | |  |  +-------------------------+  |\n| | Authority             |--+ | |  |  | Query EDNS UDP Size (q) |  |\n| +-----------------------+  | | |  |  +-------------------------+  |\n| | Additional            |--+ | |  |  | Query OPT RDATA (q)     |--+\n+-+-----------------------+    | |  |  +-------------------------+  |\n                               | |  |  | Response RCODE (r)      |  |\n                               | |  |  +-------------------------+  |\n+ -----------------------------+ |  +----------+                    |\n|                                |             |                    |\n| + -----------------------------+             |                    |\n| |  +---------------+  +----------+           |                    |\n| +->| Question List |->| Question |           |                    |\n|    | array         |  | array    |           |                    |\n|    +---------------+  +----------+--+        |                    |\n|                       | Name        |--+-----)--------------------+\n|                       +-------------+  |     |  +------------+\n|                       | Class/Type  |--)---+-+->| Class/Type |\n|                       +-------------+  |   |    | array      |\n|                                        |   |    +------------+--+\n|                                        |   |    | CLASS         |\n|    +---------------+  +----------+     |   |    +---------------+\n+--->| RR List array |->| RR array |     |   |    | TYPE          |\n     +---------+-----+  +----------+--+  |   |    +---------------+\n                        | Name        |--+   |\n                        +-------------+      |\n                        | Class/Type  |------+\n                        +-------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 7,
      "text": "Figure 2: The Query/Response Data Item and Subsidiary Tables",
      "zh-CHS": "图2：查询/响应数据项和子表"
    },
    {
      "indent": 3,
      "text": "In Figure 2, data items annotated (q) are only present when a Query/Response has a Query, and those annotated (r) are only present when a Query/Response Response is present.",
      "zh-CHS": "在图2中，注释（q）的数据项仅在查询/响应有查询时出现，注释（r）的数据项仅在查询/响应出现时出现。"
    },
    {
      "indent": 3,
      "text": "A C-DNS file begins with a file header containing a File Type Identifier and a File Preamble. The File Preamble contains information on the file Format Version and an array of Block Parameters items (the contents of which include Collection and Storage Parameters used for one or more Blocks).",
      "zh-CHS": "C-DNS文件以包含文件类型标识符和文件前导的文件头开始。文件序言包含有关文件格式版本的信息和块参数项数组（其内容包括用于一个或多个块的收集和存储参数）。"
    },
    {
      "indent": 3,
      "text": "The file header is followed by a series of Blocks.",
      "zh-CHS": "文件头后面跟着一系列块。"
    },
    {
      "indent": 3,
      "text": "A Block consists of a Block Preamble item, some Block Statistics for the traffic stored within the Block, and then various arrays of common data collectively called the Block Tables. This is then followed by an array of the Query/Response data items detailing the Queries and Responses stored within the Block. The array of Query/Response data items is in turn followed by the Address/Event Count data items (an array of per-client counts of particular IP events) and then Malformed Message data items (an array of malformed messages that are stored in the Block).",
      "zh-CHS": "一个块由一个块前导项、存储在该块中的流量的一些块统计信息，以及各种公共数据数组（统称为块表）组成。然后是查询/响应数据项数组，详细说明块中存储的查询和响应。查询/响应数据项的数组依次是地址/事件计数数据项（特定IP事件的每个客户端计数的数组）和格式错误的消息数据项（存储在块中的格式错误的消息数组）。"
    },
    {
      "indent": 3,
      "text": "The exact nature of the DNS data will affect what Block size is the best fit; however, sample data for a root server indicated that Block sizes up to 10,000 Query/Response data items give good results. See Appendix C.6 for more details.",
      "zh-CHS": "DNS数据的确切性质将影响最适合的块大小；但是，根服务器的示例数据表明，块大小高达10000个查询/响应数据项可以提供良好的结果。详见附录C.6。"
    },
    {
      "indent": 3,
      "text": "This design exploits data commonality and block-based storage to minimize the C-DNS file size. As a result, C-DNS cannot be streamed below the level of a Block.",
      "zh-CHS": "此设计利用数据通用性和基于块的存储来最小化C-DNS文件大小。因此，C-DNS不能在块级别以下进行流式传输。"
    },
    {
      "indent": 0,
      "text": "6.1. Block Parameters",
      "section_title": true,
      "zh-CHS": "6.1. 块参数"
    },
    {
      "indent": 3,
      "text": "The details of the Block Parameters items are not shown in the diagrams but are discussed here for context.",
      "zh-CHS": "图中未显示块参数项的详细信息，但此处将根据上下文进行讨论。"
    },
    {
      "indent": 3,
      "text": "An array of Block Parameters items is stored in the File Preamble (with a minimum of one item at index 0); a Block Parameters item consists of a collection of Storage and Collection Parameters that applies to any given Block. An array is used in order to support use cases such as wanting to merge C-DNS files from different sources. The Block Preamble item then contains an optional index for the Block Parameters item that applies for that Block; if not present, the index defaults to 0. Hence, in effect, a global Block Parameters item is defined that can then be overridden per Block.",
      "zh-CHS": "块参数项的数组存储在文件前导中（索引0处至少有一项）；块参数项由应用于任何给定块的存储参数和集合参数的集合组成。阵列用于支持用例，例如希望合并来自不同来源的C-DNS文件。然后，块前导项包含适用于该块的块参数项的可选索引；如果不存在，则索引默认为0。因此，实际上，定义了一个全局块参数项，然后可以在每个块上覆盖该项。"
    },
    {
      "indent": 0,
      "text": "6.2. Storage Parameters",
      "section_title": true,
      "zh-CHS": "6.2. 存储参数"
    },
    {
      "indent": 3,
      "text": "The Block Parameters item includes a Storage Parameters item -- this contains information about the specific data fields stored in the C-DNS file.",
      "zh-CHS": "块参数项包括存储参数项——它包含有关存储在C-DNS文件中的特定数据字段的信息。"
    },
    {
      "indent": 3,
      "text": "These parameters include:",
      "zh-CHS": "这些参数包括："
    },
    {
      "indent": 3,
      "text": "o The sub-second timing resolution used by the data.",
      "zh-CHS": "o 数据使用的次秒计时分辨率。"
    },
    {
      "indent": 3,
      "text": "o Information (hints) on which optional data are omitted. See Section 6.2.1.",
      "zh-CHS": "o 省略可选数据的信息（提示）。见第6.2.1节。"
    },
    {
      "indent": 3,
      "text": "o Recorded OPCODES [opcodes] and RR TYPEs [rrtypes]. See Section 6.2.2.",
      "zh-CHS": "o 记录的操作码[操作码]和RR类型[rrtypes]。见第6.2.2节。"
    },
    {
      "indent": 3,
      "text": "o Flags indicating, for example, whether the data is sampled or anonymized. See Sections 6.2.3 and 14.",
      "zh-CHS": "o 例如，指示数据是采样还是匿名的标志。见第6.2.3和14节。"
    },
    {
      "indent": 3,
      "text": "o Client and server IPv4 and IPv6 address prefixes. See Section 6.2.4.",
      "zh-CHS": "o 客户端和服务器IPv4和IPv6地址前缀。见第6.2.4节。"
    },
    {
      "indent": 0,
      "text": "6.2.1. Optional Data Items",
      "section_title": true,
      "zh-CHS": "6.2.1. 可选数据项"
    },
    {
      "indent": 3,
      "text": "To enable implementations to store data to their precise requirements in as space-efficient a manner as possible, all fields in the following arrays are optional:",
      "zh-CHS": "为了使实现能够以尽可能节省空间的方式存储符合其精确要求的数据，以下阵列中的所有字段都是可选的："
    },
    {
      "indent": 3,
      "text": "o Query/Response",
      "zh-CHS": "o 查询/答复"
    },
    {
      "indent": 3,
      "text": "o Query Signature",
      "zh-CHS": "o 查询签名"
    },
    {
      "indent": 3,
      "text": "o Malformed Messages",
      "zh-CHS": "o 格式错误的消息"
    },
    {
      "indent": 3,
      "text": "In other words, an implementation can choose to omit any data item that is not required for its use case (whilst observing the restrictions relating to IP address storage described in Section 6.2.4). In addition, implementations may be configured to not record all RRs or to only record messages with certain OPCODES.",
      "zh-CHS": "换句话说，实现可以选择省略其用例不需要的任何数据项（同时遵守第6.2.4节中描述的与IP地址存储相关的限制）。此外，可以将实现配置为不记录所有rr或仅记录具有特定操作码的消息。"
    },
    {
      "indent": 3,
      "text": "This does, however, mean that a consumer of a C-DNS file faces two problems:",
      "zh-CHS": "然而，这确实意味着C-DNS文件的使用者面临两个问题："
    },
    {
      "indent": 3,
      "text": "1. How can it quickly determine if a file definitely does not contain the data items it requires to complete a particular task (e.g., reconstructing DNS traffic or performing a specific piece of data analysis)?",
      "zh-CHS": "1. 它如何快速确定文件是否确实不包含完成特定任务所需的数据项（例如，重建DNS流量或执行特定的数据分析）？"
    },
    {
      "indent": 3,
      "text": "2. How can it determine whether a data item is not present because it was (1) explicitly not recorded or (2) not available/present?",
      "zh-CHS": "2. 它如何确定某个数据项是否不存在，因为它（1）明确未记录或（2）不可用/存在？"
    },
    {
      "indent": 3,
      "text": "For example, capturing C-DNS data from within a name server implementation makes it unlikely that the Client Hoplimit can be recorded. Or, if there is no Query ARCOUNT recorded and no Query OPT RDATA [RFC6891] recorded, is that because no Query contained an OPT RR, or because that data was not stored?",
      "zh-CHS": "例如，从名称服务器实现中捕获C-DNS数据使得不太可能记录客户端跃点限制。或者，如果没有记录查询ARCOUNT，也没有记录查询OPT RDATA[RFC6891]，是因为没有查询包含OPT RR，还是因为没有存储该数据？"
    },
    {
      "indent": 3,
      "text": "The Storage Parameters item therefore also contains a Storage Hints item, which specifies which items the encoder of the file omits from the stored data and will therefore never be present. (This approach is taken because a flag that indicated which items were included for",
      "zh-CHS": "因此，存储参数项还包含一个存储提示项，该项指定文件的编码器从存储的数据中忽略了哪些项，因此这些项永远不会出现。（之所以采用这种方法，是因为有一个标志指示哪些项目包括在"
    },
    {
      "indent": 3,
      "text": "collection would not guarantee that the item was present -- only that it might be.) An implementation decoding that file can then use these flags to quickly determine whether the input data is not rich enough for its needs.",
      "zh-CHS": "集合不能保证该项存在——只能保证它可能存在。）解码该文件的实现然后可以使用这些标志快速确定输入数据是否不够丰富，无法满足其需要。"
    },
    {
      "indent": 3,
      "text": "One scenario where this may be particularly important is the case of regenerating traffic. It is possible to collect such a small set of data items that an implementation decoding the file cannot determine if a given Query/Response data item was generated from just a Query, just a Response, or a Query/Response pair. This makes it impossible to reconstruct DNS traffic even if sensible defaults are provided for the missing data items. This is discussed in more detail in Section 9.",
      "zh-CHS": "这可能特别重要的一个场景是重新生成流量的情况。可以收集如此小的数据项集，以至于解码文件的实现无法确定给定的查询/响应数据项是仅从查询、响应还是查询/响应对生成的。这使得即使为丢失的数据项提供了合理的默认值，也无法重建DNS流量。第9节对此进行了更详细的讨论。"
    },
    {
      "indent": 0,
      "text": "6.2.2. Optional RRs and OPCODEs",
      "section_title": true,
      "zh-CHS": "6.2.2. 可选RRs和操作码"
    },
    {
      "indent": 3,
      "text": "Also included in the Storage Parameters item are explicit arrays listing the RR TYPEs and the OPCODEs to be recorded. These arrays remove any ambiguity over whether, for example, messages containing particular OPCODEs are not present because (1) certain OPCODEs did not occur or (2) the implementation is not configured to record them.",
      "zh-CHS": "存储参数项中还包括显式数组，其中列出了要记录的RR类型和操作码。例如，由于（1）某些操作码未出现或（2）实现未配置为记录它们，这些数组消除了关于是否不存在包含特定操作码的消息的任何歧义。"
    },
    {
      "indent": 3,
      "text": "In the case of OPCODEs, for a message to be fully parsable, the OPCODE must be known to the collecting implementation. Any message with an OPCODE unknown to the collecting implementation cannot be validated as correctly formed and so must be treated as malformed. Messages with OPCODES known to the recording application but not listed in the Storage Parameters item are discarded by the recording application during C-DNS capture (regardless of whether they are malformed or not).",
      "zh-CHS": "对于操作码，要使消息完全可解析，收集实现必须知道操作码。任何带有收集实现未知操作码的消息都无法验证为格式正确，因此必须视为格式错误。在C-DNS捕获期间，记录应用程序将丢弃操作码为记录应用程序已知但未在存储参数项中列出的消息（无论其格式是否错误）。"
    },
    {
      "indent": 3,
      "text": "In the case of RRs, each record in a message must be fully parsable, including parsing the record RDATA, as otherwise the message cannot be validated as correctly formed. Any RR with an RR TYPE not known to the collecting implementation cannot be validated as correctly formed and so must be treated as malformed.",
      "zh-CHS": "对于RRs，消息中的每个记录都必须是完全可解析的，包括解析记录RDATA，否则无法验证消息的格式是否正确。收集实现不知道RR类型的任何RR都无法验证为正确格式，因此必须视为格式不正确。"
    },
    {
      "indent": 3,
      "text": "Once a message is correctly parsed, an implementation is free to record only a subset of the RRs present.",
      "zh-CHS": "一旦消息被正确解析，实现就可以自由地只记录当前RRs的一个子集。"
    },
    {
      "indent": 0,
      "text": "6.2.3. Storage Flags",
      "section_title": true,
      "zh-CHS": "6.2.3. 存储标志"
    },
    {
      "indent": 3,
      "text": "The Storage Parameters item contains flags that can be used to indicate if:",
      "zh-CHS": "存储参数项包含可用于指示以下情况的标志："
    },
    {
      "indent": 3,
      "text": "o the data is anonymized,",
      "zh-CHS": "o 数据是匿名的，"
    },
    {
      "indent": 3,
      "text": "o the data is produced from sample data, or",
      "zh-CHS": "o 数据由样本数据生成，或"
    },
    {
      "indent": 3,
      "text": "o names in the data have been normalized (converted to uniform case).",
      "zh-CHS": "o 数据中的名称已规范化（转换为统一大小写）。"
    },
    {
      "indent": 3,
      "text": "The Storage Parameters item also contains optional fields holding details of the sampling method used and the anonymization method used. It is RECOMMENDED that these fields contain URIs [RFC3986] pointing to resources describing the methods used. See Section 14 for further discussion of anonymization and normalization.",
      "zh-CHS": "存储参数项还包含可选字段，其中包含所用采样方法和匿名方法的详细信息。建议这些字段包含指向描述所用方法的资源的URI[RFC3986]。有关匿名化和规范化的进一步讨论，请参见第14节。"
    },
    {
      "indent": 0,
      "text": "6.2.4. IP Address Storage",
      "section_title": true,
      "zh-CHS": "6.2.4. IP地址存储器"
    },
    {
      "indent": 3,
      "text": "The format can store either full IP addresses or just IP prefixes; the Storage Parameters item contains fields to indicate if only IP prefixes were stored.",
      "zh-CHS": "该格式可以存储完整的IP地址，也可以只存储IP前缀；存储参数项包含用于指示是否仅存储IP前缀的字段。"
    },
    {
      "indent": 3,
      "text": "If the IP address prefixes are absent, then full addresses are stored. In this case, the IP version can be directly inferred from the stored address length and the fields \"qr-transport-flags\" in QueryResponseSignature, \"ae-transport-flags\" in AddressEventCount, and \"mm-transport-flags\" in MalformedMessageData (which contain the IP version bit) are optional.",
      "zh-CHS": "如果没有IP地址前缀，则存储完整地址。在这种情况下，可以从存储的地址长度直接推断IP版本，QueryResponseSignature中的字段“qr transport flags”、“AddressEventCount中的ae transport flags”和MalformedMessageData中的字段“mm transport flags”（包含IP版本位）是可选的。"
    },
    {
      "indent": 3,
      "text": "If IP address prefixes are given, only the prefix bits of addresses are stored. In this case, in order to determine the IP version, the fields \"qr-transport-flags\" in QueryResponseSignature, \"ae-transport-flags\" in AddressEventCount, and \"mm-transport-flags\" in MalformedMessageData MUST be present. See Sections 7.3.2.3.2 and 7.3.2.3.5.",
      "zh-CHS": "如果给定IP地址前缀，则只存储地址的前缀位。在这种情况下，为了确定IP版本，QueryResponseSignature中的字段“qr传输标志”、AddressEventCount中的“ae传输标志”和MalformedMessageData中的“mm传输标志”必须存在。见第7.3.2.3.2节和第7.3.2.3.5节。"
    },
    {
      "indent": 3,
      "text": "As an example of storing only IP prefixes, if a client IPv6 prefix of 48 is specified, a client address of 2001:db8:85a3::8a2e:370:7334 will be stored as 0x20010db885a3, reducing address storage space requirements. Similarly, if a client IPv4 prefix of 16 is specified, a client address of 192.0.2.1 will be stored as 0xc000 (192.0).",
      "zh-CHS": "作为仅存储IP前缀的示例，如果指定了客户端IPv6前缀48，则2001:db8:85a3:：8a2e:370:7334的客户端地址将存储为0x20010db885a3，从而减少地址存储空间需求。类似地，如果指定了客户端IPv4前缀16，则192.0.2.1的客户端地址将存储为0xc000（192.0）。"
    },
    {
      "indent": 0,
      "text": "7. C-DNS Format Detailed Description",
      "section_title": true,
      "zh-CHS": "7. C-DNS格式详细说明"
    },
    {
      "indent": 3,
      "text": "The CDDL definition for the C-DNS format is given in Appendix A.",
      "zh-CHS": "附录A中给出了C-DNS格式的CDDL定义。"
    },
    {
      "indent": 0,
      "text": "7.1. Map Quantities and Indexes",
      "section_title": true,
      "zh-CHS": "7.1. 地图数量和索引"
    },
    {
      "indent": 3,
      "text": "All map keys are integers with values specified in the CDDL. String keys would significantly bloat the file size.",
      "zh-CHS": "所有映射键都是CDDL中指定值的整数。字符串键会显著增大文件大小。"
    },
    {
      "indent": 3,
      "text": "All key values specified are positive integers under 24, so their CBOR representation is a single byte. Positive integer values not currently used as keys in a map are reserved for use in future standard extensions.",
      "zh-CHS": "所有指定的键值都是24以下的正整数，因此它们的CBOR表示为单字节。当前未在映射中用作键的正整数值保留在将来的标准扩展中使用。"
    },
    {
      "indent": 3,
      "text": "Implementations may choose to add additional implementation-specific entries to any map. Negative integer map keys are reserved for these values. Key values from -1 to -24 also have a single-byte CBOR representation, so such implementation-specific extensions are not at any space efficiency disadvantage.",
      "zh-CHS": "实现可以选择向任何映射添加其他特定于实现的条目。为这些值保留负整数映射键。从-1到-24的键值也有一个单字节CBOR表示，因此这种特定于实现的扩展不存在任何空间效率的缺点。"
    },
    {
      "indent": 3,
      "text": "An item described as an index is the index of the data item in the referenced array. Indexes are 0-based.",
      "zh-CHS": "描述为索引的项是引用数组中数据项的索引。索引是基于0的。"
    },
    {
      "indent": 0,
      "text": "7.2. Tabular Representation",
      "section_title": true,
      "zh-CHS": "7.2. 表格表示法"
    },
    {
      "indent": 3,
      "text": "The following sections present the C-DNS specification in tabular format with a detailed description of each item.",
      "zh-CHS": "以下各节以表格形式呈现了C-DNS规范，并对每个项目进行了详细说明。"
    },
    {
      "indent": 3,
      "text": "In all quantities that contain bit flags, bit 0 indicates the least significant bit, i.e., flag \"n\" in quantity \"q\" is on if \"(q & (1 << n)) != 0\".",
      "zh-CHS": "在包含位标志的所有量中，位0表示最低有效位，即，如果（q&（1<<n））！=0，则数量“q”中的标志“n”处于打开状态。"
    },
    {
      "indent": 3,
      "text": "For the sake of readability, all type and field names defined in the CDDL definition are shown in double quotes. Type names are by convention camel case (e.g., \"BlockTables\"), and field names are lowercase with hyphens (e.g., \"block-tables\").",
      "zh-CHS": "为了可读性，CDDL定义中定义的所有类型和字段名都用双引号表示。按照惯例，类型名是大小写（例如“块表”），字段名是小写加连字符（例如“块表”）。"
    },
    {
      "indent": 3,
      "text": "For the sake of brevity, the following conventions are used in the tables:",
      "zh-CHS": "为简洁起见，表中使用了以下约定："
    },
    {
      "indent": 3,
      "text": "o The column M marks whether items in a map are mandatory.",
      "zh-CHS": "o M列标记地图中的项目是否为必填项。"
    },
    {
      "indent": 6,
      "text": "* X - Mandatory items.",
      "zh-CHS": "* X-强制性项目。"
    },
    {
      "indent": 6,
      "text": "* C - Conditionally mandatory items. Such items are usually optional but may be mandatory in some configurations.",
      "zh-CHS": "* C-有条件的强制性项目。这些项目通常是可选的，但在某些配置中可能是强制性的。"
    },
    {
      "indent": 6,
      "text": "* If the column is empty, the item is optional.",
      "zh-CHS": "* 如果列为空，则该项为可选项。"
    },
    {
      "indent": 3,
      "text": "o The column T gives the CBOR datatype of the item.",
      "zh-CHS": "o 列T给出了该项的CBOR数据类型。"
    },
    {
      "indent": 6,
      "text": "* U - Unsigned integer.",
      "zh-CHS": "* U-无符号整数。"
    },
    {
      "indent": 6,
      "text": "* I - Signed integer (i.e., either a CBOR unsigned integer or a CBOR negative integer).",
      "zh-CHS": "* I-有符号整数（即，CBOR无符号整数或CBOR负整数）。"
    },
    {
      "indent": 6,
      "text": "* B - Boolean.",
      "zh-CHS": "* B-布尔型。"
    },
    {
      "indent": 6,
      "text": "* S - Byte string.",
      "zh-CHS": "* S字节字符串。"
    },
    {
      "indent": 6,
      "text": "* T - Text string.",
      "zh-CHS": "* T-文本字符串。"
    },
    {
      "indent": 6,
      "text": "* M - Map.",
      "zh-CHS": "* M-地图。"
    },
    {
      "indent": 6,
      "text": "* A - Array.",
      "zh-CHS": "* A-数组。"
    },
    {
      "indent": 3,
      "text": "In the case of maps and arrays, more information on the type of each value, including the CDDL definition name if applicable, is given in the description.",
      "zh-CHS": "对于映射和数组，描述中给出了关于每个值类型的更多信息，包括CDDL定义名称（如果适用）。"
    },
    {
      "indent": 0,
      "text": "7.3. \"File\"",
      "section_title": true,
      "zh-CHS": "7.3. “文件”"
    },
    {
      "indent": 3,
      "text": "A C-DNS file has an outer structure \"File\", an array that contains the following:",
      "zh-CHS": "C-DNS文件具有外部结构“文件”，即包含以下内容的数组："
    },
    {
      "indent": 3,
      "text": "+---------------+---+---+-------------------------------------------+\n| Field         | M | T | Description                               |\n+---------------+---+---+-------------------------------------------+\n| file-type-id  | X | T | String \"C-DNS\" identifying the file type. |\n|               |   |   |                                           |\n| file-preamble | X | M | Version and parameter information for the |\n|               |   |   | whole file.  Map of type \"FilePreamble\";  |\n|               |   |   | see Section 7.3.1.                        |\n|               |   |   |                                           |\n| file-blocks   | X | A | Array of items of type \"Block\"; see       |\n|               |   |   | Section 7.3.2.  The array may be empty if |\n|               |   |   | the file contains no data.                |\n+---------------+---+---+-------------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.1. \"FilePreamble\"",
      "section_title": true,
      "zh-CHS": "7.3.1. “文件序言”"
    },
    {
      "indent": 3,
      "text": "Information about data in the file. A map containing the following:",
      "zh-CHS": "有关文件中数据的信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+----------------------+---+---+------------------------------------+\n| Field                | M | T | Description                        |\n+----------------------+---+---+------------------------------------+\n| major-format-version | X | U | Unsigned integer \"1\".  The major   |\n|                      |   |   | version of the format used in the  |\n|                      |   |   | file.  See Section 8.              |\n|                      |   |   |                                    |\n| minor-format-version | X | U | Unsigned integer \"0\".  The minor   |\n|                      |   |   | version of the format used in the  |\n|                      |   |   | file.  See Section 8.              |\n|                      |   |   |                                    |\n| private-version      |   | U | Version indicator available for    |\n|                      |   |   | private use by implementations.    |\n|                      |   |   |                                    |\n| block-parameters     | X | A | Array of items of type             |\n|                      |   |   | \"BlockParameters\".  See Section    |\n|                      |   |   | 7.3.1.1.  The array must contain   |\n|                      |   |   | at least one entry.  (The          |\n|                      |   |   | \"block-parameters-index\" item in   |\n|                      |   |   | each \"BlockPreamble\" indicates     |\n|                      |   |   | which array entry applies to that  |\n|                      |   |   | \"Block\".)                          |\n+----------------------+---+---+------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.1.1. \"BlockParameters\"",
      "section_title": true,
      "zh-CHS": "7.3.1.1. “块参数”"
    },
    {
      "indent": 3,
      "text": "Parameters relating to data storage and collection that apply to one or more items of type \"Block\". A map containing the following:",
      "zh-CHS": "适用于一个或多个“块”类型项的与数据存储和收集相关的参数。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+-----------------------+---+---+-----------------------------------+\n| Field                 | M | T | Description                       |\n+-----------------------+---+---+-----------------------------------+\n| storage-parameters    | X | M | Parameters relating to data       |\n|                       |   |   | storage in a \"Block\" item.  Map   |\n|                       |   |   | of type \"StorageParameters\"; see  |\n|                       |   |   | Section 7.3.1.1.1.                |\n|                       |   |   |                                   |\n| collection-parameters |   | M | Parameters relating to collection |\n|                       |   |   | of the data in a \"Block\" item.    |\n|                       |   |   | Map of type                       |\n|                       |   |   | \"CollectionParameters\"; see       |\n|                       |   |   | Section 7.3.1.1.2.                |\n+-----------------------+---+---+-----------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.1.1.1. \"StorageParameters\"",
      "section_title": true,
      "zh-CHS": "7.3.1.1.1. “存储参数”"
    },
    {
      "indent": 3,
      "text": "Parameters relating to how data is stored in the items of type \"Block\". A map containing the following:",
      "zh-CHS": "与数据如何存储在“块”类型项中有关的参数。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| ticks-per-second | X | U | Sub-second timing is recorded in       |\n|                  |   |   | ticks.  This specifies the number of   |\n|                  |   |   | ticks in a second.                     |\n|                  |   |   |                                        |\n| max-block-items  | X | U | The maximum number of items stored in  |\n|                  |   |   | any of the arrays in a \"Block\" item    |\n|                  |   |   | (Q/R, Address/Event Count, or          |\n|                  |   |   | Malformed Message data items).  An     |\n|                  |   |   | indication to a decoder of the         |\n|                  |   |   | resources needed to process the file.  |\n|                  |   |   |                                        |\n| storage-hints    | X | M | Collection of hints as to which fields |\n|                  |   |   | are omitted in the arrays that have    |\n|                  |   |   | optional fields.  Map of type          |\n|                  |   |   | \"StorageHints\".  See Section           |\n|                  |   |   | 7.3.1.1.1.1.                           |\n|                  |   |   |                                        |\n| opcodes          | X | A | Array of OPCODES [opcodes] (unsigned   |\n|                  |   |   | integers, each in the range 0 to 15    |\n|                  |   |   | inclusive) recorded by the collecting  |\n|                  |   |   | implementation.  See Section 6.2.2.    |\n|                  |   |   |                                        |\n| rr-types         | X | A | Array of RR TYPEs [rrtypes] (unsigned  |\n|                  |   |   | integers, each in the range 0 to 65535 |\n|                  |   |   | inclusive) recorded by the collecting  |\n|                  |   |   | implementation.  See Section 6.2.2.    |\n|                  |   |   |                                        |\n| storage-flags    |   | U | Bit flags indicating attributes of     |\n|                  |   |   | stored data.                           |\n|                  |   |   | Bit 0.  1 if the data has been         |\n|                  |   |   | anonymized.                            |\n|                  |   |   | Bit 1.  1 if the data is sampled data. |\n|                  |   |   | Bit 2.  1 if the names have been       |\n|                  |   |   | normalized (converted to uniform       |\n|                  |   |   | case).                                 |\n|                  |   |   |                                        |\n| client-address   |   | U | IPv4 client address prefix length, in  |\n| -prefix-ipv4     |   |   | the range 1 to 32 inclusive.  If       |\n|                  |   |   | specified, only the address prefix     |\n|                  |   |   | bits are stored.                       |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "|                  |   |   |                                        |\n| client-address   |   | U | IPv6 client address prefix length, in  |\n| -prefix-ipv6     |   |   | the range 1 to 128 inclusive.  If      |\n|                  |   |   | specified, only the address prefix     |\n|                  |   |   | bits are stored.                       |\n|                  |   |   |                                        |\n| server-address   |   | U | IPv4 server address prefix length, in  |\n| -prefix-ipv4     |   |   | the range 1 to 32 inclusive.  If       |\n|                  |   |   | specified, only the address prefix     |\n|                  |   |   | bits are stored.                       |\n|                  |   |   |                                        |\n| server-address   |   | U | IPv6 server address prefix length, in  |\n| -prefix-ipv6     |   |   | the range 1 to 128 inclusive.  If      |\n|                  |   |   | specified, only the address prefix     |\n|                  |   |   | bits are stored.                       |\n|                  |   |   |                                        |\n| sampling-method  |   | T | Information on the sampling method     |\n|                  |   |   | used.  See Section 6.2.3.              |\n|                  |   |   |                                        |\n| anonymization    |   | T | Information on the anonymization       |\n| -method          |   |   | method used.  See Section 6.2.3.       |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.1.1.1.1. \"StorageHints\"",
      "section_title": true,
      "zh-CHS": "7.3.1.1.1.1. “存储提示”"
    },
    {
      "indent": 3,
      "text": "An indicator of which fields the collecting implementation omits in the maps with optional fields. Note that hints have a top-down precedence. In other words, where a map contains another map, the hint on the containing map overrides any hints in the contained map and the contained map is omitted. A map containing the following:",
      "zh-CHS": "在带有可选字段的映射中，收集实现忽略哪些字段的指示符。请注意，提示具有自上而下的优先级。换句话说，当一个映射包含另一个映射时，包含映射上的提示将覆盖包含映射中的任何提示，并且忽略包含映射。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| query-response   | X | U | Hints indicating which \"QueryResponse\" |\n| -hints           |   |   | fields are omitted; see Section        |\n|                  |   |   | 7.3.2.4.  If a bit is unset, the field |\n|                  |   |   | is omitted from the capture.           |\n|                  |   |   | Bit 0.  time-offset                    |\n|                  |   |   | Bit 1.  client-address-index           |\n|                  |   |   | Bit 2.  client-port                    |\n|                  |   |   | Bit 3.  transaction-id                 |\n|                  |   |   | Bit 4.  qr-signature-index             |\n|                  |   |   | Bit 5.  client-hoplimit                |\n|                  |   |   | Bit 6.  response-delay                 |\n|                  |   |   | Bit 7.  query-name-index               |\n|                  |   |   | Bit 8.  query-size                     |\n|                  |   |   | Bit 9.  response-size                  |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "|                  |   |   | Bit 10.  response-processing-data      |\n|                  |   |   | Bit 11.  query-question-sections       |\n|                  |   |   | Bit 12.  query-answer-sections         |\n|                  |   |   | Bit 13.  query-authority-sections      |\n|                  |   |   | Bit 14.  query-additional-sections     |\n|                  |   |   | Bit 15.  response-answer-sections      |\n|                  |   |   | Bit 16.  response-authority-sections   |\n|                  |   |   | Bit 17.  response-additional-sections  |\n|                  |   |   |                                        |\n| query-response   | X | U | Hints indicating which                 |\n| -signature-hints |   |   | \"QueryResponseSignature\" fields are    |\n|                  |   |   | omitted; see Section 7.3.2.3.2.  If a  |\n|                  |   |   | bit is unset, the field is omitted     |\n|                  |   |   | from the capture.                      |\n|                  |   |   | Bit 0.  server-address-index           |\n|                  |   |   | Bit 1.  server-port                    |\n|                  |   |   | Bit 2.  qr-transport-flags             |\n|                  |   |   | Bit 3.  qr-type                        |\n|                  |   |   | Bit 4.  qr-sig-flags                   |\n|                  |   |   | Bit 5.  query-opcode                   |\n|                  |   |   | Bit 6.  qr-dns-flags                   |\n|                  |   |   | Bit 7.  query-rcode                    |\n|                  |   |   | Bit 8.  query-classtype-index          |\n|                  |   |   | Bit 9.  query-qdcount                  |\n|                  |   |   | Bit 10.  query-ancount                 |\n|                  |   |   | Bit 11.  query-nscount                 |\n|                  |   |   | Bit 12.  query-arcount                 |\n|                  |   |   | Bit 13.  query-edns-version            |\n|                  |   |   | Bit 14.  query-udp-size                |\n|                  |   |   | Bit 15.  query-opt-rdata-index         |\n|                  |   |   | Bit 16.  response-rcode                |\n|                  |   |   |                                        |\n| rr-hints         | X | U | Hints indicating which optional \"RR\"   |\n|                  |   |   | fields are omitted; see Section        |\n|                  |   |   | 7.3.2.3.4.  If a bit is unset, the     |\n|                  |   |   | field is omitted from the capture.     |\n|                  |   |   | Bit 0.  ttl                            |\n|                  |   |   | Bit 1.  rdata-index                    |\n| other-data-hints | X | U | Hints indicating which other datatypes |\n|                  |   |   | are omitted.  If a bit is unset, the   |\n|                  |   |   | datatype is omitted from the capture.  |\n|                  |   |   | Bit 0.  malformed-messages             |\n|                  |   |   | Bit 1.  address-event-counts           |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.1.1.2. \"CollectionParameters\"",
      "section_title": true,
      "zh-CHS": "7.3.1.1.2. “收集参数”"
    },
    {
      "indent": 3,
      "text": "Parameters providing information regarding how data in the file was collected (applicable for some, but not all, collection environments). The values are informational only and serve as metadata to downstream analyzers as to the configuration of a collecting implementation. They can provide context when interpreting what data is present/absent from the capture but cannot necessarily be validated against the data captured.",
      "zh-CHS": "提供有关如何收集文件中数据的信息的参数（适用于某些收集环境，但不适用于所有收集环境）。这些值仅供参考，并作为下游分析器关于收集实现配置的元数据。它们可以在解释捕获中存在/不存在的数据时提供上下文，但不一定能够根据捕获的数据进行验证。"
    },
    {
      "indent": 3,
      "text": "These parameters have no default. If they do not appear, nothing can be inferred about their value.",
      "zh-CHS": "这些参数没有默认值。如果它们不出现，则无法推断其值。"
    },
    {
      "indent": 3,
      "text": "A map containing the following items:",
      "zh-CHS": "包含以下项目的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| query-timeout    |   | U | To be matched with a Query, a Response |\n|                  |   |   | must arrive within this number of      |\n|                  |   |   | milliseconds.                          |\n|                  |   |   |                                        |\n| skew-timeout     |   | U | The network stack may report a         |\n|                  |   |   | Response before the corresponding      |\n|                  |   |   | Query.  A Response is not considered   |\n|                  |   |   | to be missing a Query until after this |\n|                  |   |   | many microseconds.                     |\n|                  |   |   |                                        |\n| snaplen          |   | U | Collect up to this many bytes per      |\n|                  |   |   | packet.                                |\n|                  |   |   |                                        |\n| promisc          |   | B | \"true\" if promiscuous mode             |\n|                  |   |   | [pcap-options] was enabled on the      |\n|                  |   |   | interface, \"false\" otherwise.          |\n|                  |   |   |                                        |\n| interfaces       |   | A | Array of identifiers (of type text     |\n|                  |   |   | string) of the interfaces used for     |\n|                  |   |   | collection.                            |\n|                  |   |   |                                        |\n| server-addresses |   | A | Array of server collection IP          |\n|                  |   |   | addresses (of type byte string).       |\n|                  |   |   | Metadata for downstream analyzers;     |\n|                  |   |   | does not affect collection.            |\n|                  |   |   |                                        |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| vlan-ids         |   | A | Array of identifiers (of type unsigned |\n|                  |   |   | integer, each in the range 1 to 4094   |\n|                  |   |   | inclusive) of VLANs [IEEE802.1Q]       |\n|                  |   |   | selected for collection.  VLAN IDs are |\n|                  |   |   | unique only within an administrative   |\n|                  |   |   | domain.                                |\n|                  |   |   |                                        |\n| filter           |   | T | Filter for input, in \"tcpdump\"         |\n|                  |   |   | [pcap-filter] style.                   |\n|                  |   |   |                                        |\n| generator-id     |   | T | Implementation-specific human-readable |\n|                  |   |   | string identifying the collection      |\n|                  |   |   | method.                                |\n|                  |   |   |                                        |\n| host-id          |   | T | String identifying the collecting      |\n|                  |   |   | host.                                  |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2. \"Block\"",
      "section_title": true,
      "zh-CHS": "7.3.2. “块”"
    },
    {
      "indent": 3,
      "text": "Container for data with common collection and storage parameters. A map containing the following:",
      "zh-CHS": "具有公共收集和存储参数的数据容器。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+--------------------+---+---+--------------------------------------+\n| Field              | M | T | Description                          |\n+--------------------+---+---+--------------------------------------+\n| block-preamble     | X | M | Overall information for the \"Block\"  |\n|                    |   |   | item.  Map of type \"BlockPreamble\";  |\n|                    |   |   | see Section 7.3.2.1.                 |\n|                    |   |   |                                      |\n| block-statistics   |   | M | Statistics about the \"Block\" item.   |\n|                    |   |   | Map of type \"BlockStatistics\"; see   |\n|                    |   |   | Section 7.3.2.2.                     |\n|                    |   |   |                                      |\n| block-tables       |   | M | The arrays containing data           |\n|                    |   |   | referenced by individual             |\n|                    |   |   | \"QueryResponse\" or                   |\n|                    |   |   | \"MalformedMessage\" items.  Map of    |\n|                    |   |   | type \"BlockTables\"; see Section      |\n|                    |   |   | 7.3.2.3.                             |\n|                    |   |   |                                      |\n| query-responses    |   | A | Details of individual C-DNS Q/R data |\n|                    |   |   | items.  Array of items of type       |\n|                    |   |   | \"QueryResponse\"; see Section         |\n|                    |   |   | 7.3.2.4.  If present, the array must |\n|                    |   |   | not be empty.                        |\n|                    |   |   |                                      |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| address-event      |   | A | Per-client counts of ICMP messages   |\n| -counts            |   |   | and TCP resets.  Array of items of   |\n|                    |   |   | type \"AddressEventCount\"; see        |\n|                    |   |   | Section 7.3.2.5.  If present, the    |\n|                    |   |   | array must not be empty.             |\n|                    |   |   |                                      |\n| malformed-messages |   | A | Details of malformed DNS messages.   |\n|                    |   |   | Array of items of type               |\n|                    |   |   | \"MalformedMessage\"; see Section      |\n|                    |   |   | 7.3.2.6.  If present, the array must |\n|                    |   |   | not be empty.                        |\n+--------------------+---+---+--------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.1. \"BlockPreamble\"",
      "section_title": true,
      "zh-CHS": "7.3.2.1. “区块序言”"
    },
    {
      "indent": 3,
      "text": "Overall information for a \"Block\" item. A map containing the following:",
      "zh-CHS": "“块”项目的总体信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| earliest-time    | C | A | A timestamp (two unsigned integers, of |\n|                  |   |   | type \"Timestamp\") for the earliest     |\n|                  |   |   | record in the \"Block\" item.  The first |\n|                  |   |   | integer is the number of seconds since |\n|                  |   |   | the POSIX epoch [posix-time]           |\n|                  |   |   | (\"time_t\"), excluding leap seconds.    |\n|                  |   |   | The second integer is the number of    |\n|                  |   |   | ticks (see Section 7.3.1.1.1) since    |\n|                  |   |   | the start of the second.  This field   |\n|                  |   |   | is mandatory unless all block items    |\n|                  |   |   | containing a time offset from the      |\n|                  |   |   | start of the Block also omit that time |\n|                  |   |   | offset.                                |\n|                  |   |   |                                        |\n| block-parameters |   | U | The index of the item in the           |\n| -index           |   |   | \"block-parameters\" array (in the       |\n|                  |   |   | \"file-preamble\" item) applicable to    |\n|                  |   |   | this block.  If not present, index 0   |\n|                  |   |   | is used.  See Section 7.3.1.           |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.2. \"BlockStatistics\"",
      "section_title": true,
      "zh-CHS": "7.3.2.2. “区块统计”"
    },
    {
      "indent": 3,
      "text": "Basic statistical information about a \"Block\" item. A map containing the following:",
      "zh-CHS": "“块”项目的基本统计信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+---------------------+---+---+-------------------------------------+\n| Field               | M | T | Description                         |\n+---------------------+---+---+-------------------------------------+\n| processed-messages  |   | U | Total number of well-formed DNS     |\n|                     |   |   | messages processed from the input   |\n|                     |   |   | traffic stream during collection of |\n|                     |   |   | data in this \"Block\" item.          |\n|                     |   |   |                                     |\n| qr-data-items       |   | U | Total number of Q/R data items in   |\n|                     |   |   | this \"Block\" item.                  |\n|                     |   |   |                                     |\n| unmatched-queries   |   | U | Number of unmatched Queries in this |\n|                     |   |   | \"Block\" item.                       |\n|                     |   |   |                                     |\n| unmatched-responses |   | U | Number of unmatched Responses in    |\n|                     |   |   | this \"Block\" item.                  |\n|                     |   |   |                                     |\n| discarded-opcode    |   | U | Number of DNS messages processed    |\n|                     |   |   | from the input traffic stream       |\n|                     |   |   | during collection of data in this   |\n|                     |   |   | \"Block\" item but not recorded       |\n|                     |   |   | because their OPCODE is not in the  |\n|                     |   |   | list to be collected.               |\n|                     |   |   |                                     |\n| malformed-items     |   | U | Number of malformed messages        |\n|                     |   |   | processed from the input traffic    |\n|                     |   |   | stream during collection of data in |\n|                     |   |   | this \"Block\" item.                  |\n+---------------------+---+---+-------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.3. \"BlockTables\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3. “区块表”"
    },
    {
      "indent": 3,
      "text": "Map of arrays containing data referenced by individual \"QueryResponse\" or \"MalformedMessage\" items in this \"Block\". Each element is an array that, if present, must not be empty.",
      "zh-CHS": "包含此“块”中单个“QueryResponse”或“MalformedMessage”项引用的数据的数组的映射。每个元素都是一个数组，如果存在，则该数组不能为空。"
    },
    {
      "indent": 3,
      "text": "An item in the \"qlist\" array contains indexes to values in the \"qrr\" array. Therefore, if \"qlist\" is present, \"qrr\" must also be present. Similarly, if \"rrlist\" is present, \"rr\" must also be present.",
      "zh-CHS": "“qlist”数组中的项包含指向“qrr”数组中的值的索引。因此，如果“qlist”存在，“qrr”也必须存在。同样，如果“rrlist”存在，“rr”也必须存在。"
    },
    {
      "indent": 3,
      "text": "The map contains the following items:",
      "zh-CHS": "地图包含以下项目："
    },
    {
      "indent": 3,
      "text": "+-------------------+---+---+---------------------------------------+\n| Field             | M | T | Description                           |\n+-------------------+---+---+---------------------------------------+\n| ip-address        |   | A | Array of IP addresses, in network     |\n|                   |   |   | byte order (of type byte string).  If |\n|                   |   |   | client or server address prefixes are |\n|                   |   |   | set, only the address prefix bits are |\n|                   |   |   | stored.  Each string is therefore up  |\n|                   |   |   | to 4 bytes long for an IPv4 address,  |\n|                   |   |   | or up to 16 bytes long for an IPv6    |\n|                   |   |   | address.  See Section 7.3.1.1.1.      |\n|                   |   |   |                                       |\n| classtype         |   | A | Array of RR CLASS and TYPE            |\n|                   |   |   | information.  Type is \"ClassType\".    |\n|                   |   |   | See Section 7.3.2.3.1.                |\n|                   |   |   |                                       |\n| name-rdata        |   | A | Array where each entry is the         |\n|                   |   |   | contents of a single NAME or RDATA in |\n|                   |   |   | wire format (of type byte string).    |\n|                   |   |   | Note that NAMEs, and labels within    |\n|                   |   |   | RDATA contents, are full domain names |\n|                   |   |   | or labels; no name compression (per   |\n|                   |   |   | [RFC1035]) is used on the individual  |\n|                   |   |   | names/labels within the format.       |\n|                   |   |   |                                       |\n| qr-sig            |   | A | Array of Q/R data item signatures.    |\n|                   |   |   | Type is \"QueryResponseSignature\".     |\n|                   |   |   | See Section 7.3.2.3.2.                |\n|                   |   |   |                                       |\n| qlist             |   | A | Array of type \"QuestionList\".  A      |\n|                   |   |   | \"QuestionList\" is an array of         |\n|                   |   |   | unsigned integers, indexes to         |\n|                   |   |   | \"Question\" items in the \"qrr\" array.  |\n|                   |   |   |                                       |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| qrr               |   | A | Array of type \"Question\".  Each entry |\n|                   |   |   | is the contents of a single Question, |\n|                   |   |   | where a Question is the second or     |\n|                   |   |   | subsequent Question in a Query.  See  |\n|                   |   |   | Section 7.3.2.3.3.                    |\n|                   |   |   |                                       |\n| rrlist            |   | A | Array of type \"RRList\".  An \"RRList\"  |\n|                   |   |   | is an array of unsigned integers,     |\n|                   |   |   | indexes to \"RR\" items in the \"rr\"     |\n|                   |   |   | array.                                |\n|                   |   |   |                                       |\n| rr                |   | A | Array of type \"RR\".  Each entry is    |\n|                   |   |   | the contents of a single RR.  See     |\n|                   |   |   | Section 7.3.2.3.4.                    |\n|                   |   |   |                                       |\n| malformed-message |   | A | Array of the contents of malformed    |\n| -data             |   |   | messages.  Array of type              |\n|                   |   |   | \"MalformedMessageData\".  See Section  |\n|                   |   |   | 7.3.2.3.5.                            |\n+-------------------+---+---+---------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.3.1. \"ClassType\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3.1. “类类型”"
    },
    {
      "indent": 3,
      "text": "RR CLASS and TYPE information. A map containing the following:",
      "zh-CHS": "RR类和类型信息。包含以下内容的地图："
    },
    {
      "indent": 15,
      "text": "+-------+---+---+--------------------------+\n| Field | M | T | Description              |\n+-------+---+---+--------------------------+\n| type  | X | U | TYPE value [rrtypes].    |\n|       |   |   |                          |\n| class | X | U | CLASS value [rrclasses]. |\n+-------+---+---+--------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.3.2. \"QueryResponseSignature\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3.2. “查询响应签名”"
    },
    {
      "indent": 3,
      "text": "Elements of a Q/R data item that are often common between multiple individual Q/R data items. A map containing the following:",
      "zh-CHS": "通常在多个单独Q/R数据项之间通用的Q/R数据项的元素。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+--------------------+---+---+--------------------------------------+\n| Field              | M | T | Description                          |\n+--------------------+---+---+--------------------------------------+\n| server-address     |   | U | The index in the \"ip-address\" array  |\n| -index             |   |   | of the server IP address.  See       |\n|                    |   |   | Section 7.3.2.3.                     |\n|                    |   |   |                                      |\n| server-port        |   | U | The server port.                     |\n|                    |   |   |                                      |\n| qr-transport-flags | C | U | Bit flags describing the transport   |\n|                    |   |   | used to service the Query.  Same     |\n|                    |   |   | definition as \"mm-transport-flags\"   |\n|                    |   |   | in Section 7.3.2.3.5, with an        |\n|                    |   |   | additional indicator for trailing    |\n|                    |   |   | bytes.  See Appendix A.              |\n|                    |   |   | Bit 0.  IP version.  0 if IPv4, 1 if |\n|                    |   |   | IPv6.  See Section 6.2.4.            |\n|                    |   |   | Bits 1-4.  Transport.  4-bit         |\n|                    |   |   | unsigned value where                 |\n|                    |   |   | 0 = UDP [RFC1035]                    |\n|                    |   |   | 1 = TCP [RFC1035]                    |\n|                    |   |   | 2 = TLS [RFC7858]                    |\n|                    |   |   | 3 = DTLS [RFC8094]                   |\n|                    |   |   | 4 = HTTPS [RFC8484]                  |\n|                    |   |   | 15 = Non-standard transport (see     |\n|                    |   |   | below)                               |\n|                    |   |   | Values 5-14 are reserved for future  |\n|                    |   |   | use.                                 |\n|                    |   |   | Bit 5.  1 if trailing bytes in Query |\n|                    |   |   | packet.  See Section 11.2.           |\n|                    |   |   |                                      |\n| qr-type            |   | U | Type of Query/Response transaction   |\n|                    |   |   | based on the definitions in the      |\n|                    |   |   | dnstap schema [dnstap-schema].       |\n|                    |   |   | 0 = Stub.  A transaction between a   |\n|                    |   |   | stub resolver and a DNS server from  |\n|                    |   |   | the perspective of the stub          |\n|                    |   |   | resolver.                            |\n|                    |   |   | 1 = Client.  A transaction between a |\n|                    |   |   | client and a DNS server (a proxy or  |\n|                    |   |   | full recursive resolver) from the    |\n|                    |   |   | perspective of the DNS server.       |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "|                    |   |   | 2 = Resolver.  A transaction between |\n|                    |   |   | a recursive resolver and an          |\n|                    |   |   | authoritative server from the        |\n|                    |   |   | perspective of the recursive         |\n|                    |   |   | resolver.                            |\n|                    |   |   | 3 = Authoritative.  A transaction    |\n|                    |   |   | between a recursive resolver and an  |\n|                    |   |   | authoritative server from the        |\n|                    |   |   | perspective of the authoritative     |\n|                    |   |   | server.                              |\n|                    |   |   | 4 = Forwarder.  A transaction        |\n|                    |   |   | between a downstream forwarder and   |\n|                    |   |   | an upstream DNS server (a recursive  |\n|                    |   |   | resolver) from the perspective of    |\n|                    |   |   | the downstream forwarder.            |\n|                    |   |   | 5 = Tool.  A transaction between a   |\n|                    |   |   | DNS software tool and a DNS server,  |\n|                    |   |   | from the perspective of the tool.    |\n|                    |   |   |                                      |\n| qr-sig-flags       |   | U | Bit flags explicitly indicating      |\n|                    |   |   | attributes of the message pair       |\n|                    |   |   | represented by this Q/R data item    |\n|                    |   |   | (not all attributes may be recorded  |\n|                    |   |   | or deducible).                       |\n|                    |   |   | Bit 0.  1 if a Query was present.    |\n|                    |   |   | Bit 1.  1 if a Response was present. |\n|                    |   |   | Bit 2.  1 if a Query was present and |\n|                    |   |   | it had an OPT RR.                    |\n|                    |   |   | Bit 3.  1 if a Response was present  |\n|                    |   |   | and it had an OPT RR.                |\n|                    |   |   | Bit 4.  1 if a Query was present but |\n|                    |   |   | had no Question.                     |\n|                    |   |   | Bit 5.  1 if a Response was present  |\n|                    |   |   | but had no Question (only one        |\n|                    |   |   | query-name-index is stored per Q/R   |\n|                    |   |   | data item).                          |\n|                    |   |   |                                      |\n| query-opcode       |   | U | Query OPCODE.                        |\n|                    |   |   |                                      |\n| qr-dns-flags       |   | U | Bit flags with values from the Query |\n|                    |   |   | and Response DNS flags.  Flag values |\n|                    |   |   | are 0 if the Query or Response is    |\n|                    |   |   | not present.                         |\n|                    |   |   | Bit 0.  Query Checking Disabled      |\n|                    |   |   | (CD).                                |\n|                    |   |   | Bit 1.  Query Authenticated Data     |\n|                    |   |   | (AD).                                |\n|                    |   |   | Bit 2.  Query reserved (Z).          |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "|                    |   |   | Bit 3.  Query Recursion Available    |\n|                    |   |   | (RA).                                |\n|                    |   |   | Bit 4.  Query Recursion Desired      |\n|                    |   |   | (RD).                                |\n|                    |   |   | Bit 5.  Query TrunCation (TC).       |\n|                    |   |   | Bit 6.  Query Authoritative Answer   |\n|                    |   |   | (AA).                                |\n|                    |   |   | Bit 7.  Query DNSSEC answer OK (DO). |\n|                    |   |   | Bit 8.  Response Checking Disabled   |\n|                    |   |   | (CD).                                |\n|                    |   |   | Bit 9.  Response Authenticated Data  |\n|                    |   |   | (AD).                                |\n|                    |   |   | Bit 10.  Response reserved (Z).      |\n|                    |   |   | Bit 11.  Response Recursion          |\n|                    |   |   | Available (RA).                      |\n|                    |   |   | Bit 12.  Response Recursion Desired  |\n|                    |   |   | (RD).                                |\n|                    |   |   | Bit 13.  Response TrunCation (TC).   |\n|                    |   |   | Bit 14.  Response Authoritative      |\n|                    |   |   | Answer (AA).                         |\n|                    |   |   |                                      |\n| query-rcode        |   | U | Query RCODE.  If the Query contains  |\n|                    |   |   | an OPT RR [RFC6891], this value      |\n|                    |   |   | incorporates any EXTENDED-RCODE      |\n|                    |   |   | value [rcodes].                      |\n|                    |   |   |                                      |\n| query-classtype    |   | U | The index in the \"classtype\" array   |\n| -index             |   |   | of the CLASS and TYPE of the first   |\n|                    |   |   | Question.  See Section 7.3.2.3.      |\n|                    |   |   |                                      |\n| query-qdcount      |   | U | The QDCOUNT in the Query, or         |\n|                    |   |   | Response if no Query present.        |\n|                    |   |   |                                      |\n| query-ancount      |   | U | Query ANCOUNT.                       |\n|                    |   |   |                                      |\n| query-nscount      |   | U | Query NSCOUNT.                       |\n|                    |   |   |                                      |\n| query-arcount      |   | U | Query ARCOUNT.                       |\n|                    |   |   |                                      |\n| query-edns-version |   | U | The Query EDNS version.  (\"EDNS\"     |\n|                    |   |   | stands for Extension Mechanisms for  |\n|                    |   |   | DNS.)                                |\n|                    |   |   |                                      |\n| query-udp-size     |   | U | The Query EDNS sender's UDP payload  |\n|                    |   |   | size.                                |\n|                    |   |   |                                      |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| query-opt-rdata    |   | U | The index in the \"name-rdata\" array  |\n| -index             |   |   | of the OPT RDATA.  See Section       |\n|                    |   |   | 7.3.2.3.                             |\n|                    |   |   |                                      |\n| response-rcode     |   | U | Response RCODE.  If the Response     |\n|                    |   |   | contains an OPT RR [RFC6891], this   |\n|                    |   |   | value incorporates any EXTENDED-     |\n|                    |   |   | RCODE value [rcodes].                |\n+--------------------+---+---+--------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Version 1.0 of C-DNS supports transport values corresponding to DNS transports defined in IETF Standards Track documents at the time of writing. There are numerous non-standard methods of sending DNS messages over various transports using a variety of protocols, but they are out of scope for this document. With the current specification, these can be generically stored using value 15 (Non-standard transport), or implementations are free to use the negative integer map keys to define their own mappings. Such non-standard transports may also be the subject of a future extension to the specification.",
      "zh-CHS": "C-DNS的1.0版支持与编写时IETF标准跟踪文档中定义的DNS传输相对应的传输值。有许多使用各种协议通过各种传输发送DNS消息的非标准方法，但它们不在本文档的范围内。在当前规范中，这些可以使用值15（非标准传输）进行一般性存储，或者实现可以自由使用负整数映射键来定义自己的映射。此类非标准传输也可能是本规范未来扩展的主题。"
    },
    {
      "indent": 0,
      "text": "7.3.2.3.3. \"Question\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3.3. “问题”"
    },
    {
      "indent": 3,
      "text": "Details on individual Questions in a Question section. A map containing the following:",
      "zh-CHS": "在问题部分中详细介绍各个问题。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+-----------------+---+---+-----------------------------------------+\n| Field           | M | T | Description                             |\n+-----------------+---+---+-----------------------------------------+\n| name-index      | X | U | The index in the \"name-rdata\" array of  |\n|                 |   |   | the QNAME.  See Section 7.3.2.3.        |\n|                 |   |   |                                         |\n| classtype-index | X | U | The index in the \"classtype\" array of   |\n|                 |   |   | the CLASS and TYPE of the Question.     |\n|                 |   |   | See Section 7.3.2.3.                    |\n+-----------------+---+---+-----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.3.4. \"RR\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3.4. “RR”"
    },
    {
      "indent": 3,
      "text": "Details on individual RRs in RR sections. A map containing the following:",
      "zh-CHS": "在RR章节中详细介绍了各个RRs。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+-----------------+---+---+-----------------------------------------+\n| Field           | M | T | Description                             |\n+-----------------+---+---+-----------------------------------------+\n| name-index      | X | U | The index in the \"name-rdata\" array of  |\n|                 |   |   | the NAME.  See Section 7.3.2.3.         |\n|                 |   |   |                                         |\n| classtype-index | X | U | The index in the \"classtype\" array of   |\n|                 |   |   | the CLASS and TYPE of the RR.  See      |\n|                 |   |   | Section 7.3.2.3.                        |\n|                 |   |   |                                         |\n| ttl             |   | U | The RR Time to Live.                    |\n|                 |   |   |                                         |\n| rdata-index     |   | U | The index in the \"name-rdata\" array of  |\n|                 |   |   | the RR RDATA.  See Section 7.3.2.3.     |\n+-----------------+---+---+-----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.3.5. \"MalformedMessageData\"",
      "section_title": true,
      "zh-CHS": "7.3.2.3.5. “格式不正确的消息数据”"
    },
    {
      "indent": 3,
      "text": "Details on malformed DNS messages stored in this \"Block\" item. A map containing the following:",
      "zh-CHS": "有关此“阻止”项中存储的格式错误的DNS消息的详细信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+--------------------+---+---+--------------------------------------+\n| Field              | M | T | Description                          |\n+--------------------+---+---+--------------------------------------+\n| server-address     |   | U | The index in the \"ip-address\" array  |\n| -index             |   |   | of the server IP address.  See       |\n|                    |   |   | Section 7.3.2.3.                     |\n|                    |   |   |                                      |\n| server-port        |   | U | The server port.                     |\n|                    |   |   |                                      |\n| mm-transport-flags | C | U | Bit flags describing the transport   |\n|                    |   |   | used to service the Query.  See      |\n|                    |   |   | Section 6.2.4.                       |\n|                    |   |   | Bits 1-4.  Transport.  4-bit         |\n|                    |   |   | unsigned value where                 |\n|                    |   |   | 0 = UDP [RFC1035]                    |\n|                    |   |   | 1 = TCP [RFC1035]                    |\n|                    |   |   | 2 = TLS [RFC7858]                    |\n|                    |   |   | 3 = DTLS [RFC8094]                   |\n|                    |   |   | 4 = HTTPS [RFC8484]                  |\n|                    |   |   | 15 = Non-standard transport          |\n|                    |   |   | Values 5-14 are reserved for future  |\n|                    |   |   | use.                                 |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "|                    |   |   |                                      |\n| mm-payload         |   | S | The payload (raw bytes) of the DNS   |\n|                    |   |   | message.                             |\n+--------------------+---+---+--------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.4. \"QueryResponse\"",
      "section_title": true,
      "zh-CHS": "7.3.2.4. “查询响应”"
    },
    {
      "indent": 3,
      "text": "Details on individual Q/R data items.",
      "zh-CHS": "个别Q/R数据项的详细信息。"
    },
    {
      "indent": 3,
      "text": "Note that there is no requirement that the elements of the \"query-responses\" array are presented in strict chronological order.",
      "zh-CHS": "请注意，“查询响应”数组的元素不需要严格按时间顺序显示。"
    },
    {
      "indent": 3,
      "text": "A map containing the following items:",
      "zh-CHS": "包含以下项目的地图："
    },
    {
      "indent": 3,
      "text": "+----------------------+---+---+------------------------------------+\n| Field                | M | T | Description                        |\n+----------------------+---+---+------------------------------------+\n| time-offset          |   | U | Q/R timestamp as an offset in      |\n|                      |   |   | ticks (see Section 7.3.1.1.1) from |\n|                      |   |   | \"earliest-time\".  The timestamp is |\n|                      |   |   | the timestamp of the Query, or the |\n|                      |   |   | Response if there is no Query.     |\n|                      |   |   |                                    |\n| client-address-index |   | U | The index in the \"ip-address\"      |\n|                      |   |   | array of the client IP address.    |\n|                      |   |   | See Section 7.3.2.3.               |\n|                      |   |   |                                    |\n| client-port          |   | U | The client port.                   |\n|                      |   |   |                                    |\n| transaction-id       |   | U | DNS transaction identifier.        |\n|                      |   |   |                                    |\n| qr-signature-index   |   | U | The index in the \"qr-sig\" array of |\n|                      |   |   | the \"QueryResponseSignature\" item. |\n|                      |   |   | See Section 7.3.2.3.               |\n|                      |   |   |                                    |\n| client-hoplimit      |   | U | The IPv4 TTL or IPv6 Hoplimit from |\n|                      |   |   | the Query packet.                  |\n|                      |   |   |                                    |\n| response-delay       |   | I | The time difference between Query  |\n|                      |   |   | and Response, in ticks.  See       |\n|                      |   |   | Section 7.3.1.1.1.  Only present   |\n|                      |   |   | if there is a Query and a          |\n|                      |   |   | Response.  The delay can be        |\n|                      |   |   | negative if the network            |\n|                      |   |   | stack/capture library returns      |\n|                      |   |   | packets out of order.              |\n|                      |   |   |                                    |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| query-name-index     |   | U | The index in the \"name-rdata\"      |\n|                      |   |   | array of the item containing the   |\n|                      |   |   | QNAME for the first Question.  See |\n|                      |   |   | Section 7.3.2.3.                   |\n|                      |   |   |                                    |\n| query-size           |   | U | DNS Query message size (see        |\n|                      |   |   | below).                            |\n|                      |   |   |                                    |\n| response-size        |   | U | DNS Response message size (see     |\n|                      |   |   | below).                            |\n|                      |   |   |                                    |\n| response-processing  |   | M | Data on Response processing.  Map  |\n| -data                |   |   | of type \"ResponseProcessingData\".  |\n|                      |   |   | See Section 7.3.2.4.1.             |\n|                      |   |   |                                    |\n| query-extended       |   | M | Extended Query data.  Map of type  |\n|                      |   |   | \"QueryResponseExtended\".  See      |\n|                      |   |   | Section 7.3.2.4.2.                 |\n|                      |   |   |                                    |\n| response-extended    |   | M | Extended Response data.  Map of    |\n|                      |   |   | type \"QueryResponseExtended\".  See |\n|                      |   |   | Section 7.3.2.4.2.                 |\n+----------------------+---+---+------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The \"query-size\" and \"response-size\" fields hold the DNS message size. For UDP, this is the size of the UDP payload that contained the DNS message. For TCP, it is the size of the DNS message as specified in the two-byte message length header. Trailing bytes in UDP Queries are routinely observed in traffic to authoritative servers, and this value allows a calculation of how many trailing bytes were present.",
      "zh-CHS": "“查询大小”和“响应大小”字段保存DNS消息大小。对于UDP，这是包含DNS消息的UDP有效负载的大小。对于TCP，它是双字节消息长度标头中指定的DNS消息的大小。UDP查询中的尾随字节通常在到权威服务器的流量中观察到，该值允许计算存在多少尾随字节。"
    },
    {
      "indent": 0,
      "text": "7.3.2.4.1. \"ResponseProcessingData\"",
      "section_title": true,
      "zh-CHS": "7.3.2.4.1. “响应处理数据”"
    },
    {
      "indent": 3,
      "text": "Information on the server processing that produced the Response. A map containing the following:",
      "zh-CHS": "有关产生响应的服务器处理的信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| bailiwick-index  |   | U | The index in the \"name-rdata\" array of |\n|                  |   |   | the owner name for the Response        |\n|                  |   |   | bailiwick.  See Section 7.3.2.3.       |\n|                  |   |   |                                        |\n| processing-flags |   | U | Flags relating to Response processing. |\n|                  |   |   | Bit 0.  1 if the Response came from    |\n|                  |   |   | cache.                                 |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.4.2. \"QueryResponseExtended\"",
      "section_title": true,
      "zh-CHS": "7.3.2.4.2. “QueryResponseExtended”"
    },
    {
      "indent": 3,
      "text": "Extended data on the Q/R data item.",
      "zh-CHS": "Q/R数据项上的扩展数据。"
    },
    {
      "indent": 3,
      "text": "Each item in the map is present only if collection of the relevant details is configured.",
      "zh-CHS": "仅当配置了相关详细信息的集合时，地图中的每个项目才存在。"
    },
    {
      "indent": 3,
      "text": "A map containing the following items:",
      "zh-CHS": "包含以下项目的地图："
    },
    {
      "indent": 3,
      "text": "+------------------+---+---+----------------------------------------+\n| Field            | M | T | Description                            |\n+------------------+---+---+----------------------------------------+\n| question-index   |   | U | The index in the \"qlist\" array of the  |\n|                  |   |   | entry listing any second and           |\n|                  |   |   | subsequent Questions in the Question   |\n|                  |   |   | section for the Query or Response.     |\n|                  |   |   | See Section 7.3.2.3.                   |\n|                  |   |   |                                        |\n| answer-index     |   | U | The index in the \"rrlist\" array of the |\n|                  |   |   | entry listing the Answer RR sections   |\n|                  |   |   | for the Query or Response.  See        |\n|                  |   |   | Section 7.3.2.3.                       |\n|                  |   |   |                                        |\n| authority-index  |   | U | The index in the \"rrlist\" array of the |\n|                  |   |   | entry listing the Authority RR         |\n|                  |   |   | sections for the Query or Response.    |\n|                  |   |   | See Section 7.3.2.3.                   |\n|                  |   |   |                                        |\n| additional-index |   | U | The index in the \"rrlist\" array of the |\n|                  |   |   | entry listing the Additional RR        |\n|                  |   |   | sections for the Query or Response.    |\n|                  |   |   | See Section 7.3.2.3.  Note that Query  |\n|                  |   |   | OPT RR data can optionally be stored   |\n|                  |   |   | in the QuerySignature.                 |\n+------------------+---+---+----------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.5. \"AddressEventCount\"",
      "section_title": true,
      "zh-CHS": "7.3.2.5. “AddressEventCount”"
    },
    {
      "indent": 3,
      "text": "Counts of various IP-related events relating to traffic with individual client addresses. A map containing the following:",
      "zh-CHS": "与单个客户端地址的流量相关的各种IP相关事件的计数。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+--------------------+---+---+--------------------------------------+\n| Field              | M | T | Description                          |\n+--------------------+---+---+--------------------------------------+\n| ae-type            | X | U | The type of event.  The following    |\n|                    |   |   | event types are currently defined:   |\n|                    |   |   | 0.  TCP reset.                       |\n|                    |   |   | 1.  ICMP time exceeded.              |\n|                    |   |   | 2.  ICMP destination unreachable.    |\n|                    |   |   | 3.  ICMPv6 time exceeded.            |\n|                    |   |   | 4.  ICMPv6 destination unreachable.  |\n|                    |   |   | 5.  ICMPv6 packet too big.           |\n|                    |   |   |                                      |\n| ae-code            |   | U | A code relating to the event.  For   |\n|                    |   |   | ICMP or ICMPv6 events, this MUST be  |\n|                    |   |   | the ICMP [RFC792] or ICMPv6          |\n|                    |   |   | [RFC4443] code.  For other events,   |\n|                    |   |   | the contents are undefined.          |\n|                    |   |   |                                      |\n| ae-transport-flags | C | U | Bit flags describing the transport   |\n|                    |   |   | used to service the event.  See      |\n|                    |   |   | Section 6.2.4.                       |\n|                    |   |   | Bit 0.  IP version.  0 if IPv4, 1 if |\n|                    |   |   | IPv6.                                |\n|                    |   |   | Bits 1-4.  Transport.  4-bit         |\n|                    |   |   | unsigned value where                 |\n|                    |   |   | 0 = UDP [RFC1035]                    |\n|                    |   |   | 1 = TCP [RFC1035]                    |\n|                    |   |   | 2 = TLS [RFC7858]                    |\n|                    |   |   | 3 = DTLS [RFC8094]                   |\n|                    |   |   | 4 = HTTPS [RFC8484]                  |\n|                    |   |   | 15 = Non-standard transport          |\n|                    |   |   | Values 5-14 are reserved for future  |\n|                    |   |   | use.                                 |\n|                    |   |   |                                      |\n| ae-address-index   | X | U | The index in the \"ip-address\" array  |\n|                    |   |   | of the client address.  See Section  |\n|                    |   |   | 7.3.2.3.                             |\n|                    |   |   |                                      |\n| ae-count           | X | U | The number of occurrences of this    |\n|                    |   |   | event during the Block collection    |\n|                    |   |   | period.                              |\n+--------------------+---+---+--------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "7.3.2.6. \"MalformedMessage\"",
      "section_title": true,
      "zh-CHS": "7.3.2.6. “格式错误的消息”"
    },
    {
      "indent": 3,
      "text": "Details on Malformed Message data items. A map containing the following:",
      "zh-CHS": "有关格式错误的邮件数据项的详细信息。包含以下内容的地图："
    },
    {
      "indent": 3,
      "text": "+----------------------+---+---+------------------------------------+\n| Field                | M | T | Description                        |\n+----------------------+---+---+------------------------------------+\n| time-offset          |   | U | Message timestamp as an offset in  |\n|                      |   |   | ticks (see Section 7.3.1.1.1) from |\n|                      |   |   | \"earliest-time\".                   |\n|                      |   |   |                                    |\n| client-address-index |   | U | The index in the \"ip-address\"      |\n|                      |   |   | array of the client IP address.    |\n|                      |   |   | See Section 7.3.2.3.               |\n|                      |   |   |                                    |\n| client-port          |   | U | The client port.                   |\n|                      |   |   |                                    |\n| message-data-index   |   | U | The index in the \"malformed-       |\n|                      |   |   | message-data\" array of the message |\n|                      |   |   | data for this message.  See        |\n|                      |   |   | Section 7.3.2.3.                   |\n+----------------------+---+---+------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "8. Versioning",
      "section_title": true,
      "zh-CHS": "8. 版本控制"
    },
    {
      "indent": 3,
      "text": "The C-DNS File Preamble includes a file Format Version; a major and minor version number are required fields. This document defines version 1.0 of the C-DNS specification. This section describes the intended use of these version numbers in future specifications.",
      "zh-CHS": "C-DNS文件前导包括文件格式版本；主要版本号和次要版本号是必填字段。本文档定义了C-DNS规范的1.0版。本节描述了这些版本号在未来规范中的预期用途。"
    },
    {
      "indent": 3,
      "text": "It is noted that version 1.0 includes many optional fields; therefore, consumers of version 1.0 should be inherently robust to parsing files with variable data content.",
      "zh-CHS": "值得注意的是，版本1.0包含许多可选字段；因此，1.0版的使用者在解析具有可变数据内容的文件时应该具有固有的健壮性。"
    },
    {
      "indent": 3,
      "text": "Within a major version, a new minor version MUST be a strict superset of the previous minor version, with no semantic changes to existing fields. New keys MAY be added to existing maps, and new maps MAY be added. A consumer capable of reading a particular major.minor version MUST also be capable of reading all previous minor versions of the same major version. It SHOULD also be capable of parsing all subsequent minor versions, ignoring any keys or maps that it does not recognize.",
      "zh-CHS": "在主版本中，新的次要版本必须是前一次要版本的严格超集，对现有字段没有语义更改。可以将新键添加到现有地图，也可以添加新地图。能够阅读特定主要版本的使用者。次要版本还必须能够阅读相同主要版本的所有以前次要版本。它还应该能够解析所有后续的次要版本，忽略任何它无法识别的键或映射。"
    },
    {
      "indent": 3,
      "text": "A new major version indicates changes to the format that are not backwards compatible with previous major versions. A consumer capable of only reading a particular major version (greater than 1) is neither required nor expected to be capable of reading a previous major version.",
      "zh-CHS": "新的主要版本表示对格式的更改与以前的主要版本不向后兼容。仅能阅读特定主要版本（大于1）的使用者既不要求也不期望能够阅读以前的主要版本。"
    },
    {
      "indent": 0,
      "text": "9. C-DNS to PCAP",
      "section_title": true,
      "zh-CHS": "9. C-DNS到PCAP"
    },
    {
      "indent": 3,
      "text": "It is usually possible to reconstruct PCAP files from the C-DNS format in a lossy fashion. Some of the issues with reconstructing both the DNS payload and the full packet stream are outlined here.",
      "zh-CHS": "通常可以以有损方式从C-DNS格式重建PCAP文件。这里概述了重建DNS有效负载和完整数据包流的一些问题。"
    },
    {
      "indent": 3,
      "text": "The reconstruction of well-formed DNS messages depends on two factors:",
      "zh-CHS": "格式良好的DNS消息的重建取决于两个因素："
    },
    {
      "indent": 3,
      "text": "1. Whether or not a particular subset of the optional fields were captured in the C-DNS file, specifically the data fields necessary to reconstruct a valid IP header and DNS payload for both Query and Response (see Appendix D.1). Clearly, if not all these data fields were captured, the reconstruction is likely to be imperfect even if reasonable defaults are provided for the reconstruction.",
      "zh-CHS": "1. C-DNS文件中是否捕获了可选字段的特定子集，特别是为查询和响应重建有效IP报头和DNS有效负载所需的数据字段（见附录D.1）。显然，如果没有捕获所有这些数据字段，即使为重建提供了合理的默认值，重建也可能不完美。"
    },
    {
      "indent": 3,
      "text": "2. Whether or not at least one field was captured that unambiguously identifies the Query/Response data item as containing just a Query, just a Response, or a Query/Response pair. Obviously, the qr-sig-flags defined in Section 7.3.2.3.2 is such a field; however, this field is optional. For more details, see Appendix D.2.",
      "zh-CHS": "2. 是否至少捕获了一个字段，该字段明确地将查询/响应数据项标识为仅包含查询、响应或查询/响应对。显然，第7.3.2.3.2节中定义的qr sig标志就是这样一个字段；但是，此字段是可选的。有关更多详细信息，请参见附录D.2。"
    },
    {
      "indent": 3,
      "text": "It is noted again that simply having hints that indicate that certain data fields were not omitted does not guarantee that those data fields were actually captured. Therefore, the ability to reconstruct PCAP data (in the absence of defaults) can in principle vary for each record captured in a C-DNS file, and between Blocks that have differing hints.",
      "zh-CHS": "需要再次指出的是，仅仅具有指示未省略某些数据字段的提示并不保证实际捕获了这些数据字段。因此，对于C-DNS文件中捕获的每个记录，以及具有不同提示的块之间，重构PCAP数据的能力（在没有默认值的情况下）原则上可能会有所不同。"
    },
    {
      "indent": 3,
      "text": "Even if all sections of the Response were captured, one cannot reconstruct the DNS Response payload exactly, due to the fact that some DNS names in the message on the wire may have been compressed. Section 9.1 discusses this in more detail.",
      "zh-CHS": "即使捕获了响应的所有部分，也无法准确地重构DNS响应有效负载，这是因为线路上消息中的某些DNS名称可能已被压缩。第9.1节对此进行了更详细的讨论。"
    },
    {
      "indent": 3,
      "text": "Some transport information is not captured in the C-DNS format. For example, the following aspects of the original packet stream cannot be reconstructed from the C-DNS format:",
      "zh-CHS": "某些传输信息不是以C-DNS格式捕获的。例如，不能从C-DNS格式重构原始分组流的以下方面："
    },
    {
      "indent": 3,
      "text": "o IP fragmentation",
      "zh-CHS": "o IP分片"
    },
    {
      "indent": 3,
      "text": "o TCP stream information:",
      "zh-CHS": "o TCP流信息："
    },
    {
      "indent": 6,
      "text": "* Multiple DNS messages may have been sent in a single TCP segment",
      "zh-CHS": "* 在单个TCP段中可能发送了多个DNS消息"
    },
    {
      "indent": 6,
      "text": "* A DNS payload may have been split across multiple TCP segments",
      "zh-CHS": "* DNS有效负载可能已被分割到多个TCP段"
    },
    {
      "indent": 6,
      "text": "* Multiple DNS messages may have been sent on a single TCP session",
      "zh-CHS": "* 在一个TCP会话上可能发送了多个DNS消息"
    },
    {
      "indent": 3,
      "text": "o TLS session information:",
      "zh-CHS": "o TLS会话信息："
    },
    {
      "indent": 6,
      "text": "* TLS version or cipher suites",
      "zh-CHS": "* TLS版本或密码套件"
    },
    {
      "indent": 6,
      "text": "* TLS-related features such as TCP Fast Open (TFO) [RFC7413] or TLS session resumption [RFC5077]",
      "zh-CHS": "* TLS相关功能，如TCP快速打开（TFO）[RFC7413]或TLS会话恢复[RFC5077]"
    },
    {
      "indent": 3,
      "text": "o DNS-over-HTTPS [RFC8484] message details:",
      "zh-CHS": "o HTTPS上的DNS[RFC8484]消息详细信息："
    },
    {
      "indent": 6,
      "text": "* Whether the message used POST or GET",
      "zh-CHS": "* 消息是使用POST还是GET"
    },
    {
      "indent": 6,
      "text": "* HTTPS Headers",
      "zh-CHS": "* HTTPS标头"
    },
    {
      "indent": 3,
      "text": "o Malformed DNS messages if the wire format is not recorded",
      "zh-CHS": "o 如果未记录wire格式，则DNS消息格式不正确"
    },
    {
      "indent": 3,
      "text": "o Any non-DNS messages that were in the original packet stream, e.g., ICMP",
      "zh-CHS": "o 原始数据包流中的任何非DNS消息，例如ICMP"
    },
    {
      "indent": 3,
      "text": "Simple assumptions can be made on the reconstruction: fragmented and DNS-over-TCP messages can be reconstructed into single packets, and a single TCP session can be constructed for each TCP packet.",
      "zh-CHS": "可以对重构进行简单的假设：碎片化和DNS over TCP消息可以重构为单个数据包，并且可以为每个TCP数据包构建单个TCP会话。"
    },
    {
      "indent": 3,
      "text": "Additionally, if malformed messages and non-DNS packets are captured separately, they can be merged with packet captures reconstructed from C-DNS to produce a more complete packet stream.",
      "zh-CHS": "此外，如果分别捕获格式错误的消息和非DNS数据包，则可以将它们与从C-DNS重构的数据包捕获合并，以生成更完整的数据包流。"
    },
    {
      "indent": 0,
      "text": "9.1. Name Compression",
      "section_title": true,
      "zh-CHS": "9.1. 名称压缩"
    },
    {
      "indent": 3,
      "text": "All the names stored in the C-DNS format are full domain names; no name compression (per [RFC1035]) is used on the individual names within the format. Therefore, when reconstructing a packet, name compression must be used in order to reproduce the on-the-wire representation of the packet.",
      "zh-CHS": "以C-DNS格式存储的所有名称都是完整的域名；未对格式中的单个名称使用名称压缩（根据[RFC1035]）。因此，在重构数据包时，必须使用名称压缩来再现数据包的在线表示。"
    },
    {
      "indent": 3,
      "text": "Name compression per [RFC1035] works by substituting trailing sections of a name with a reference back to the occurrence of those sections earlier in the message. Not all name server software uses the same algorithm when compressing domain names within the Responses. Some attempt maximum recompression at the expense of runtime resources, others use heuristics to balance compression and speed, and others use different rules for what is a valid compression target.",
      "zh-CHS": "根据[RFC1035]进行的名称压缩是通过将名称的尾随部分替换为消息中前面出现的那些部分的引用来实现的。在响应中压缩域名时，并非所有名称服务器软件都使用相同的算法。一些人以牺牲运行时资源为代价尝试最大程度的重新压缩，另一些人使用启发式来平衡压缩和速度，还有一些人使用不同的规则来确定什么是有效的压缩目标。"
    },
    {
      "indent": 3,
      "text": "This means that Responses to the same Query from different name server software that match in terms of DNS payload content (header, counts, RRs with name compression removed) do not necessarily match byte for byte on the wire.",
      "zh-CHS": "这意味着，不同名称服务器软件对相同查询的响应在DNS有效负载内容（标题、计数、删除名称压缩的RRs）方面匹配，不一定在线路上逐字节匹配。"
    },
    {
      "indent": 3,
      "text": "Therefore, it is not possible to ensure that the DNS Response payload is reconstructed byte for byte from C-DNS data. However, it can at least, in principle, be reconstructed to have the correct payload length (since the original Response length is captured) if there is enough knowledge of the commonly implemented name compression algorithms. For example, a simplistic approach would be to try each algorithm in turn to see if it reproduces the original length, stopping at the first match. This would not guarantee that the correct algorithm has been used, as it is possible to match the length whilst still not matching the on-the-wire bytes; however, without further information added to the C-DNS data, this is the best that can be achieved.",
      "zh-CHS": "因此，无法确保从C-DNS数据逐字节重建DNS响应有效负载。然而，如果对常用的实现的名称压缩算法有足够的了解，则至少在原则上可以将其重构为具有正确的有效负载长度（因为捕获了原始响应长度）。例如，一种过于简单的方法是依次尝试每种算法，看看它是否复制原始长度，并在第一次匹配时停止。这不能保证使用了正确的算法，因为可能会匹配长度，但仍然不匹配在线字节；但是，如果不向C-DNS数据中添加更多信息，这是可以实现的最好结果。"
    },
    {
      "indent": 3,
      "text": "Appendix B presents an example of two different compression algorithms used by well-known name server software.",
      "zh-CHS": "附录B给出了知名名称服务器软件使用的两种不同压缩算法的示例。"
    },
    {
      "indent": 0,
      "text": "10. Data Collection",
      "section_title": true,
      "zh-CHS": "10. 数据收集"
    },
    {
      "indent": 3,
      "text": "This section describes a non-normative proposed algorithm for the processing of a captured stream of DNS Queries and Responses and production of a stream of Q/R data items, matching Queries and Responses where possible.",
      "zh-CHS": "本节描述了一种非规范性的拟议算法，用于处理捕获的DNS查询和响应流，并生成Q/R数据项流，在可能的情况下匹配查询和响应。"
    },
    {
      "indent": 3,
      "text": "For the purposes of this discussion, it is assumed that the input has been preprocessed such that:",
      "zh-CHS": "在本讨论中，假设输入已经过预处理，以便："
    },
    {
      "indent": 3,
      "text": "1. All IP fragmentation reassembly, TCP stream reassembly, and so on, have already been performed.",
      "zh-CHS": "1. 所有IP碎片重组、TCP流重组等都已执行。"
    },
    {
      "indent": 3,
      "text": "2. Each message is associated with transport metadata required to generate the Primary ID (see Section 10.2.1).",
      "zh-CHS": "2. 每条消息都与生成主ID所需的传输元数据相关联（参见第10.2.1节）。"
    },
    {
      "indent": 3,
      "text": "3. Each message has a well-formed DNS Header of 12 bytes, and (if present) the first Question in the Question section can be parsed to generate the Secondary ID (see below). As noted earlier, this requirement can result in a malformed Query being removed in the preprocessing stage, but the correctly formed Response with RCODE of FORMERR being present.",
      "zh-CHS": "3. 每条消息都有一个格式良好的12字节DNS头，并且（如果存在）可以解析问题部分中的第一个问题以生成辅助ID（见下文）。如前所述，此要求可能导致在预处理阶段删除格式错误的查询，但存在RCODE为FORMERR的正确格式响应。"
    },
    {
      "indent": 3,
      "text": "DNS messages are processed in the order they are delivered to the implementation.",
      "zh-CHS": "DNS消息按照它们传递到实现的顺序进行处理。"
    },
    {
      "indent": 3,
      "text": "It should be noted that packet capture libraries do not necessarily provide packets in strict chronological order. This can, for example, arise on multi-core platforms where packets arriving at a network device are processed by different cores. On systems where this behavior has been observed, the timestamps associated with each packet are consistent; Queries always have a timestamp prior to the Response timestamp. However, the order in which these packets appear in the packet capture stream is not necessarily strictly chronological; a Response can appear in the capture stream before the Query that provoked the Response. For this discussion, this non-chronological delivery is termed \"skew\".",
      "zh-CHS": "应该注意的是，数据包捕获库不一定按照严格的时间顺序提供数据包。例如，这可能出现在多核平台上，其中到达网络设备的数据包由不同的核处理。在观察到这种行为的系统上，与每个数据包相关联的时间戳是一致的；查询总是在响应时间戳之前有一个时间戳。然而，这些分组在分组捕获流中出现的顺序不一定严格按时间顺序排列；响应可以出现在引发响应的查询之前的捕获流中。在本次讨论中，这种不按时间顺序的交付被称为“扭曲”。"
    },
    {
      "indent": 3,
      "text": "In the presence of skew, Response packets can arrive for matching before the corresponding Query. To avoid generating false instances of Responses without a matching Query, and Queries without a matching Response, the matching algorithm must take the possibility of skew into account.",
      "zh-CHS": "在存在倾斜的情况下，响应包可以在相应查询之前到达以进行匹配。为了避免在没有匹配查询的情况下生成错误的响应实例，以及在没有匹配响应的情况下生成错误的响应实例，匹配算法必须考虑倾斜的可能性。"
    },
    {
      "indent": 0,
      "text": "10.1. Matching Algorithm",
      "section_title": true,
      "zh-CHS": "10.1. 匹配算法"
    },
    {
      "indent": 3,
      "text": "A schematic representation of the algorithm for matching Q/R data items is shown in Figure 3. It takes individual DNS Query or Response messages as input, and it outputs matched Q/R data items. The numbers in the figure identify matching operations listed in Table 1. Specific details of the algorithm -- for example, queues, timers, and identifiers -- are given in the following sections.",
      "zh-CHS": "匹配Q/R数据项的算法示意图如图3所示。它将单个DNS查询或响应消息作为输入，并输出匹配的Q/R数据项。图中的数字表示表1中列出的匹配操作。算法的具体细节——例如，队列、计时器和标识符——在以下部分中给出。"
    },
    {
      "indent": 4,
      "text": "                   .----------------------.\n                   | Process next message |<------------------+\n                   `----------------------'                   |\n                               |                              |\n               +------------------------------+               |\n               | Generate message identifiers |               |\n               +------------------------------+               |\n                               |                              |\n                      Response | Query                        |\n               +--------------< >---------------+             |\n               |                                |             |\n     +--------------------+           +--------------------+  |\n     | Find earliest QR   |           | Create QR item (2) |  |\n     | item in OFIFO (1)  |           +--------------------+  |\n     +--------------------+                     |             |\n                |                        +---------------+    |\n          Match | No match               | Append new QR |    |\n      +--------< >------+                | item to OFIFO |    |\n      |                 |                +---------------+    |\n+-----------+      +--------+                   |             |\n| Update QR |      | Add to |          +-------------------+  |\n| item (3)  |      | RFIFO  |          | Find earliest QR  |  |\n+-----------+      +--------+          | item in RFIFO (1) |  |\n      |                 |              +-------------------+  |\n      +-----------------+                       |             |\n                |                               |             |\n                |     +----------------+  Match | No match    |\n                |     | Remove R       |-------< >-----+      |\n                |     | from RFIFO (3) |               |      |\n                |     +----------------+               |      |\n                |              |                       |      |\n                +--------------+-----------------------+      |\n                               |                              |\n        +----------------------------------------------+      |\n        | Update all timed-out (QT) OFIFO QR items (4) |      |\n        +----------------------------------------------+      |\n                               |                              |\n               +--------------------------------+             |\n               | Remove all timed-out (ST) R    |             |\n               | from RFIFO, create QR item (5) |             |\n               +--------------------------------+             |\n           ____________________|_______________________       |\n          /                                            /      |\n         /  Remove all consecutive done entries from  /-------+\n        /   front of OFIFO for further processing    /\n       /____________________________________________/",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 11,
      "text": "OFIFO = output FIFO containing Q/R data items (Section 10.6) RFIFO = Response FIFO containing unmatched Response items (Section 10.6) QT = Query Timeout (Section 10.3) ST = Skew Timeout (Section 10.3)",
      "zh-CHS": "OFIFO=包含Q/R数据项的输出FIFO（第10.6节）RFIFO=包含不匹配响应项的响应FIFO（第10.6节）QT=查询超时（第10.3节）ST=倾斜超时（第10.3节）"
    },
    {
      "indent": 16,
      "text": "Figure 3: Query/Response Matching Algorithm",
      "zh-CHS": "图3：查询/响应匹配算法"
    },
    {
      "indent": 9,
      "text": "+-----------+-------------------------------------------+\n| Reference | Operation                                 |\n+-----------+-------------------------------------------+\n| (1)       | Find earliest QR item in FIFO where:      |\n|           | * QR.done = false                         |\n|           | * QR.Q.PrimaryID == R.PrimaryID           |\n|           | and, if both QR.Q and R have SecondaryID: |\n|           | * QR.Q.SecondaryID == R.SecondaryID       |\n|           |                                           |\n| (2)       | Set:                                      |\n|           | QR.Q := Q                                 |\n|           | QR.R := nil                               |\n|           | QR.done := false                          |\n|           |                                           |\n| (3)       | Set:                                      |\n|           | QR.R := R                                 |\n|           | QR.done := true                           |\n|           |                                           |\n| (4)       | Set:                                      |\n|           | QR.done := true                           |\n|           |                                           |\n| (5)       | Set:                                      |\n|           | QR.Q := nil                               |\n|           | QR.R := R                                 |\n|           | QR.done := true                           |\n+-----------+-------------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 12,
      "text": "Table 1: Operations Used in the Matching Algorithm",
      "zh-CHS": "表1：匹配算法中使用的操作"
    },
    {
      "indent": 0,
      "text": "10.2. Message Identifiers",
      "section_title": true,
      "zh-CHS": "10.2. 消息标识符"
    },
    {
      "indent": 0,
      "text": "10.2.1. Primary ID (Required)",
      "section_title": true,
      "zh-CHS": "10.2.1. 主ID（必需）"
    },
    {
      "indent": 3,
      "text": "A Primary ID is constructed for each message. It is composed of the following data:",
      "zh-CHS": "为每条消息构造一个主ID。它由以下数据组成："
    },
    {
      "indent": 3,
      "text": "1. Source IP Address",
      "zh-CHS": "1. 源IP地址"
    },
    {
      "indent": 3,
      "text": "2. Destination IP Address",
      "zh-CHS": "2. 目的地址"
    },
    {
      "indent": 3,
      "text": "3. Source Port",
      "zh-CHS": "3. 源端口"
    },
    {
      "indent": 3,
      "text": "4. Destination Port",
      "zh-CHS": "4. 目的港"
    },
    {
      "indent": 3,
      "text": "5. Transport",
      "zh-CHS": "5. 运输"
    },
    {
      "indent": 3,
      "text": "6. DNS Message ID",
      "zh-CHS": "6. DNS消息ID"
    },
    {
      "indent": 0,
      "text": "10.2.2. Secondary ID (Optional)",
      "section_title": true,
      "zh-CHS": "10.2.2. 辅助ID（可选）"
    },
    {
      "indent": 3,
      "text": "If present, the first Question in the Question section is used as a Secondary ID for each message. Note that there may be well-formed DNS Queries that have a QDCOUNT of 0, and some Responses may have a QDCOUNT of 0 (for example, Responses with RCODE=FORMERR or NOTIMP). In this case, the Secondary ID is not used in matching.",
      "zh-CHS": "如果存在，问题部分中的第一个问题将用作每条消息的辅助ID。请注意，可能存在QDCOUNT为0的格式良好的DNS查询，某些响应的QDCOUNT为0（例如，RCODE=FORMERR或NOTIMP的响应）。在这种情况下，辅助ID不用于匹配。"
    },
    {
      "indent": 0,
      "text": "10.3. Algorithm Parameters",
      "section_title": true,
      "zh-CHS": "10.3. 算法参数"
    },
    {
      "indent": 3,
      "text": "1. Query Timeout (QT). A Query arrives with timestamp t1. If no Response matching that Query has arrived before other input arrives timestamped later than (t1 + QT), a Q/R data item containing only a Query is recorded. The QT value is typically on the order of 5 seconds.",
      "zh-CHS": "1. 查询超时（QT）。查询到达时带有时间戳t1。如果在时间戳晚于（t1+QT）的其他输入到达之前，没有与该查询匹配的响应到达，则记录仅包含查询的Q/R数据项。QT值通常为5秒左右。"
    },
    {
      "indent": 3,
      "text": "2. Skew Timeout (ST). A Response arrives with timestamp t2. If a Response has not been matched by a Query before input arrives timestamped later than (t2 + ST), a Q/R data item containing only a Response is recorded. The ST value is typically a few microseconds.",
      "zh-CHS": "2. 倾斜超时（ST）。响应以时间戳t2到达。如果在输入到达时间戳晚于（t2+ST）之前，响应没有被查询匹配，则记录仅包含响应的Q/R数据项。ST值通常为几微秒。"
    },
    {
      "indent": 0,
      "text": "10.4. Algorithm Requirements",
      "section_title": true,
      "zh-CHS": "10.4. 算法要求"
    },
    {
      "indent": 3,
      "text": "The algorithm is designed to handle the following input data:",
      "zh-CHS": "该算法设计用于处理以下输入数据："
    },
    {
      "indent": 3,
      "text": "1. Multiple Queries with the same Primary ID (but different Secondary ID) arriving before any Responses for these Queries are seen.",
      "zh-CHS": "1. 具有相同主ID（但不同的辅助ID）的多个查询在看到这些查询的任何响应之前到达。"
    },
    {
      "indent": 3,
      "text": "2. Multiple Queries with the same Primary and Secondary ID arriving before any Responses for these Queries are seen.",
      "zh-CHS": "2. 具有相同主ID和辅助ID的多个查询在看到这些查询的任何响应之前到达。"
    },
    {
      "indent": 3,
      "text": "3. Queries for which no later Response can be found within the specified timeout.",
      "zh-CHS": "3. 在指定的超时时间内找不到后续响应的查询。"
    },
    {
      "indent": 3,
      "text": "4. Responses for which no previous Query can be found within the specified timeout.",
      "zh-CHS": "4. 在指定的超时时间内找不到以前查询的响应。"
    },
    {
      "indent": 0,
      "text": "10.5. Algorithm Limitations",
      "section_title": true,
      "zh-CHS": "10.5. 算法限制"
    },
    {
      "indent": 3,
      "text": "For cases 1 and 2 listed in the above requirements, it is not possible to unambiguously match Queries with Responses. This algorithm chooses to match to the earliest Query with the correct Primary and Secondary ID.",
      "zh-CHS": "对于上述要求中列出的情况1和2，不可能明确地将查询与响应匹配。该算法选择使用正确的主ID和辅助ID匹配最早的查询。"
    },
    {
      "indent": 0,
      "text": "10.6. Workspace",
      "section_title": true,
      "zh-CHS": "10.6. 工作空间"
    },
    {
      "indent": 3,
      "text": "The algorithm employs two FIFO queues:",
      "zh-CHS": "该算法采用两个FIFO队列："
    },
    {
      "indent": 3,
      "text": "o OFIFO: an output FIFO containing Q/R data items in chronological order.",
      "zh-CHS": "o OFIFO：一种按时间顺序包含Q/R数据项的输出FIFO。"
    },
    {
      "indent": 3,
      "text": "o RFIFO: a FIFO holding Responses without a matching Query in order of arrival.",
      "zh-CHS": "o RFIFO：按到达顺序保留响应的FIFO，没有匹配的查询。"
    },
    {
      "indent": 0,
      "text": "10.7. Output",
      "section_title": true,
      "zh-CHS": "10.7. 输出"
    },
    {
      "indent": 3,
      "text": "The output is a list of Q/R data items. Both the Query and Response elements are optional in these items; therefore, Q/R data items have one of three types of content:",
      "zh-CHS": "输出是Q/R数据项的列表。查询和响应元素在这些项中都是可选的；因此，Q/R数据项具有三种类型的内容之一："
    },
    {
      "indent": 3,
      "text": "1. A matched pair of Query and Response messages",
      "zh-CHS": "1. 一对匹配的查询和响应消息"
    },
    {
      "indent": 3,
      "text": "2. A Query message with no Response",
      "zh-CHS": "2. 没有响应的查询消息"
    },
    {
      "indent": 3,
      "text": "3. A Response message with no Query",
      "zh-CHS": "3. 没有查询的响应消息"
    },
    {
      "indent": 3,
      "text": "The timestamp of a list item is that of the Query for cases 1 and 2 and that of the Response for case 3.",
      "zh-CHS": "列表项的时间戳是案例1和案例2的查询时间戳和案例3的响应时间戳。"
    },
    {
      "indent": 0,
      "text": "10.8. Post-Processing",
      "section_title": true,
      "zh-CHS": "10.8. 后处理"
    },
    {
      "indent": 3,
      "text": "When ending a capture, all items in the RFIFO are timed out immediately, generating Response only entries to the OFIFO. These and all other remaining entries in the OFIFO should be treated as timed-out Queries.",
      "zh-CHS": "在结束捕获时，RFIFO中的所有项目都会立即超时，从而生成仅响应OFIFO的条目。OFIFO中的这些项和所有其他剩余项应视为超时查询。"
    },
    {
      "indent": 0,
      "text": "11. Implementation Guidance",
      "section_title": true,
      "zh-CHS": "11. 实施指导"
    },
    {
      "indent": 3,
      "text": "Whilst this document makes no specific recommendations with respect to \"Canonical CBOR\" (see Section 3.9 of [RFC7049]), the following guidance may be of use to implementers.",
      "zh-CHS": "虽然本文件未就“规范CBOR”（见[RFC7049]第3.9节）提出具体建议，但以下指南可供实施者使用。"
    },
    {
      "indent": 3,
      "text": "Adherence to the first two rules given in Section 3.9 of [RFC7049] will minimize file sizes.",
      "zh-CHS": "遵守[RFC7049]第3.9节中给出的前两条规则将最小化文件大小。"
    },
    {
      "indent": 3,
      "text": "Adherence to the last two rules given in Section 3.9 of [RFC7049] for all maps and arrays would unacceptably constrain implementations -- for example, in the use case of real-time data collection in constrained environments where outputting Block Tables after Q/R data items and allowing indefinite-length maps and arrays could reduce memory requirements.",
      "zh-CHS": "对于所有映射和数组，遵守[RFC7049]第3.9节中给出的最后两条规则将不可接受地限制实现——例如，在受限环境中实时数据采集的用例中，在Q/R数据项之后输出块表并允许无限长映射和数组可以减少内存需求。"
    },
    {
      "indent": 3,
      "text": "It is recommended that implementations that have fundamental restrictions on what data fields they can collect SHOULD always store hints with the bits unset for those fields, i.e., they unambiguously indicate that those data fields will be omitted from captured C-DNS.",
      "zh-CHS": "建议对可收集的数据字段有基本限制的实现应始终存储未设置这些字段位的提示，即，它们明确指示将从捕获的C-DNS中忽略这些数据字段。"
    },
    {
      "indent": 0,
      "text": "11.1. Optional Data",
      "section_title": true,
      "zh-CHS": "11.1. 可选数据"
    },
    {
      "indent": 3,
      "text": "When decoding C-DNS data, some of the items required for a particular function that the consumer wishes to perform may be missing. Consumers should consider providing configurable default values to be used in place of the missing values in their output.",
      "zh-CHS": "当解码C-DNS数据时，消费者希望执行的特定功能所需的一些项目可能丢失。消费者应该考虑提供可配置的默认值来代替其输出中的缺失值。"
    },
    {
      "indent": 0,
      "text": "11.2. Trailing Bytes",
      "section_title": true,
      "zh-CHS": "11.2. 尾随字节"
    },
    {
      "indent": 3,
      "text": "A DNS Query message in a UDP or TCP payload can be followed by some additional (spurious) bytes, which are not stored in C-DNS.",
      "zh-CHS": "UDP或TCP有效负载中的DNS查询消息后面可以跟一些附加（虚假）字节，这些字节不存储在C-DNS中。"
    },
    {
      "indent": 3,
      "text": "When DNS traffic is sent over TCP, each message is prefixed with a two-byte length field, which gives the message length, excluding the two-byte length field. In this context, trailing bytes can occur in two circumstances, with different results:",
      "zh-CHS": "当DNS通信通过TCP发送时，每条消息的前缀都是一个双字节长度字段，该字段给出消息长度，不包括双字节长度字段。在此上下文中，尾随字节可能出现在两种情况下，结果不同："
    },
    {
      "indent": 3,
      "text": "1. The number of bytes consumed by fully parsing the message is less than the number of bytes given in the length field (i.e., the length field is incorrect and too large). In this case, the surplus bytes are considered trailing bytes in a manner analogous to UDP and recorded as such. If only this case occurs, it is possible to process a packet containing multiple DNS messages where one or more have trailing bytes.",
      "zh-CHS": "1. 完全解析消息所消耗的字节数小于长度字段中给定的字节数（即，长度字段不正确且太大）。在这种情况下，多余的字节被视为以类似于UDP的方式的尾随字节，并被记录为尾随字节。如果仅发生这种情况，则可以处理包含多个DNS消息的数据包，其中一个或多个DNS消息具有尾随字节。"
    },
    {
      "indent": 3,
      "text": "2. There are surplus bytes between the end of a well-formed message and the start of the length field for the next message. In this case, the first of the surplus bytes will be processed as the first byte of the next length field, and parsing will proceed from there, almost certainly leading to the next and any subsequent messages in the packet being considered malformed. This will not generate a trailing-bytes record for the processed well-formed message.",
      "zh-CHS": "2. 格式良好的消息的结尾和下一条消息的长度字段的开头之间有多余的字节。在这种情况下，剩余字节中的第一个字节将被处理为下一个长度字段的第一个字节，解析将从那里开始，几乎可以肯定会导致数据包中的下一个和任何后续消息被视为格式错误。这不会为已处理的格式良好的消息生成尾随字节记录。"
    },
    {
      "indent": 0,
      "text": "11.3. Limiting Collection of RDATA",
      "section_title": true,
      "zh-CHS": "11.3. 限制RDATA的收集"
    },
    {
      "indent": 3,
      "text": "Implementations should consider providing a configurable maximum RDATA size for captures -- for example, to avoid memory issues when confronted with large zone transfer records.",
      "zh-CHS": "实现应该考虑为捕获提供可配置的最大RDATA大小，例如，在面对大区域传输记录时，避免内存问题。"
    },
    {
      "indent": 0,
      "text": "11.4. Timestamps",
      "section_title": true,
      "zh-CHS": "11.4. 时间标记"
    },
    {
      "indent": 3,
      "text": "The preamble to each block includes a timestamp of the earliest record in the Block. As described in Section 7.3.2.1, the timestamp is an array of two unsigned integers. The first is a POSIX \"time_t\" [posix-time]. Consumers of C-DNS should be aware of this, as it excludes leap seconds and therefore may cause minor anomalies in the data, e.g., when calculating Query throughput.",
      "zh-CHS": "每个块的前导包括块中最早记录的时间戳。如第7.3.2.1节所述，时间戳是两个无符号整数的数组。第一个是POSIX“时间”[POSIX时间]。C-DNS的使用者应该意识到这一点，因为它不包括闰秒，因此可能会导致数据出现轻微异常，例如，在计算查询吞吐量时。"
    },
    {
      "indent": 0,
      "text": "12. IANA Considerations",
      "section_title": true,
      "zh-CHS": "12. IANA考虑"
    },
    {
      "indent": 3,
      "text": "IANA has created a registry \"C-DNS DNS Capture Format\" containing the subregistries defined in Sections 12.1 to 12.4 inclusive.",
      "zh-CHS": "IANA已创建一个注册表“C-DNS DNS捕获格式”，其中包含第12.1节至第12.4节（含第12.1节）中定义的子区域。"
    },
    {
      "indent": 3,
      "text": "In all cases, new entries may be added to the subregistries by Expert Review as defined in [RFC8126]. Experts are expected to exercise their own expert judgment and should consider the following general guidelines in addition to any provided guidelines that are particular to a subregistry.",
      "zh-CHS": "在所有情况下，可通过[RFC8126]中定义的专家评审将新条目添加到次区域。专家预计将行使自己的专家判断，并应考虑以下一般准则，除了任何提供的指导方针，特别是一个子注册。"
    },
    {
      "indent": 3,
      "text": "o There should be a real and compelling use for any new value.",
      "zh-CHS": "o 对于任何新的价值，都应该有一个真正的、令人信服的用途。"
    },
    {
      "indent": 3,
      "text": "o Values assigned should be carefully chosen to minimize storage requirements for common cases.",
      "zh-CHS": "o 应仔细选择分配的值，以尽量减少常见情况下的存储要求。"
    },
    {
      "indent": 0,
      "text": "12.1. Transport Types",
      "section_title": true,
      "zh-CHS": "12.1. 运输类型"
    },
    {
      "indent": 3,
      "text": "IANA has created a registry \"C-DNS Transports\" of C-DNS transport type identifiers. The primary purpose of this registry is to provide unique identifiers for all transports used for DNS Queries.",
      "zh-CHS": "IANA已创建C-DNS传输类型标识符的“C-DNS传输”注册表。此注册表的主要目的是为用于DNS查询的所有传输提供唯一标识符。"
    },
    {
      "indent": 3,
      "text": "The following note is included in this registry: \"In version 1.0 of C-DNS [RFC8618], there is a field to identify the type of DNS transport. This field is 4 bits in size.\"",
      "zh-CHS": "此注册表中包含以下注释：“在C-DNS[RFC8618]的1.0版中，有一个字段用于标识DNS传输的类型。此字段的大小为4位。”"
    },
    {
      "indent": 3,
      "text": "The initial contents of the registry are as follows. See Sections 7.3.2.3.2, 7.3.2.3.5, and 7.3.2.5 of this document:",
      "zh-CHS": "登记处的初步内容如下。见本文件第7.3.2.3.2、7.3.2.3.5和7.3.2.5节："
    },
    {
      "indent": 12,
      "text": "+------------+------------------------+-----------+\n| Identifier | Name                   | Reference |\n+------------+------------------------+-----------+\n|     0      | UDP                    | RFC 8618  |\n|     1      | TCP                    | RFC 8618  |\n|     2      | TLS                    | RFC 8618  |\n|     3      | DTLS                   | RFC 8618  |\n|     4      | HTTPS                  | RFC 8618  |\n|    5-14    | Unassigned             |           |\n|     15     | Non-standard transport | RFC 8618  |\n+------------+------------------------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Expert reviewers should take the following point into consideration: Is the requested DNS transport described by a Standards Track RFC?",
      "zh-CHS": "专家评审员应考虑以下几点：请求的DNS传输是否由标准跟踪RFC描述？"
    },
    {
      "indent": 0,
      "text": "12.2. Data Storage Flags",
      "section_title": true,
      "zh-CHS": "12.2. 数据存储标志"
    },
    {
      "indent": 3,
      "text": "IANA has created a registry \"C-DNS Storage Flags\" of C-DNS data storage flags. The primary purpose of this registry is to provide indicators giving hints on processing of the data stored.",
      "zh-CHS": "IANA已创建C-DNS数据存储标志的注册表“C-DNS存储标志”。此注册表的主要目的是提供指示符，提示处理存储的数据。"
    },
    {
      "indent": 3,
      "text": "The following note is included in this registry: \"In version 1.0 of C-DNS [RFC8618], there is a field describing attributes of the data recorded. The field is a CBOR [RFC7049] unsigned integer holding bit flags.\"",
      "zh-CHS": "此注册表中包含以下注释：“在C-DNS[RFC8618]的1.0版中，有一个字段描述记录的数据属性。该字段是一个CBOR[RFC7049]无符号整数，包含位标志。”"
    },
    {
      "indent": 3,
      "text": "The initial contents of the registry are as follows. See Section 7.3.1.1.1 of this document:",
      "zh-CHS": "登记处的初步内容如下。见本文件第7.3.1.1.1节："
    },
    {
      "indent": 3,
      "text": "+------+------------------+-----------------------------+-----------+\n| Bit  | Name             | Description                 | Reference |\n+------+------------------+-----------------------------+-----------+\n|  0   | anonymized-data  | The data has been           | RFC 8618  |\n|      |                  | anonymized.                 |           |\n|      |                  |                             |           |\n|  1   | sampled-data     | The data is sampled data.   | RFC 8618  |\n|      |                  |                             |           |\n|  2   | normalized-names | Names in the data have been | RFC 8618  |\n|      |                  | normalized.                 |           |\n|      |                  |                             |           |\n| 3-63 | Unassigned       |                             |           |\n+------+------------------+-----------------------------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "12.3. Response-Processing Flags",
      "section_title": true,
      "zh-CHS": "12.3. 响应处理标志"
    },
    {
      "indent": 3,
      "text": "IANA has created a registry \"C-DNS Response Flags\" of C-DNS response-processing flags. The primary purpose of this registry is to provide indicators giving hints on the generation of a particular Response.",
      "zh-CHS": "IANA已创建C-DNS响应处理标志的注册表“C-DNS响应标志”。此注册表的主要目的是提供指标，提示生成特定响应。"
    },
    {
      "indent": 3,
      "text": "The following note is included in this registry: \"In version 1.0 of C-DNS [RFC8618], there is a field describing attributes of the Responses recorded. The field is a CBOR [RFC7049] unsigned integer holding bit flags.\"",
      "zh-CHS": "此注册表中包含以下注释：“在C-DNS[RFC8618]的1.0版中，有一个字段描述记录的响应的属性。该字段是一个包含位标志的CBOR[RFC7049]无符号整数。”"
    },
    {
      "indent": 3,
      "text": "The initial contents of the registry are as follows. See Section 7.3.2.4.1 of this document:",
      "zh-CHS": "登记处的初步内容如下。见本文件第7.3.2.4.1节："
    },
    {
      "indent": 5,
      "text": "+------+------------+-------------------------------+-----------+\n| Bit  | Name       | Description                   | Reference |\n+------+------------+-------------------------------+-----------+\n|  0   | from-cache | The Response came from cache. | RFC 8618  |\n| 1-63 | Unassigned |                               |           |\n+------+------------+-------------------------------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "12.4. AddressEvent Types",
      "section_title": true,
      "zh-CHS": "12.4. AddressEvent类型"
    },
    {
      "indent": 3,
      "text": "IANA has created a registry \"C-DNS Address Event Types\" of C-DNS AddressEvent types. The primary purpose of this registry is to provide unique identifiers of different types of C-DNS address events and so specify the contents of the optional companion field \"ae-code\" for each type.",
      "zh-CHS": "IANA已创建C-DNS地址事件类型的注册表“C-DNS地址事件类型”。此注册表的主要目的是提供不同类型的C-DNS地址事件的唯一标识符，从而为每种类型指定可选伴随字段“ae代码”的内容。"
    },
    {
      "indent": 3,
      "text": "The following note is included in this registry: \"In version 1.0 of C-DNS [RFC8618], there is a field identifying types of the events related to client addresses. This field is a CBOR [RFC7049] unsigned integer. There is a related optional field \"ae-code\", which, if present, holds an additional CBOR unsigned integer giving additional information specific to the event type.\"",
      "zh-CHS": "此注册表中包含以下注释：“在C-DNS[RFC8618]的1.0版中，有一个字段标识与客户端地址相关的事件类型。该字段是CBOR[RFC7049]无符号整数。有一个相关的可选字段“ae代码”，它（如果存在）包含一个附加的CBOR无符号整数，提供特定于事件类型的附加信息"
    },
    {
      "indent": 3,
      "text": "The initial contents of the registry are as follows. See Section 7.3.2.5 of this document:",
      "zh-CHS": "登记处的初步内容如下。见本文件第7.3.2.5节："
    },
    {
      "indent": 3,
      "text": "+------------------------+---------------+--------------+-----------+\n|       Identifier       | Event Type    | ae-code      | Reference |\n|                        |               | Contents     |           |\n+------------------------+---------------+--------------+-----------+\n|           0            | TCP reset     | None         | RFC 8618  |\n|                        |               |              |           |\n|           1            | ICMP time     | ICMP code    | RFC 8618  |\n|                        | exceeded      | [icmpcodes]  |           |\n|                        |               |              |           |\n|           2            | ICMP          | ICMP code    | RFC 8618  |\n|                        | destination   | [icmpcodes]  |           |\n|                        | unreachable   |              |           |\n|                        |               |              |           |\n|           3            | ICMPv6 time   | ICMPv6 code  | RFC 8618  |\n|                        | exceeded      | [icmp6codes] |           |\n|                        |               |              |           |\n|           4            | ICMPv6        | ICMPv6 code  | RFC 8618  |\n|                        | destination   | [icmp6codes] |           |\n|                        | unreachable   |              |           |\n|                        |               |              |           |\n|           5            | ICMPv6 packet | ICMPv6 code  | RFC 8618  |\n|                        | too big       | [icmp6codes] |           |\n|                        |               |              |           |\n| 6-18446744073709551615 | Unassigned    |              |           |\n+------------------------+---------------+--------------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Expert reviewers should take the following point into consideration: \"ae-code\" contents must be defined for a type or, if not appropriate, specified as \"None\". A specification of \"None\" requires less storage and is therefore preferred.",
      "zh-CHS": "专家评审员应考虑以下几点：“ae代码”内容必须针对某一类型进行定义，如果不合适，则指定为“无”。“无”规格需要较少的存储空间，因此是首选。"
    },
    {
      "indent": 0,
      "text": "13. Security Considerations",
      "section_title": true,
      "zh-CHS": "13. 安全考虑"
    },
    {
      "indent": 3,
      "text": "Any control interface MUST perform authentication and encryption.",
      "zh-CHS": "任何控制接口都必须执行身份验证和加密。"
    },
    {
      "indent": 3,
      "text": "Any data upload MUST be authenticated and encrypted.",
      "zh-CHS": "任何数据上传都必须经过身份验证和加密。"
    },
    {
      "indent": 0,
      "text": "14. Privacy Considerations",
      "section_title": true,
      "zh-CHS": "14. 隐私考虑"
    },
    {
      "indent": 3,
      "text": "Storage of DNS traffic by operators in PCAP and other formats is a long-standing and widespread practice. Section 2.5 of [DNS-Priv-Cons] provides an analysis of the risks to Internet users regarding the storage of DNS traffic data in servers (recursive resolvers, authoritative servers, and rogue servers).",
      "zh-CHS": "运营商以PCAP和其他格式存储DNS流量是一种长期且广泛的做法。[DNS Priv Cons]第2.5节分析了互联网用户在服务器（递归解析程序、权威服务器和恶意服务器）中存储DNS流量数据的风险。"
    },
    {
      "indent": 3,
      "text": "Section 5.2 of [DNS-Priv-Svc] describes mitigations for those risks for data stored on recursive resolvers (but that could by extension apply to authoritative servers). These include data-handling practices and methods for data minimization, IP address pseudonymization, and anonymization. Appendix C of [DNS-Priv-Svc] presents an analysis of seven published anonymization processes. In addition, the ICANN Root Server System Advisory Committee (RSSAC) have recently published [RSSAC04] (\"Recommendations on Anonymization Processes for Source IP Addresses Submitted for Future Analysis\").",
      "zh-CHS": "[DNS Priv Svc]的第5.2节描述了存储在递归解析器上的数据的风险缓解措施（但扩展后，这可能适用于权威服务器）。其中包括数据处理实践和数据最小化、IP地址假名化和匿名化方法。[DNS Priv Svc]的附录C对七个已发布的匿名化过程进行了分析。此外，ICANN根服务器系统咨询委员会（RSSAC）最近发布了[RSSAC04]（“提交供未来分析的源IP地址匿名化过程建议”）。"
    },
    {
      "indent": 3,
      "text": "The above analyses consider full data capture (e.g., using PCAP) as a baseline for privacy considerations; therefore, this format specification introduces no new user privacy issues beyond those of full data capture (which are quite severe). It does provide mechanisms to selectively record only certain fields at the time of data capture, to improve user privacy and to explicitly indicate that data is sampled, anonymized, or both. It also provides flags to indicate if data normalization has been performed; data normalization increases user privacy by reducing the potential for fingerprinting individuals. However, a trade-off is the potential reduction of the capacity to identify attack traffic via Query name signatures. Operators should carefully consider their operational requirements and privacy policies and SHOULD capture at the source the minimum user data required to meet their needs.",
      "zh-CHS": "上述分析考虑全数据捕获（例如，使用pCAP）作为隐私考虑的基线；因此，除了完整数据捕获（非常严重）之外，此格式规范不会引入任何新的用户隐私问题。它确实提供了在数据捕获时仅选择性地记录某些字段的机制，以改善用户隐私，并明确指出数据是采样的、匿名的或两者兼而有之。它还提供标志来指示是否执行了数据规范化；数据规范化通过降低对个人进行指纹识别的可能性来提高用户隐私。然而，一个折衷方案是，通过查询名称签名识别攻击流量的能力可能会降低。运营商应仔细考虑其运营需求和隐私政策，并应在源头捕获满足用户需求所需的最小用户数据。"
    },
    {
      "indent": 0,
      "text": "15. References",
      "section_title": true,
      "zh-CHS": "15. 工具书类"
    },
    {
      "indent": 0,
      "text": "15.1. Normative References",
      "section_title": true,
      "zh-CHS": "15.1. 规范性引用文件"
    },
    {
      "indent": 3,
      "text": "[pcap-filter] tcpdump.org, \"Manpage of PCAP-FILTER\", November 2017, <https://www.tcpdump.org/manpages/pcap-filter.7.html>.",
      "zh-CHS": "[pcap filter]tcpdump.org，“pcap-filter手册”，2017年11月<https://www.tcpdump.org/manpages/pcap-filter.7.html>."
    },
    {
      "indent": 3,
      "text": "[pcap-options] tcpdump.org, \"Manpage of PCAP\", July 2018, <https://www.tcpdump.org/manpages/pcap.3pcap.html>.",
      "zh-CHS": "[pcap选项]tcpdump.org，“pcap手册”，2018年7月<https://www.tcpdump.org/manpages/pcap.3pcap.html>."
    },
    {
      "indent": 3,
      "text": "[posix-time] The Open Group, \"IEEE Standard for Information Technology--Portable Operating System Interface (POSIX(R)) Base Specifications, Issue 7\", IEEE Standard 1003.1-2017, Section 4.16, DOI 10.1109/IEEESTD.2018.8277153.",
      "zh-CHS": "[posix time]开放组，“IEEE信息技术标准——便携式操作系统接口（posix（R））基本规范，第7期”，IEEE标准1003.1-2017，第4.16节，DOI 10.1109/IEEESTD.2018.8277153。"
    },
    {
      "indent": 3,
      "text": "[RFC792] Postel, J., \"Internet Control Message Protocol\", STD 5, RFC 792, DOI 10.17487/RFC0792, September 1981, <https://www.rfc-editor.org/info/rfc792>.",
      "zh-CHS": "[RFC792]Postel，J.，“互联网控制消息协议”，STD 5，RFC 792，DOI 10.17487/RFC0792，1981年9月<https://www.rfc-editor.org/info/rfc792>."
    },
    {
      "indent": 3,
      "text": "[RFC1035] Mockapetris, P., \"Domain names - implementation and specification\", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987, <https://www.rfc-editor.org/info/rfc1035>.",
      "zh-CHS": "[RFC1035]Mockapetris，P.，“域名-实现和规范”，STD 13，RFC 1035，DOI 10.17487/RFC1035，1987年11月<https://www.rfc-editor.org/info/rfc1035>."
    },
    {
      "indent": 3,
      "text": "[RFC2119] Bradner, S., \"Key words for use in RFCs to Indicate Requirement Levels\", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, <https://www.rfc-editor.org/info/rfc2119>.",
      "zh-CHS": "[RFC2119]Bradner，S.，“RFC中用于表示需求水平的关键词”，BCP 14，RFC 2119，DOI 10.17487/RFC2119，1997年3月<https://www.rfc-editor.org/info/rfc2119>."
    },
    {
      "indent": 3,
      "text": "[RFC3986] Berners-Lee, T., Fielding, R., and L. Masinter, \"Uniform Resource Identifier (URI): Generic Syntax\", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005, <https://www.rfc-editor.org/info/rfc3986>.",
      "zh-CHS": "[RFC3986]Berners Lee，T.，Fielding，R.，和L.Masinter，“统一资源标识符（URI）：通用语法”，STD 66，RFC 3986，DOI 10.17487/RFC3986，2005年1月<https://www.rfc-editor.org/info/rfc3986>."
    },
    {
      "indent": 3,
      "text": "[RFC4443] Conta, A., Deering, S., and M. Gupta, Ed., \"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification\", STD 89, RFC 4443, DOI 10.17487/RFC4443, March 2006, <https://www.rfc-editor.org/info/rfc4443>.",
      "zh-CHS": "[RFC4443]Conta，A.，Deering，S.和M.Gupta，Ed.“互联网协议版本6（IPv6）规范的互联网控制消息协议（ICMPv6）”，STD 89，RFC 4443，DOI 10.17487/RFC4443，2006年3月<https://www.rfc-editor.org/info/rfc4443>."
    },
    {
      "indent": 3,
      "text": "[RFC6891] Damas, J., Graff, M., and P. Vixie, \"Extension Mechanisms for DNS (EDNS(0))\", STD 75, RFC 6891, DOI 10.17487/RFC6891, April 2013, <https://www.rfc-editor.org/info/rfc6891>.",
      "zh-CHS": "[RFC6891]Damas，J.，Graff，M.，和P.Vixie，“DNS的扩展机制（EDNS（0）），STD 75，RFC 6891，DOI 10.17487/RFC68911913年4月<https://www.rfc-editor.org/info/rfc6891>."
    },
    {
      "indent": 3,
      "text": "[RFC7049] Bormann, C. and P. Hoffman, \"Concise Binary Object Representation (CBOR)\", RFC 7049, DOI 10.17487/RFC7049, October 2013, <https://www.rfc-editor.org/info/rfc7049>.",
      "zh-CHS": "[RFC7049]Bormann，C.和P.Hoffman，“简明二进制对象表示法（CBOR）”，RFC 7049，DOI 10.17487/RFC7049，2013年10月<https://www.rfc-editor.org/info/rfc7049>."
    },
    {
      "indent": 3,
      "text": "[RFC7858] Hu, Z., Zhu, L., Heidemann, J., Mankin, A., Wessels, D., and P. Hoffman, \"Specification for DNS over Transport Layer Security (TLS)\", RFC 7858, DOI 10.17487/RFC7858, May 2016, <https://www.rfc-editor.org/info/rfc7858>.",
      "zh-CHS": "[RFC7858]Hu，Z.，Zhu，L.，Heidemann，J.，Mankin，A.，Wessels，D.，和P.Hoffman，“DNS传输层安全规范（TLS）”，RFC 7858，DOI 10.17487/RFC7858，2016年5月<https://www.rfc-editor.org/info/rfc7858>."
    },
    {
      "indent": 3,
      "text": "[RFC8094] Reddy, T., Wing, D., and P. Patil, \"DNS over Datagram Transport Layer Security (DTLS)\", RFC 8094, DOI 10.17487/RFC8094, February 2017, <https://www.rfc-editor.org/info/rfc8094>.",
      "zh-CHS": "[RFC8094]Reddy，T.，Wing，D.，和P.Patil，“数据报传输层安全（DTLS）上的DNS”，RFC 8094，DOI 10.17487/RFC8094，2017年2月<https://www.rfc-editor.org/info/rfc8094>."
    },
    {
      "indent": 3,
      "text": "[RFC8126] Cotton, M., Leiba, B., and T. Narten, \"Guidelines for Writing an IANA Considerations Section in RFCs\", BCP 26, RFC 8126, DOI 10.17487/RFC8126, June 2017, <https://www.rfc-editor.org/info/rfc8126>.",
      "zh-CHS": "[RFC8126]Cotton，M.，Leiba，B.，和T.Narten，“在RFC中编写IANA考虑事项部分的指南”，BCP 26，RFC 8126，DOI 10.17487/RFC8126，2017年6月<https://www.rfc-editor.org/info/rfc8126>."
    },
    {
      "indent": 3,
      "text": "[RFC8174] Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017, <https://www.rfc-editor.org/info/rfc8174>.",
      "zh-CHS": "[RFC8174]Leiba，B.，“RFC 2119关键词中大写与小写的歧义”，BCP 14，RFC 8174，DOI 10.17487/RFC8174，2017年5月<https://www.rfc-editor.org/info/rfc8174>."
    },
    {
      "indent": 3,
      "text": "[RFC8484] Hoffman, P. and P. McManus, \"DNS Queries over HTTPS (DoH)\", RFC 8484, DOI 10.17487/RFC8484, October 2018, <https://www.rfc-editor.org/info/rfc8484>.",
      "zh-CHS": "[RFC8484]Hoffman，P.和P.McManus，“HTTPS（DoH）上的DNS查询”，RFC 8484，DOI 10.17487/RFC8484，2018年10月<https://www.rfc-editor.org/info/rfc8484>."
    },
    {
      "indent": 3,
      "text": "[RFC8610] Birkholz, H., Vigano, C., and C. Bormann, \"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures\", RFC 8610, DOI 10.17487/RFC8610, June 2019, <https://www.rfc-editor.org/info/rfc8610>.",
      "zh-CHS": "[RFC8610]Birkholz，H.，Vigano，C.，和C.Bormann，“简明数据定义语言（CDDL）：表示简明二进制对象表示（CBOR）和JSON数据结构的符号约定”，RFC 8610，DOI 10.17487/RFC8610，2019年6月<https://www.rfc-editor.org/info/rfc8610>."
    },
    {
      "indent": 0,
      "text": "15.2. Informative References",
      "section_title": true,
      "zh-CHS": "15.2. 资料性引用"
    },
    {
      "indent": 3,
      "text": "[Avro] The Apache Software Foundation, \"Apache Avro(TM)\", 2019, <https://avro.apache.org/>.",
      "zh-CHS": "[Avro ] Apache软件基金会，“Apache AVro（TM）”，2019，<https://avro.apache.org/>."
    },
    {
      "indent": 3,
      "text": "[ditl] DNS-OARC, \"DITL\", 2018, <https://www.dns-oarc.net/oarc/data/ditl>.",
      "zh-CHS": "[ditl]DNS-OARC，“ditl”，2018年<https://www.dns-oarc.net/oarc/data/ditl>."
    },
    {
      "indent": 3,
      "text": "[DNS-Priv-Cons] Bortzmeyer, S. and S. Dickinson, \"DNS Privacy Considerations\", Work in Progress, draft-ietf-dprive-rfc7626-bis-00, July 2019.",
      "zh-CHS": "[DNS隐私权]Bortzmeyer，S.和S.Dickinson，“DNS隐私注意事项”，正在进行中的工作，草案-ietf-dprive-rfc7626-bis-00，2019年7月。"
    },
    {
      "indent": 3,
      "text": "[DNS-Priv-Svc] Dickinson, S., Overeinder, B., van Rijswijk-Deij, R., and A. Mankin, \"Recommendations for DNS Privacy Service Operators\", Work in Progress, draft-ietf-dprive-bcp-op-03, July 2019.",
      "zh-CHS": "[DNS Priv Svc]Dickinson，S.，Overfinder，B.，van Rijswijk Deij，R.，和A.Mankin，“DNS隐私服务运营商建议”，正在进行中的工作，草案-ietf-dprive-bcp-op-032019年7月。"
    },
    {
      "indent": 3,
      "text": "[dnscap] DNS-OARC, \"DNSCAP\", 2018, <https://www.dns-oarc.net/tools/dnscap>.",
      "zh-CHS": "[dnscap]DNS-OARC，“dnscap”，2018年<https://www.dns-oarc.net/tools/dnscap>."
    },
    {
      "indent": 3,
      "text": "[dnstap] \"dnstap\", 2016, <https://dnstap.info/>.",
      "zh-CHS": "[dnstap]“dnstap”，2016年<https://dnstap.info/>."
    },
    {
      "indent": 3,
      "text": "[dnstap-schema] \"dnstap schema\", commit d860ec1, November 2016, <https://github.com/dnstap/dnstap.pb/blob/master/ dnstap.proto>.",
      "zh-CHS": "[dnstap模式]“dnstap模式”，提交D860EC12016年11月<https://github.com/dnstap/dnstap.pb/blob/master/ dnstap.proto>。"
    },
    {
      "indent": 3,
      "text": "[dnsxml] Daley, J., Ed., Morris, S., and J. Dickinson, \"dnsxml - A standard XML representation of DNS data\", Work in Progress, draft-daley-dnsxml-00, July 2013.",
      "zh-CHS": "[dnsxml]Daley，J.，Ed.，Morris，S.，和J.Dickinson，“dnsxml-DNS数据的标准XML表示”，正在进行的工作，草稿-Daley-dnsxml-00，2013年7月。"
    },
    {
      "indent": 3,
      "text": "[dsc] Wessels, D. and J. Lundstrom, \"DSC\", 2016, <https://www.dns-oarc.net/tools/dsc>.",
      "zh-CHS": "[dsc]Wessels，D.和J.Lundstrom，“dsc”，2016年<https://www.dns-oarc.net/tools/dsc>."
    },
    {
      "indent": 3,
      "text": "[gzip] \"gzip\", <https://www.gzip.org/>.",
      "zh-CHS": "[gzip]“gzip”<https://www.gzip.org/>."
    },
    {
      "indent": 3,
      "text": "[icmp6codes] IANA, \"ICMPv6 \"Code\" Fields\", <https://www.iana.org/assignments/icmpv6-parameters/>.",
      "zh-CHS": "[icmp6codes]IANA，“ICMPv6”代码“字段”<https://www.iana.org/assignments/icmpv6-parameters/>."
    },
    {
      "indent": 3,
      "text": "[icmpcodes] IANA, \"Code Fields\", <https://www.iana.org/assignments/icmp-parameters/>.",
      "zh-CHS": "[icmpcodes]IANA，“代码字段”<https://www.iana.org/assignments/icmp-parameters/>."
    },
    {
      "indent": 3,
      "text": "[IEEE802.1Q] IEEE, \"IEEE Standard for Local and Metropolitan Area Networks--Bridges and Bridged Networks\", IEEE Standard 802.1Q.",
      "zh-CHS": "[IEEE802.1Q]IEEE，“局域网和城域网的IEEE标准——网桥和桥接网络”，IEEE标准802.1Q。"
    },
    {
      "indent": 3,
      "text": "[Knot] \"Knot DNS\", <https://www.knot-dns.cz/>.",
      "zh-CHS": "[结]“结DNS”<https://www.knot-dns.cz/>."
    },
    {
      "indent": 3,
      "text": "[lz4] \"LZ4\", <https://lz4.github.io/lz4/>.",
      "zh-CHS": "[lz4]“lz4”<https://lz4.github.io/lz4/>."
    },
    {
      "indent": 3,
      "text": "[mmark] Gieben, M., \"mmark\", commit de69698, May 2019, <https://github.com/mmarkdown/mmark>.",
      "zh-CHS": "[mmark]Gieben，M.，“mmark”，提交日期：2019年5月，第69698号<https://github.com/mmarkdown/mmark>."
    },
    {
      "indent": 3,
      "text": "[NSD] NLnet Labs, \"NSD\", 2019, <https://www.nlnetlabs.nl/projects/nsd/about/>.",
      "zh-CHS": "[NSD]NLnet实验室，“NSD”，2019年<https://www.nlnetlabs.nl/projects/nsd/about/>."
    },
    {
      "indent": 3,
      "text": "[opcodes] IANA, \"DNS OpCodes\", <https://www.iana.org/assignments/dns-parameters/>.",
      "zh-CHS": "[操作码]IANA，“DNS操作码”<https://www.iana.org/assignments/dns-parameters/>."
    },
    {
      "indent": 3,
      "text": "[packetq] .SE - The Internet Infrastructure Foundation, \"PacketQ\", commit c9b2e89, February 2019, <https://github.com/DNS-OARC/PacketQ>.",
      "zh-CHS": "Se-互联网基础设施“PACETETQ”，提交C9B2E89C，2019年2月，<https://github.com/DNS-OARC/PacketQ>."
    },
    {
      "indent": 3,
      "text": "[pcap] \"PCAP\", 2019, <https://www.tcpdump.org/>.",
      "zh-CHS": "[pcap]“pcap”，2019年<https://www.tcpdump.org/>."
    },
    {
      "indent": 3,
      "text": "[pcapng] \"pcapng: PCAP next generation file format specification\", commit 3c35b6a, March 2019, <https://github.com/pcapng/pcapng>.",
      "zh-CHS": "[pcapng]“pcapng:PCAP下一代文件格式规范”，提交3c35b6a，2019年3月<https://github.com/pcapng/pcapng>."
    },
    {
      "indent": 3,
      "text": "[Protocol-Buffers] Google LLC, \"Protocol Buffers\", <https://developers.google.com/protocol-buffers/>.",
      "zh-CHS": "[协议缓冲区]谷歌有限责任公司，“协议缓冲区”<https://developers.google.com/protocol-buffers/>."
    },
    {
      "indent": 3,
      "text": "[rcodes] IANA, \"DNS RCODEs\", <https://www.iana.org/assignments/dns-parameters/>.",
      "zh-CHS": "[rcodes]IANA，“DNS rcodes”<https://www.iana.org/assignments/dns-parameters/>."
    },
    {
      "indent": 3,
      "text": "[RFC5077] Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, \"Transport Layer Security (TLS) Session Resumption without Server-Side State\", RFC 5077, DOI 10.17487/RFC5077, January 2008, <https://www.rfc-editor.org/info/rfc5077>.",
      "zh-CHS": "[RFC5077]Salowey，J.，Zhou，H.，Eronen，P.，和H.Tschofenig，“无服务器端状态的传输层安全（TLS）会话恢复”，RFC 5077，DOI 10.17487/RFC5077，2008年1月<https://www.rfc-editor.org/info/rfc5077>."
    },
    {
      "indent": 3,
      "text": "[RFC7413] Cheng, Y., Chu, J., Radhakrishnan, S., and A. Jain, \"TCP Fast Open\", RFC 7413, DOI 10.17487/RFC7413, December 2014, <https://www.rfc-editor.org/info/rfc7413>.",
      "zh-CHS": "[RFC7413]Cheng，Y.，Chu，J.，Radhakrishnan，S.，和A.Jain，“TCP快速开放”，RFC 7413，DOI 10.17487/RFC74132014年12月<https://www.rfc-editor.org/info/rfc7413>."
    },
    {
      "indent": 3,
      "text": "[RFC8259] Bray, T., Ed., \"The JavaScript Object Notation (JSON) Data Interchange Format\", STD 90, RFC 8259, DOI 10.17487/RFC8259, December 2017, <https://www.rfc-editor.org/info/rfc8259>.",
      "zh-CHS": "[RFC8259]Bray，T.，Ed.“JavaScript对象表示法（JSON）数据交换格式”，STD 90，RFC 8259，DOI 10.17487/RFC8259，2017年12月<https://www.rfc-editor.org/info/rfc8259>."
    },
    {
      "indent": 3,
      "text": "[RFC8427] Hoffman, P., \"Representing DNS Messages in JSON\", RFC 8427, DOI 10.17487/RFC8427, July 2018, <https://www.rfc-editor.org/info/rfc8427>.",
      "zh-CHS": "[RFC8427]Hoffman，P.，“用JSON表示DNS消息”，RFC 8427，DOI 10.17487/RFC8427，2018年7月<https://www.rfc-editor.org/info/rfc8427>."
    },
    {
      "indent": 3,
      "text": "[rrclasses] IANA, \"DNS CLASSes\", <https://www.iana.org/assignments/dns-parameters/>.",
      "zh-CHS": "[rrclasses]IANA，“DNS类”<https://www.iana.org/assignments/dns-parameters/>."
    },
    {
      "indent": 3,
      "text": "[rrtypes] IANA, \"Resource Record (RR) TYPEs\", <https://www.iana.org/assignments/dns-parameters/>.",
      "zh-CHS": "[rrtypes]IANA，“资源记录（RR）类型”<https://www.iana.org/assignments/dns-parameters/>."
    },
    {
      "indent": 3,
      "text": "[RSSAC04] ICANN, \"Recommendations on Anonymization Processes for Source IP Addresses Submitted for Future Analysis\", August 2018, <https://www.icann.org/en/system/files/files/ rssac-040-07aug18-en.pdf>.",
      "zh-CHS": "[RSSAC04]ICANN，“提交供未来分析的源IP地址匿名化流程建议”，2018年8月<https://www.icann.org/en/system/files/files/ rssac-040-07aug18-en.pdf>。"
    },
    {
      "indent": 3,
      "text": "[snappy] \"snappy\", <https://google.github.io/snappy/>.",
      "zh-CHS": "[snappy]“snappy”<https://google.github.io/snappy/>."
    },
    {
      "indent": 3,
      "text": "[snzip] \"Snzip, a compression/decompression tool based on snappy\", commit 809c6f2, October 2018, <https://github.com/kubo/snzip>.",
      "zh-CHS": "[snzip]“snzip，一种基于snappy的压缩/解压缩工具”，提交809c6f2，2018年10月<https://github.com/kubo/snzip>."
    },
    {
      "indent": 3,
      "text": "[xz] \"XZ Utils\", <https://tukaani.org/xz/>.",
      "zh-CHS": "[xz] “XZ Utils”<https://tukaani.org/xz/>."
    },
    {
      "indent": 3,
      "text": "[zstd] \"Zstandard - Real-time data compression algorithm\", <https://facebook.github.io/zstd/>.",
      "zh-CHS": "[zstd]“ZS标准-实时数据压缩算法”<https://facebook.github.io/zstd/>."
    },
    {
      "indent": 0,
      "text": "Appendix A. CDDL",
      "section_title": true,
      "zh-CHS": "附录A.CDDL"
    },
    {
      "indent": 3,
      "text": "This appendix gives a CDDL [RFC8610] specification for C-DNS.",
      "zh-CHS": "本附录给出了C-DNS的CDDL[RFC8610]规范。"
    },
    {
      "indent": 3,
      "text": "CDDL does not permit a range of allowed values to be specified for a bitfield. Where necessary, those values are given as a CDDL group, but the group definition is commented out to prevent CDDL tooling from warning that the group is unused.",
      "zh-CHS": "CDDL不允许为位字段指定允许值的范围。必要时，这些值作为CDDL组给出，但组定义被注释掉，以防止CDDL工具警告该组未使用。"
    },
    {
      "indent": 3,
      "text": "; CDDL specification of the file format for C-DNS,\n; which describes a collection of DNS messages and\n; traffic metadata.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; The overall structure of a file.\n;\nFile = [\n    file-type-id  : \"C-DNS\",\n    file-preamble : FilePreamble,\n    file-blocks   : [* Block],\n]",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; The File Preamble.\n;\nFilePreamble = {\n    major-format-version => 1,\n    minor-format-version => 0,\n    ? private-version    => uint,\n    block-parameters     => [+ BlockParameters],\n}\nmajor-format-version = 0\nminor-format-version = 1\nprivate-version      = 2\nblock-parameters     = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "BlockParameters = {\n    storage-parameters      => StorageParameters,\n    ? collection-parameters => CollectionParameters,\n}\nstorage-parameters    = 0\ncollection-parameters = 1",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "IPv6PrefixLength = 1..128 IPv4PrefixLength = 1..32 OpcodeRange = 0..15 RRTypeRange = 0..65535",
      "zh-CHS": "IPv6PrefixLength=1..128 IPv4PrefixLength=1..32操作码范围=0..15 RRTypeRange=0..65535"
    },
    {
      "indent": 5,
      "text": "StorageParameters = {\n    ticks-per-second             => uint,\n    max-block-items              => uint,\n    storage-hints                => StorageHints,\n    opcodes                      => [+ OpcodeRange],\n    rr-types                     => [+ RRTypeRange],\n    ? storage-flags              => StorageFlags,\n    ? client-address-prefix-ipv4 => IPv4PrefixLength,\n    ? client-address-prefix-ipv6 => IPv6PrefixLength,\n    ? server-address-prefix-ipv4 => IPv4PrefixLength,\n    ? server-address-prefix-ipv6 => IPv6PrefixLength,\n    ? sampling-method            => tstr,\n    ? anonymization-method       => tstr,\n}\nticks-per-second           = 0\nmax-block-items            = 1\nstorage-hints              = 2\nopcodes                    = 3\nrr-types                   = 4\nstorage-flags              = 5\nclient-address-prefix-ipv4 = 6\nclient-address-prefix-ipv6 = 7\nserver-address-prefix-ipv4 = 8\nserver-address-prefix-ipv6 = 9\nsampling-method            = 10\nanonymization-method       = 11",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 7,
      "text": "; A hint indicates whether the collection method will always omit\n; the item from the file.\nStorageHints = {\n    query-response-hints           => QueryResponseHints,\n    query-response-signature-hints =>\n        QueryResponseSignatureHints,\n    rr-hints                       => RRHints,\n    other-data-hints               => OtherDataHints,\n}\nquery-response-hints           = 0\nquery-response-signature-hints = 1\nrr-hints                       = 2\nother-data-hints               = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": "QueryResponseHintValues = &(\n    time-offset                  : 0,\n    client-address-index         : 1,\n    client-port                  : 2,\n    transaction-id               : 3,\n    qr-signature-index           : 4,\n    client-hoplimit              : 5,",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": " response-delay : 6, query-name-index : 7, query-size : 8, response-size : 9, response-processing-data : 10, query-question-sections : 11, ; Second & subsequent ; Questions query-answer-sections : 12, query-authority-sections : 13, query-additional-sections : 14, response-answer-sections : 15, response-authority-sections : 16, response-additional-sections : 17, ) QueryResponseHints = uint .bits QueryResponseHintValues",
      "zh-CHS": "响应延迟：6，查询名称索引：7，查询大小：8，响应大小：9，响应处理数据：10，查询问题段：11；第二次及以后；问题查询回答部分：12，查询权限部分：13，查询附加部分：14，响应回答部分：15，响应权限部分：16，响应附加部分：17，）QueryResponseHints=uint.bits QueryResponseHintValues"
    },
    {
      "indent": 9,
      "text": "QueryResponseSignatureHintValues = &(\n    server-address-index  : 0,\n    server-port           : 1,\n    qr-transport-flags    : 2,\n    qr-type               : 3,\n    qr-sig-flags          : 4,\n    query-opcode          : 5,\n    qr-dns-flags          : 6,\n    query-rcode           : 7,\n    query-classtype-index : 8,\n    query-qdcount         : 9,\n    query-ancount         : 10,\n    query-nscount         : 11,\n    query-arcount         : 12,\n    query-edns-version    : 13,\n    query-udp-size        : 14,\n    query-opt-rdata-index : 15,\n    response-rcode        : 16,\n)\nQueryResponseSignatureHints =\n    uint .bits QueryResponseSignatureHintValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": "RRHintValues = &(\n    ttl         : 0,\n    rdata-index : 1,\n)\nRRHints = uint .bits RRHintValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": "OtherDataHintValues = &(\n    malformed-messages   : 0,\n    address-event-counts : 1,\n)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 9,
      "text": "OtherDataHints = uint .bits OtherDataHintValues",
      "zh-CHS": "OtherDataHints=uint.bits OtherDataHintValue"
    },
    {
      "indent": 7,
      "text": "StorageFlagValues = &(\n    anonymized-data      : 0,\n    sampled-data         : 1,\n    normalized-names     : 2,\n)\nStorageFlags = uint .bits StorageFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 4,
      "text": "; Metadata about data collection VLANIdRange = 1..4094",
      "zh-CHS": "; 关于数据收集VLANIdRange=1..4094的元数据"
    },
    {
      "indent": 4,
      "text": "CollectionParameters = {\n     ? query-timeout      => uint,             ; Milliseconds\n     ? skew-timeout       => uint,             ; Microseconds\n     ? snaplen            => uint,\n     ? promisc            => bool,\n     ? interfaces         => [+ tstr],\n     ? server-addresses   => [+ IPAddress],\n     ? vlan-ids           => [+ VLANIdRange],\n     ? filter             => tstr,\n     ? generator-id       => tstr,\n     ? host-id            => tstr,\n }\n query-timeout      = 0\n skew-timeout       = 1\n snaplen            = 2\n promisc            = 3\n interfaces         = 4\n server-addresses   = 5\n vlan-ids           = 6\n filter             = 7\n generator-id       = 8\n host-id            = 9",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; Data in the file is stored in Blocks.\n;\nBlock = {\n    block-preamble          => BlockPreamble,\n    ? block-statistics      => BlockStatistics, ; Much of this\n                                                ; could be derived\n    ? block-tables          => BlockTables,\n    ? query-responses       => [+ QueryResponse],\n    ? address-event-counts  => [+ AddressEventCount],\n    ? malformed-messages    => [+ MalformedMessage],\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "block-preamble = 0 block-statistics = 1 block-tables = 2 query-responses = 3 address-event-counts = 4 malformed-messages = 5",
      "zh-CHS": "块前导码=0块统计数据=1块表=2个查询响应=3个地址事件计数=4个格式错误的消息=5"
    },
    {
      "indent": 3,
      "text": ";\n; The (mandatory) preamble to a Block.\n;\nBlockPreamble = {\n    ? earliest-time          => Timestamp,\n    ? block-parameters-index => uint .default 0,\n}\nearliest-time          = 0\nblock-parameters-index = 1",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "; Ticks are sub-second intervals. The number of ticks in a second is ; file/block metadata. Signed and unsigned tick types are defined. ticks = int uticks = uint",
      "zh-CHS": "; 滴答声是亚秒的间隔。一秒钟内的滴答声数为；文件/块元数据。定义了有符号和无符号记号类型。滴答声=整数=整数"
    },
    {
      "indent": 3,
      "text": "Timestamp = [\n    timestamp-secs   : uint,      ; POSIX time\n    timestamp-ticks  : uticks,\n]",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; Statistics about the Block contents.\n;\nBlockStatistics = {\n    ? processed-messages  => uint,\n    ? qr-data-items       => uint,\n    ? unmatched-queries   => uint,\n    ? unmatched-responses => uint,\n    ? discarded-opcode    => uint,\n    ? malformed-items     => uint,\n}\nprocessed-messages  = 0\nqr-data-items       = 1\nunmatched-queries   = 2\nunmatched-responses = 3\ndiscarded-opcode    = 4\nmalformed-items     = 5",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; Tables of common data referenced from records in a Block.\n;\nBlockTables = {\n    ? ip-address             => [+ IPAddress],\n    ? classtype              => [+ ClassType],\n    ? name-rdata             => [+ bstr],    ; Holds both names\n                                             ; and RDATA\n    ? qr-sig                 => [+ QueryResponseSignature],\n    ? QuestionTables,\n    ? RRTables,\n    ? malformed-message-data => [+ MalformedMessageData],\n}\nip-address             = 0\nclasstype              = 1\nname-rdata             = 2\nqr-sig                 = 3\nqlist                  = 4\nqrr                    = 5\nrrlist                 = 6\nrr                     = 7\nmalformed-message-data = 8",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "IPv4Address = bstr .size (0..4) IPv6Address = bstr .size (0..16) IPAddress = IPv4Address / IPv6Address",
      "zh-CHS": "IPv4Address=bstr.size（0..4）IPv6Address=bstr.size（0..16）IPAddress=IPv4Address/IPv6Address"
    },
    {
      "indent": 3,
      "text": "ClassType = {\n    type  => uint,\n    class => uint,\n}\ntype  = 0\nclass = 1",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "QueryResponseSignature = {\n    ? server-address-index  => uint,\n    ? server-port           => uint,\n    ? qr-transport-flags    => QueryResponseTransportFlags,\n    ? qr-type               => QueryResponseType,\n    ? qr-sig-flags          => QueryResponseFlags,\n    ? query-opcode          => uint,\n    ? qr-dns-flags          => DNSFlags,\n    ? query-rcode           => uint,\n    ? query-classtype-index => uint,\n    ? query-qdcount         => uint,\n    ? query-ancount         => uint,\n    ? query-nscount         => uint,\n    ? query-arcount         => uint,",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "    ? query-edns-version    => uint,\n    ? query-udp-size        => uint,\n    ? query-opt-rdata-index => uint,\n    ? response-rcode        => uint,\n}\nserver-address-index  = 0\nserver-port           = 1\nqr-transport-flags    = 2\nqr-type               = 3\nqr-sig-flags          = 4\nquery-opcode          = 5\nqr-dns-flags          = 6\nquery-rcode           = 7\nquery-classtype-index = 8\nquery-qdcount         = 9\nquery-ancount         = 10\nquery-nscount         = 11\nquery-arcount         = 12\nquery-edns-version    = 13\nquery-udp-size        = 14\nquery-opt-rdata-index = 15\nresponse-rcode        = 16",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "; Transport gives the values that may appear in bits 1..4 of\n; TransportFlags.  There is currently no way to express this in\n; CDDL, so Transport is unused.  To avoid confusion when used\n; with CDDL tools, it is commented out.\n;\n; Transport = &(\n;     udp               : 0,\n;     tcp               : 1,\n;     tls               : 2,\n;     dtls              : 3,\n;     https             : 4,\n;     non-standard      : 15,\n; )",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "TransportFlagValues = &(\n    ip-version         : 0,     ; 0=IPv4, 1=IPv6\n) / (1..4)\nTransportFlags = uint .bits TransportFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "QueryResponseTransportFlagValues = &(\n    query-trailingdata : 5,\n) / TransportFlagValues\nQueryResponseTransportFlags =\n    uint .bits QueryResponseTransportFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "QueryResponseType = &(\n    stub      : 0,\n    client    : 1,\n    resolver  : 2,\n    auth      : 3,\n    forwarder : 4,\n    tool      : 5,\n)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "QueryResponseFlagValues = &(\n    has-query               : 0,\n    has-response            : 1,\n    query-has-opt           : 2,\n    response-has-opt        : 3,\n    query-has-no-question   : 4,\n    response-has-no-question: 5,\n)\nQueryResponseFlags = uint .bits QueryResponseFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "DNSFlagValues = &(\n    query-cd   : 0,\n    query-ad   : 1,\n    query-z    : 2,\n    query-ra   : 3,\n    query-rd   : 4,\n    query-tc   : 5,\n    query-aa   : 6,\n    query-do   : 7,\n    response-cd: 8,\n    response-ad: 9,\n    response-z : 10,\n    response-ra: 11,\n    response-rd: 12,\n    response-tc: 13,\n    response-aa: 14,\n)\nDNSFlags = uint .bits DNSFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "QuestionTables = (\n    qlist => [+ QuestionList],\n    qrr   => [+ Question]\n)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "QuestionList = [+ uint]           ; Index of Question",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Question = {                      ; Second and subsequent Questions\n    name-index      => uint,      ; Index to a name in the\n                                  ; name-rdata table\n    classtype-index => uint,\n}\nname-index      = 0\nclasstype-index = 1",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "RRTables = (\n    rrlist => [+ RRList],\n    rr     => [+ RR]\n)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "RRList = [+ uint]                     ; Index of RR",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "RR = {\n    name-index      => uint,          ; Index to a name in the\n                                      ; name-rdata table\n    classtype-index => uint,\n    ? ttl           => uint,\n    ? rdata-index   => uint,          ; Index to RDATA in the\n                                      ; name-rdata table\n}\n; Other map key values already defined above.\nttl         = 2\nrdata-index = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "MalformedMessageData = {\n    ? server-address-index   => uint,\n    ? server-port            => uint,\n    ? mm-transport-flags     => TransportFlags,\n    ? mm-payload             => bstr,\n}\n; Other map key values already defined above.\nmm-transport-flags      = 2\nmm-payload              = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; A single Query/Response data item.\n;\nQueryResponse = {\n    ? time-offset              => uticks,     ; Time offset from\n                                              ; start of Block\n    ? client-address-index     => uint,\n    ? client-port              => uint,\n    ? transaction-id           => uint,\n    ? qr-signature-index       => uint,\n    ? client-hoplimit          => uint,\n    ? response-delay           => ticks,\n    ? query-name-index         => uint,\n    ? query-size               => uint,       ; DNS size of Query\n    ? response-size            => uint,       ; DNS size of Response\n    ? response-processing-data => ResponseProcessingData,\n    ? query-extended           => QueryResponseExtended,\n    ? response-extended        => QueryResponseExtended,\n}\ntime-offset              = 0\nclient-address-index     = 1\nclient-port              = 2\ntransaction-id           = 3\nqr-signature-index       = 4\nclient-hoplimit          = 5\nresponse-delay           = 6\nquery-name-index         = 7\nquery-size               = 8\nresponse-size            = 9\nresponse-processing-data = 10\nquery-extended           = 11\nresponse-extended        = 12",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "ResponseProcessingData = {\n    ? bailiwick-index  => uint,\n    ? processing-flags => ResponseProcessingFlags,\n}\nbailiwick-index = 0\nprocessing-flags = 1",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "ResponseProcessingFlagValues = &(\n    from-cache : 0,\n)\nResponseProcessingFlags = uint .bits ResponseProcessingFlagValues",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "QueryResponseExtended = {\n    ? question-index   => uint,       ; Index of QuestionList\n    ? answer-index     => uint,       ; Index of RRList\n    ? authority-index  => uint,\n    ? additional-index => uint,\n}\nquestion-index   = 0\nanswer-index     = 1\nauthority-index  = 2\nadditional-index = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; Address event data.\n;\nAddressEventCount = {\n    ae-type              => &AddressEventType,\n    ? ae-code            => uint,\n    ae-address-index     => uint,\n    ? ae-transport-flags => TransportFlags,\n    ae-count             => uint,\n}\nae-type            = 0\nae-code            = 1\nae-address-index   = 2\nae-transport-flags = 3\nae-count           = 4",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "AddressEventType = (\n    tcp-reset              : 0,\n    icmp-time-exceeded     : 1,\n    icmp-dest-unreachable  : 2,\n    icmpv6-time-exceeded   : 3,\n    icmpv6-dest-unreachable: 4,\n    icmpv6-packet-too-big  : 5,\n)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": ";\n; Malformed messages.\n;\nMalformedMessage = {\n    ? time-offset           => uticks,   ; Time offset from\n                                         ; start of Block\n    ? client-address-index  => uint,\n    ? client-port           => uint,\n    ? message-data-index    => uint,\n}\n; Other map key values already defined above.\nmessage-data-index = 3",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Appendix B. DNS Name Compression Example",
      "section_title": true,
      "zh-CHS": "附录B.DNS名称压缩示例"
    },
    {
      "indent": 3,
      "text": "The basic algorithm, which follows the guidance in [RFC1035], is simply to collect each name, and the offset in the packet at which it starts, during packet construction. As each name is added, it is offered to each of the collected names in order of collection, starting from the first name. If (1) labels at the end of the name can be replaced with a reference back to part (or all) of the earlier name and (2) the uncompressed part of the name is shorter than any compression already found, the earlier name is noted as the compression target for the name.",
      "zh-CHS": "基本算法遵循[RFC1035]中的指导，只需在数据包构造过程中收集每个名称以及数据包开始时的偏移量。在添加每个名称时，将按照收集顺序向每个收集的名称提供该名称，从第一个名称开始。如果（1）名称末尾的标签可以替换为对早期名称的部分（或全部）的引用，并且（2）名称的未压缩部分比已找到的任何压缩短，则早期名称将作为名称的压缩目标。"
    },
    {
      "indent": 3,
      "text": "The following tables illustrate the step-by-step process of adding names and performing name compression. In an example packet, the first name added is foo.example, which cannot be compressed.",
      "zh-CHS": "下表说明了添加名称和执行名称压缩的分步过程。在示例数据包中，添加的第一个名称是foo.example，它不能被压缩。"
    },
    {
      "indent": 10,
      "text": "+---+-------------+--------------+--------------------+\n| N | Name        | Uncompressed | Compression Target |\n+---+-------------+--------------+--------------------+\n| 1 | foo.example | foo.example  | None               |\n+---+-------------+--------------+--------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The next name added is bar.example. This is matched against foo.example. The example part of this can be used as a compression target, with the remaining uncompressed part of the name being bar.",
      "zh-CHS": "添加的下一个名称是bar.example。这与foo.example匹配。其中的示例部分可用作压缩目标，名称的剩余未压缩部分为bar。"
    },
    {
      "indent": 8,
      "text": "+---+-------------+--------------+-----------------------+\n| N | Name        | Uncompressed | Compression Target    |\n+---+-------------+--------------+-----------------------+\n| 1 | foo.example | foo.example  | None                  |\n| 2 | bar.example | bar          | 1 + offset to example |\n+---+-------------+--------------+-----------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The third name added is www.bar.example. This is first matched against foo.example, and as before this is recorded as a compression target, with the remaining uncompressed part of the name being www.bar. It is then matched against the second name, which again can be a compression target. Because the remaining uncompressed part of the name is www, this is an improved compression, and so it is adopted.",
      "zh-CHS": "添加的第三个名称是www.bar.example。这首先与foo.example匹配，与之前一样，这被记录为压缩目标，名称的剩余未压缩部分为www.bar。然后将其与第二个名称匹配，第二个名称也可以是压缩目标。由于名称的剩余未压缩部分是www，因此这是一种改进的压缩，因此被采用。"
    },
    {
      "indent": 6,
      "text": "+---+-----------------+--------------+-----------------------+\n| N | Name            | Uncompressed | Compression Target    |\n+---+-----------------+--------------+-----------------------+\n| 1 | foo.example     | foo.example  | None                  |\n| 2 | bar.example     | bar          | 1 + offset to example |\n| 3 | www.bar.example | www          | 2                     |\n+---+-----------------+--------------+-----------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "As an optimization, if a name is already perfectly compressed (in other words, the uncompressed part of the name is empty), then no further names will be considered for compression.",
      "zh-CHS": "作为一种优化，如果名称已经完全压缩（换句话说，名称的未压缩部分为空），则不会考虑进一步压缩名称。"
    },
    {
      "indent": 0,
      "text": "B.1. NSD Compression Algorithm",
      "section_title": true,
      "zh-CHS": "B.1. NSD压缩算法"
    },
    {
      "indent": 3,
      "text": "Using the above basic algorithm, the packet lengths of Responses generated by the Name Server Daemon (NSD) [NSD] can be matched almost exactly. At the time of writing, a tiny number (<.01%) of the reconstructed packets had incorrect lengths.",
      "zh-CHS": "使用上述基本算法，名称服务器守护程序（NSD）[NSD]生成的响应的数据包长度几乎可以精确匹配。在编写本文时，极少数（<.01%）的重构数据包的长度不正确。"
    },
    {
      "indent": 0,
      "text": "B.2. Knot Authoritative Compression Algorithm",
      "section_title": true,
      "zh-CHS": "B.2. 节点压缩算法"
    },
    {
      "indent": 3,
      "text": "The Knot Authoritative name server [Knot] uses different compression behavior, which is the result of internal optimization designed to balance runtime speed with compression size gains. In brief, and omitting complications, Knot Authoritative will only consider the QNAME and names in the immediately preceding RR section in an RRSET as compression targets.",
      "zh-CHS": "Knot权威名称服务器[Knot]使用不同的压缩行为，这是内部优化的结果，旨在平衡运行速度和压缩大小增益。总之，省略并发症，结权威只考虑在RRSET中作为压缩目标的前一个RR部分中的QNEY和名称。"
    },
    {
      "indent": 3,
      "text": "A set of smart heuristics as described below can be implemented to mimic this, and while not perfect, it produces output nearly, but not quite, as good a match as with NSD. The heuristics are as follows:",
      "zh-CHS": "可以实现如下所述的一组智能启发法来模拟这一点，虽然不完美，但它产生的输出几乎与NSD匹配，但并不完全匹配。试探法如下："
    },
    {
      "indent": 3,
      "text": "1. A match is only perfect if the name is completely compressed AND the TYPE of the section in which the name occurs matches the TYPE of the name used as the compression target.",
      "zh-CHS": "1. 只有当名称被完全压缩并且名称所在的节的类型与用作压缩目标的名称的类型匹配时，匹配才是完美的。"
    },
    {
      "indent": 3,
      "text": "2. If the name occurs in RDATA:",
      "zh-CHS": "2. 如果名称出现在RDATA中："
    },
    {
      "indent": 7,
      "text": "* If the compression target name is in a Query, then only the first RR in an RRSET can use that name as a compression target.",
      "zh-CHS": "* 如果压缩目标名称在查询中，则只有RRSET中的第一个RR可以将该名称用作压缩目标。"
    },
    {
      "indent": 7,
      "text": "* The compression target name MUST be in RDATA.",
      "zh-CHS": "* 压缩目标名称必须采用RDATA格式。"
    },
    {
      "indent": 7,
      "text": "* The name section TYPE must match the compression target name section TYPE.",
      "zh-CHS": "* 名称节类型必须与压缩目标名称节类型匹配。"
    },
    {
      "indent": 7,
      "text": "* The compression target name MUST be in the immediately preceding RR in the RRSET.",
      "zh-CHS": "* 压缩目标名称必须位于RRSET中紧靠前的RR中。"
    },
    {
      "indent": 3,
      "text": "Using this algorithm, less than 0.1% of the reconstructed packets had incorrect lengths.",
      "zh-CHS": "使用该算法，不到0.1%的重构数据包具有不正确的长度。"
    },
    {
      "indent": 0,
      "text": "B.3. Observed Differences",
      "section_title": true,
      "zh-CHS": "B.3. 观察到的差异"
    },
    {
      "indent": 3,
      "text": "In sample traffic collected on a root name server, around 2-4% of Responses generated by Knot had different packet lengths than those produced by NSD.",
      "zh-CHS": "在根名称服务器上收集的样本流量中，Knot生成的响应中约有2-4%的数据包长度与NSD生成的数据包长度不同。"
    },
    {
      "indent": 0,
      "text": "Appendix C. Comparison of Binary Formats",
      "section_title": true,
      "zh-CHS": "附录C.二进制格式的比较"
    },
    {
      "indent": 3,
      "text": "Several binary serialization formats were considered. For completeness, they were also compared to JSON.",
      "zh-CHS": "考虑了几种二进制序列化格式。为了完整性，还将它们与JSON进行了比较。"
    },
    {
      "indent": 3,
      "text": "o Apache Avro [Avro]. Data is stored according to a predefined schema. The schema itself is always included in the data file. Data can therefore be stored untagged, for a smaller serialization size, and be written and read by an Avro library.",
      "zh-CHS": "o apacheavro[Avro]。数据根据预定义的模式存储。模式本身始终包含在数据文件中。因此，数据可以不加标记地存储，用于较小的序列化大小，并由Avro库写入和读取。"
    },
    {
      "indent": 6,
      "text": "* At the time of writing, Avro libraries are available for C, C++, C#, Java, Python, Ruby, and PHP. Optionally, tools are available for C++, Java, and C# to generate code for encoding and decoding.",
      "zh-CHS": "* 在编写时，AVro库可用于C、C++、C、java、Python、Ruby和PHP。可选地，工具可用于C++、java和C语言生成编码和解码的代码。"
    },
    {
      "indent": 3,
      "text": "o Google Protocol Buffers [Protocol-Buffers]. Data is stored according to a predefined schema. The schema is used by a generator to generate code for encoding and decoding the data. Data can therefore be stored untagged, for a smaller serialization size. The schema is not stored with the data, so unlike Avro, it cannot be read with a generic library.",
      "zh-CHS": "o 谷歌协议缓冲区[协议缓冲区]。数据根据预定义的模式存储。生成器使用模式生成编码和解码数据的代码。因此，可以不标记地存储数据，以获得较小的序列化大小。模式不与数据一起存储，因此与Avro不同，它不能用通用库读取。"
    },
    {
      "indent": 6,
      "text": "* Code must be generated for a particular data schema to read and write data using that schema. At the time of writing, the Google code generator can currently generate code for encoding and decoding a schema for C++, Go, Java, Python, Ruby, C#, Objective-C, JavaScript, and PHP.",
      "zh-CHS": "* 必须为特定数据架构生成代码，才能使用该架构读写数据。在编写时，谷歌代码生成器可以生成用于编码和解码用于C++、GO、java、Python、露比、Cype、Objto-C、JavaScript和PHP的模式的代码。"
    },
    {
      "indent": 3,
      "text": "o CBOR [RFC7049]. This serialization format is comparable to JSON but with a binary representation. It does not use a predefined schema, so data is always stored tagged. However, CBOR data schemas can be described using CDDL [RFC8610], and tools exist to verify that data files conform to the schema.",
      "zh-CHS": "o CBOR[RFC7049]。这种序列化格式类似于JSON，但具有二进制表示。它不使用预定义的模式，因此数据总是标记存储。但是，CBOR数据模式可以使用CDDL[RFC8610]来描述，并且存在用于验证数据文件是否符合模式的工具。"
    },
    {
      "indent": 6,
      "text": "* CBOR is a simple format and is simple to implement. At the time of writing, the CBOR website lists implementations for 16 languages.",
      "zh-CHS": "* CBOR是一种简单的格式，易于实现。在撰写本文时，CBOR网站列出了16种语言的实施情况。"
    },
    {
      "indent": 3,
      "text": "Avro and Protocol Buffers both allow storage of untagged data, but because they rely on the data schema for this, their implementation is considerably more complex than CBOR. Using Avro or Protocol Buffers in an unsupported environment would require notably greater development effort compared to CBOR.",
      "zh-CHS": "Avro和协议缓冲区都允许存储未标记的数据，但由于它们依赖于数据模式，因此它们的实现比CBOR复杂得多。与CBOR相比，在不受支持的环境中使用Avro或协议缓冲区需要更大的开发工作量。"
    },
    {
      "indent": 3,
      "text": "A test program was written that reads input from a PCAP file and writes output using one of two basic structures: either a simple structure, where each Query/Response pair is represented in a single record entry, or the C-DNS block structure.",
      "zh-CHS": "编写了一个测试程序，该程序使用两种基本结构之一从PCAP文件读取输入并写入输出：一种是简单结构，其中每个查询/响应对表示在单个记录条目中，另一种是C-DNS块结构。"
    },
    {
      "indent": 3,
      "text": "The resulting output files were then compressed using a variety of common general-purpose lossless compression tools to explore the compressibility of the formats. The compression tools employed were:",
      "zh-CHS": "然后使用各种通用无损压缩工具对生成的输出文件进行压缩，以探索格式的可压缩性。使用的压缩工具有："
    },
    {
      "indent": 3,
      "text": "o snzip [snzip]. A command-line compression tool based on the Google Snappy library [snappy].",
      "zh-CHS": "o snzip[snzip]。基于Google Snappy库[Snappy]的命令行压缩工具。"
    },
    {
      "indent": 3,
      "text": "o lz4 [lz4]. The command-line compression tool from the reference C LZ4 implementation.",
      "zh-CHS": "o lz4[lz4]。来自参考C LZ4实现的命令行压缩工具。"
    },
    {
      "indent": 3,
      "text": "o gzip [gzip]. The ubiquitous GNU zip tool.",
      "zh-CHS": "o gzip[gzip]。无处不在的GNU压缩工具。"
    },
    {
      "indent": 3,
      "text": "o zstd [zstd]. Compression using the Zstandard algorithm.",
      "zh-CHS": "o zstd[zstd]。使用Zstandard算法进行压缩。"
    },
    {
      "indent": 3,
      "text": "o xz [xz]. A popular compression tool noted for high compression.",
      "zh-CHS": "o xz[xz]。以高压缩率著称的流行压缩工具。"
    },
    {
      "indent": 3,
      "text": "In all cases, the compression tools were run using their default settings.",
      "zh-CHS": "在所有情况下，压缩工具都是使用默认设置运行的。"
    },
    {
      "indent": 3,
      "text": "Note that this document does not mandate the use of compression, nor any particular compression scheme, but it anticipates that in practice output data will be subject to general-purpose compression, and so this should be taken into consideration.",
      "zh-CHS": "请注意，本文件不强制使用压缩，也不强制使用任何特定的压缩方案，但预计在实践中，输出数据将接受通用压缩，因此应考虑到这一点。"
    },
    {
      "indent": 3,
      "text": "\"test.pcap\", a 662 MB capture of sample data from a root instance, was used for the comparison. The following table shows the formatted size and size after compression (abbreviated to Comp. in the table headers), together with the task Resident Set Size (RSS) and the user time taken by the compression. File sizes are in MB, RSS is in kB, and user time is in seconds.",
      "zh-CHS": "“test.pcap”是从根实例捕获的662MB样本数据，用于比较。下表显示了格式化的大小和压缩后的大小（在表头中缩写为Comp.），以及任务驻留集大小（RSS）和压缩所花费的用户时间。文件大小以MB为单位，RSS以kB为单位，用户时间以秒为单位。"
    },
    {
      "indent": 3,
      "text": "+-------------+-----------+-------+------------+-------+-----------+\n| Format      | File Size | Comp. | Comp. Size |   RSS | User Time |\n+-------------+-----------+-------+------------+-------+-----------+\n| PCAP        |    661.87 | snzip |     212.48 |  2696 |      1.26 |\n|             |           | lz4   |     181.58 |  6336 |      1.35 |\n|             |           | gzip  |     153.46 |  1428 |     18.20 |\n|             |           | zstd  |      87.07 |  3544 |      4.27 |\n|             |           | xz    |      49.09 | 97416 |    160.79 |\n|             |           |       |            |       |           |\n| JSON simple |   4113.92 | snzip |     603.78 |  2656 |      5.72 |\n|             |           | lz4   |     386.42 |  5636 |      5.25 |\n|             |           | gzip  |     271.11 |  1492 |     73.00 |\n|             |           | zstd  |     133.43 |  3284 |      8.68 |\n|             |           | xz    |      51.98 | 97412 |    600.74 |\n|             |           |       |            |       |           |\n| Avro simple |    640.45 | snzip |     148.98 |  2656 |      0.90 |\n|             |           | lz4   |     111.92 |  5828 |      0.99 |\n|             |           | gzip  |     103.07 |  1540 |     11.52 |\n|             |           | zstd  |      49.08 |  3524 |      2.50 |\n|             |           | xz    |      22.87 | 97308 |     90.34 |\n|             |           |       |            |       |           |\n| CBOR simple |    764.82 | snzip |     164.57 |  2664 |      1.11 |\n|             |           | lz4   |     120.98 |  5892 |      1.13 |\n|             |           | gzip  |     110.61 |  1428 |     12.88 |\n|             |           | zstd  |      54.14 |  3224 |      2.77 |\n|             |           | xz    |      23.43 | 97276 |    111.48 |\n|             |           |       |            |       |           |\n| PBuf simple |    749.51 | snzip |     167.16 |  2660 |      1.08 |\n|             |           | lz4   |     123.09 |  5824 |      1.14 |\n|             |           | gzip  |     112.05 |  1424 |     12.75 |\n|             |           | zstd  |      53.39 |  3388 |      2.76 |\n|             |           | xz    |      23.99 | 97348 |    106.47 |\n|             |           |       |            |       |           |\n| JSON block  |    519.77 | snzip |     106.12 |  2812 |      0.93 |\n|             |           | lz4   |     104.34 |  6080 |      0.97 |\n|             |           | gzip  |      57.97 |  1604 |     12.70 |\n|             |           | zstd  |      61.51 |  3396 |      3.45 |\n|             |           | xz    |      27.67 | 97524 |    169.10 |\n|             |           |       |            |       |           |\n| Avro block  |     60.45 | snzip |      48.38 |  2688 |      0.20 |\n|             |           | lz4   |      48.78 |  8540 |      0.22 |\n|             |           | gzip  |      39.62 |  1576 |      2.92 |\n|             |           | zstd  |      29.63 |  3612 |      1.25 |\n|             |           | xz    |      18.28 | 97564 |     25.81 |\n|             |           |       |            |       |           |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "| CBOR block  |     75.25 | snzip |      53.27 |  2684 |      0.24 |\n|             |           | lz4   |      51.88 |  8008 |      0.28 |\n|             |           | gzip  |      41.17 |  1548 |      4.36 |\n|             |           | zstd  |      30.61 |  3476 |      1.48 |\n|             |           | xz    |      18.15 | 97556 |     38.78 |\n|             |           |       |            |       |           |\n| PBuf block  |     67.98 | snzip |      51.10 |  2636 |      0.24 |\n|             |           | lz4   |      52.39 |  8304 |      0.24 |\n|             |           | gzip  |      40.19 |  1520 |      3.63 |\n|             |           | zstd  |      31.61 |  3576 |      1.40 |\n|             |           | xz    |      17.94 | 97440 |     33.99 |\n+-------------+-----------+-------+------------+-------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "The above results are discussed in the following sections.",
      "zh-CHS": "下面几节将讨论上述结果。"
    },
    {
      "indent": 0,
      "text": "C.1. Comparison with Full PCAP Files",
      "section_title": true,
      "zh-CHS": "C.1. 与完整PCAP文件的比较"
    },
    {
      "indent": 3,
      "text": "An important first consideration is whether moving away from PCAP offers significant benefits.",
      "zh-CHS": "首先要考虑的一个重要问题是，离开PCAP是否会带来显著的好处。"
    },
    {
      "indent": 3,
      "text": "The simple binary formats are typically larger than PCAP, even though they omit some information such as Ethernet Media Access Control (MAC) addresses. But not only do they require less CPU to compress than PCAP, the resulting compressed files are smaller than compressed PCAP.",
      "zh-CHS": "简单的二进制格式通常比PCAP大，尽管它们省略了一些信息，如以太网媒体访问控制（MAC）地址。但它们不仅需要比PCAP更少的CPU来压缩，而且得到的压缩文件比压缩的PCAP更小。"
    },
    {
      "indent": 0,
      "text": "C.2. Simple versus Block Coding",
      "section_title": true,
      "zh-CHS": "C.2. 简单编码与分组编码"
    },
    {
      "indent": 3,
      "text": "The intention of the block coding is to perform data deduplication on Query/Response records within the block. The simple and block formats shown above store exactly the same information for each Query/Response record. This information is parsed from the DNS traffic in the input PCAP file, and in all cases each field has an identifier and the field data is typed.",
      "zh-CHS": "块编码的目的是对块内的查询/响应记录执行重复数据消除。上面显示的简单格式和块格式为每个查询/响应记录存储完全相同的信息。此信息从输入PCAP文件中的DNS流量解析而来，在所有情况下，每个字段都有一个标识符，并键入字段数据。"
    },
    {
      "indent": 3,
      "text": "The data deduplication on the block formats show an order-of-magnitude reduction in the size of the format file size against the simple formats. As would be expected, the compression tools are able to find and exploit a lot of this duplication, but as the deduplication process uses knowledge of DNS traffic, it is able to retain a size advantage. This advantage reduces as stronger compression is applied, as again would be expected, but even with the strongest compression applied the block-formatted data remains around 75% of the size of the simple format and its compression requires roughly a third of the CPU time.",
      "zh-CHS": "块格式上的重复数据消除显示，与简单格式相比，格式文件大小减少了一个数量级。正如预期的那样，压缩工具能够发现并利用大量这种重复，但由于重复数据消除过程使用了DNS流量的知识，因此它能够保持规模优势。这一优势随着应用更强的压缩而减少，这也是意料之中的，但即使应用了最强的压缩，块格式的数据仍保持简单格式大小的75%左右，其压缩大约需要三分之一的CPU时间。"
    },
    {
      "indent": 0,
      "text": "C.3. Binary versus Text Formats",
      "section_title": true,
      "zh-CHS": "C.3. 二进制与文本格式"
    },
    {
      "indent": 3,
      "text": "Text data formats offer many advantages over binary formats, particularly in the areas of ad hoc data inspection and extraction. It was therefore felt worthwhile to carry out a direct comparison, implementing JSON versions of the simple and block formats.",
      "zh-CHS": "与二进制格式相比，文本数据格式具有许多优势，特别是在特殊数据检查和提取领域。因此，有必要进行直接比较，实现简单格式和块格式的JSON版本。"
    },
    {
      "indent": 3,
      "text": "Concentrating on JSON block format, the format files produced are a significant fraction of an order of magnitude larger than binary formats. The impact on file size after compression is as might be expected from that starting point; the stronger compression produces files that are 150% of the size of similarly compressed binary format and require over 4x more CPU to compress.",
      "zh-CHS": "专注于JSON块格式，生成的格式文件比二进制格式大一个数量级。压缩后对文件大小的影响与从该起点可以预期的一样；更强大的压缩产生的文件大小是类似压缩二进制格式的150%，需要4倍以上的CPU进行压缩。"
    },
    {
      "indent": 0,
      "text": "C.4. Performance",
      "section_title": true,
      "zh-CHS": "C.4. 表演"
    },
    {
      "indent": 3,
      "text": "Concentrating again on the block formats, all three produce format files that are close to an order of magnitude smaller than the original \"test.pcap\" file. CBOR produces the largest files and Avro the smallest, 20% smaller than CBOR.",
      "zh-CHS": "再次将注意力集中在块格式上，这三种格式的文件都比原始的“test.pcap”文件小一个数量级。CBOR生成的文件最大，Avro生成的文件最小，比CBOR小20%。"
    },
    {
      "indent": 3,
      "text": "However, once compression is taken into account, the size difference narrows. At medium compression (with gzip), the size difference is 4%. Using strong compression (with xz), the difference reduces to 2%, with Avro the largest and Protocol Buffers the smallest, although CBOR and Protocol Buffers require slightly more compression CPU.",
      "zh-CHS": "然而，一旦考虑到压缩，尺寸差异就会缩小。中等压缩（gzip）时，尺寸差异为4%。使用强压缩（使用xz），差异减小到2%，Avro最大，协议缓冲区最小，尽管CBOR和协议缓冲区需要稍多的压缩CPU。"
    },
    {
      "indent": 3,
      "text": "The measurements presented above do not include data on the CPU required to generate the format files. Measurements indicate that writing Avro requires 10% more CPU than CBOR or Protocol Buffers. It appears, therefore, that Avro's advantage in compression CPU usage is probably offset by a larger CPU requirement in writing Avro.",
      "zh-CHS": "上述测量不包括生成格式文件所需的CPU数据。测量结果表明，编写Avro需要比CBOR或协议缓冲区多10%的CPU。因此，似乎Avro在压缩CPU使用方面的优势可能被编写Avro时更大的CPU需求所抵消。"
    },
    {
      "indent": 0,
      "text": "C.5. Conclusions",
      "section_title": true,
      "zh-CHS": "C.5. 结论"
    },
    {
      "indent": 3,
      "text": "The above assessments lead us to the choice of a binary format file using blocking.",
      "zh-CHS": "通过以上评估，我们可以选择使用分块的二进制格式文件。"
    },
    {
      "indent": 3,
      "text": "As noted previously, this document anticipates that output data will be subject to compression. There is no compelling case for one particular binary serialization format in terms of either final file size or machine resources consumed, so the choice must be largely based on other factors. CBOR was therefore chosen as the binary serialization format for the reasons listed in Section 5.",
      "zh-CHS": "如前所述，本文档预期输出数据将受到压缩。对于一种特定的二进制序列化格式，无论是最终文件大小还是所消耗的机器资源，都没有令人信服的理由，因此选择必须在很大程度上基于其他因素。因此，出于第5节列出的原因，选择CBOR作为二进制序列化格式。"
    },
    {
      "indent": 0,
      "text": "C.6. Block Size Choice",
      "section_title": true,
      "zh-CHS": "C.6. 块大小选择"
    },
    {
      "indent": 3,
      "text": "Given the choice of a CBOR format using blocking, the question arises of what an appropriate default value for the maximum number of Query/Response pairs in a block should be. This has two components:",
      "zh-CHS": "考虑到使用块的CBOR格式的选择，问题是块中最大查询/响应对数的适当默认值应该是多少。这包括两个部分："
    },
    {
      "indent": 3,
      "text": "1. What is the impact on performance of using different block sizes in the format file?",
      "zh-CHS": "1. 在格式化文件中使用不同的块大小对性能有什么影响？"
    },
    {
      "indent": 3,
      "text": "2. What is the impact on the size of the format file before and after compression?",
      "zh-CHS": "2. 压缩前后对格式文件的大小有什么影响？"
    },
    {
      "indent": 3,
      "text": "The following table addresses the performance question, showing the impact on the performance of a C++ program converting \"test.pcap\" to C-DNS. File sizes are in MB, RSS is in kB, and user time is in seconds.",
      "zh-CHS": "下表讨论了性能问题，显示了C++程序将“测试.pCAP”转换为C-DNS的性能的影响。文件大小以MB为单位，RSS以kB为单位，用户时间以秒为单位。"
    },
    {
      "indent": 14,
      "text": "+------------+-----------+--------+-----------+\n| Block Size | File Size |    RSS | User Time |\n+------------+-----------+--------+-----------+\n|      1,000 |    133.46 | 612.27 |     15.25 |\n|      5,000 |     89.85 | 676.82 |     14.99 |\n|     10,000 |     76.87 | 752.40 |     14.53 |\n|     20,000 |     67.86 | 750.75 |     14.49 |\n|     40,000 |     61.88 | 736.30 |     14.29 |\n|     80,000 |     58.08 | 694.16 |     14.28 |\n|    160,000 |     55.94 | 733.84 |     14.44 |\n|    320,000 |     54.41 | 799.20 |     13.97 |\n+------------+-----------+--------+-----------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Therefore, increasing block size tends to increase maximum RSS a little, with no significant effect (if anything, a small reduction) on CPU consumption.",
      "zh-CHS": "因此，增加块大小往往会稍微增加最大RSS，而不会对CPU消耗产生显著影响（如果有任何影响的话，也会稍微减少）。"
    },
    {
      "indent": 3,
      "text": "The following table demonstrates the effect of increasing block size on output file size for different compressions.",
      "zh-CHS": "下表演示了增加块大小对不同压缩的输出文件大小的影响。"
    },
    {
      "indent": 6,
      "text": "+------------+--------+-------+-------+-------+-------+-------+\n| Block Size |   None | snzip |   lz4 |  gzip |  zstd |    xz |\n+------------+--------+-------+-------+-------+-------+-------+\n|      1,000 | 133.46 | 90.52 | 90.03 | 74.65 | 44.78 | 25.63 |\n|      5,000 |  89.85 | 59.69 | 59.43 | 46.99 | 37.33 | 22.34 |\n|     10,000 |  76.87 | 50.39 | 50.28 | 38.94 | 33.62 | 21.09 |\n|     20,000 |  67.86 | 43.91 | 43.90 | 33.24 | 32.62 | 20.16 |\n|     40,000 |  61.88 | 39.63 | 39.69 | 29.44 | 28.72 | 19.52 |\n|     80,000 |  58.08 | 36.93 | 37.01 | 27.05 | 26.25 | 19.00 |\n|    160,000 |  55.94 | 35.10 | 35.06 | 25.44 | 24.56 | 19.63 |\n|    320,000 |  54.41 | 33.87 | 33.74 | 24.36 | 23.44 | 18.66 |\n+------------+--------+-------+-------+-------+-------+-------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "There is obviously scope for tuning the default block size to the compression being employed, traffic characteristics, frequency of output file rollover, etc. Using a strong compression scheme, block sizes over 10,000 Query/Response pairs would seem to offer limited improvements.",
      "zh-CHS": "显然，可以根据所采用的压缩、流量特征、输出文件滚动频率等调整默认块大小。使用强压缩方案，超过10000个查询/响应对的块大小似乎只能提供有限的改进。"
    },
    {
      "indent": 0,
      "text": "Appendix D. Data Fields for Traffic Regeneration",
      "section_title": true,
      "zh-CHS": "附录D.交通再生数据字段"
    },
    {
      "indent": 0,
      "text": "D.1. Recommended Fields for Traffic Regeneration",
      "section_title": true,
      "zh-CHS": "D.1. 交通再生的推荐字段"
    },
    {
      "indent": 3,
      "text": "This section specifies the data fields that would need to be captured in order to perform the fullest PCAP traffic reconstruction for well-formed DNS messages that is possible with C-DNS.",
      "zh-CHS": "本节指定了需要捕获的数据字段，以便对格式良好的DNS消息执行最完整的PCAP流量重建，这在C-DNS中是可能的。"
    },
    {
      "indent": 3,
      "text": "o All data fields in the QueryResponse type except response-processing-data.",
      "zh-CHS": "o QueryResponse类型中的所有数据字段（响应处理数据除外）。"
    },
    {
      "indent": 3,
      "text": "o All data fields in the QueryResponseSignature type except qr-type.",
      "zh-CHS": "o QueryResponseSignature类型中的所有数据字段（qr类型除外）。"
    },
    {
      "indent": 3,
      "text": "o All data fields in the RR TYPE.",
      "zh-CHS": "o RR类型中的所有数据字段。"
    },
    {
      "indent": 0,
      "text": "D.2. Issues with Small Data Captures",
      "section_title": true,
      "zh-CHS": "D.2. 小数据捕获问题"
    },
    {
      "indent": 3,
      "text": "At the other extreme, an interesting corner case arises when opting to perform captures with a smaller data set than that recommended above. The following list specifies a subset of the above data fields; if only these data fields are captured, then even a minimal traffic reconstruction is problematic because there is not enough information to determine if the Query/Response data item contained just a Query, just a Response, or a Query/Response pair.",
      "zh-CHS": "在另一个极端，当选择使用比上述建议更小的数据集执行捕获时，会出现一个有趣的情况。以下列表指定了上述数据字段的子集；如果只捕获这些数据字段，那么即使是最小的流量重建也是有问题的，因为没有足够的信息来确定查询/响应数据项是否只包含查询、响应或查询/响应对。"
    },
    {
      "indent": 3,
      "text": "o The following data fields from the QueryResponse type:",
      "zh-CHS": "o QueryResponse类型中的以下数据字段："
    },
    {
      "indent": 6,
      "text": "* time-offset",
      "zh-CHS": "* 时间偏移"
    },
    {
      "indent": 6,
      "text": "* client-address-index",
      "zh-CHS": "* 客户端地址索引"
    },
    {
      "indent": 6,
      "text": "* client-port",
      "zh-CHS": "* 客户端端口"
    },
    {
      "indent": 6,
      "text": "* transaction-id",
      "zh-CHS": "* 事务id"
    },
    {
      "indent": 6,
      "text": "* query-name-index",
      "zh-CHS": "* 查询名称索引"
    },
    {
      "indent": 3,
      "text": "o The following data fields from the QueryResponseSignature type:",
      "zh-CHS": "o QueryResponseSignature类型中的以下数据字段："
    },
    {
      "indent": 6,
      "text": "* server-address-index",
      "zh-CHS": "* 服务器地址索引"
    },
    {
      "indent": 6,
      "text": "* server-port",
      "zh-CHS": "* 服务器端口"
    },
    {
      "indent": 6,
      "text": "* qr-transport-flags",
      "zh-CHS": "* qr运输标志"
    },
    {
      "indent": 6,
      "text": "* query-classtype-index",
      "zh-CHS": "* 查询类类型索引"
    },
    {
      "indent": 3,
      "text": "In this case, simply also capturing the qr-sig-flags will provide enough information to perform a minimal traffic reconstruction (assuming that suitable defaults for the remaining fields are provided). Additionally, capturing response-delay, query-opcode, and response-rcode will avoid having to rely on potentially misleading defaults for these values and should result in a PCAP that represents the basics of the real traffic flow.",
      "zh-CHS": "在这种情况下，简单地捕获qr sig标志将提供足够的信息来执行最小流量重建（假设为其余字段提供了合适的默认值）。此外，捕获响应延迟、查询操作码和响应rcode将避免依赖这些值的潜在误导性默认值，并应生成表示实际交通流基本信息的PCAP。"
    },
    {
      "indent": 0,
      "text": "Acknowledgements",
      "zh-CHS": "致谢"
    },
    {
      "indent": 3,
      "text": "The authors wish to thank CZ.NIC -- in particular, Tomas Gavenciak -- for many useful discussions on binary formats, compression, and packet matching. Thanks also to Jan Vcelak and Wouter Wijngaards for discussions on name compression, and Paul Hoffman for a detailed review of this document and the C-DNS CDDL.",
      "zh-CHS": "作者希望感谢CZ.NIC——特别是Tomas Gavenciak——对二进制格式、压缩和数据包匹配进行了许多有益的讨论。还要感谢Jan Vcelak和Wouter Wijngaards对名称压缩的讨论，以及Paul Hoffman对本文档和C-DNS CDDL的详细审查。"
    },
    {
      "indent": 3,
      "text": "Thanks also to Robert Edmonds, Jerry Lundstrom, Richard Gibson, Stephane Bortzmeyer, and many other members of DNSOP for review.",
      "zh-CHS": "还要感谢罗伯特·爱德蒙兹、杰瑞·伦德斯特伦、理查德·吉布森、斯蒂芬·波茨迈耶和DNSOP的许多其他成员的审查。"
    },
    {
      "indent": 3,
      "text": "Also, thanks to Miek Gieben for [mmark].",
      "zh-CHS": "另外，感谢Miek Gieben的[mmark]。"
    },
    {
      "indent": 0,
      "text": "Authors' Addresses",
      "zh-CHS": "作者地址"
    },
    {
      "indent": 3,
      "text": "John Dickinson Sinodun IT Magdalen Centre Oxford Science Park Oxford OX4 4GA United Kingdom Email: jad@sinodun.com",
      "zh-CHS": "John Dickinson Sinodun IT Magdalen Centre牛津科技园牛津OX4 4GA英国电子邮件：jad@sinodun.com"
    },
    {
      "indent": 3,
      "text": "Jim Hague Sinodun IT Magdalen Centre Oxford Science Park Oxford OX4 4GA United Kingdom Email: jim@sinodun.com",
      "zh-CHS": "Jim Hague Sinodun IT Magdalen中心牛津科技园牛津OX4 4GA英国电子邮件：jim@sinodun.com"
    },
    {
      "indent": 3,
      "text": "Sara Dickinson Sinodun IT Magdalen Centre Oxford Science Park Oxford OX4 4GA United Kingdom Email: sara@sinodun.com",
      "zh-CHS": "Sara Dickinson Sinodun IT Magdalen中心牛津科技园牛津OX4 4GA英国电子邮件：sara@sinodun.com"
    },
    {
      "indent": 3,
      "text": "Terry Manderson ICANN 12025 Waterfront Drive Suite 300 Los Angeles, CA 90094-2536 United States of America Email: terry.manderson@icann.org",
      "zh-CHS": "Terry Manderson ICANN 12025 Waterfront Drive Suite 300加利福尼亚州洛杉矶90094-2536美利坚合众国电子邮件：Terry。manderson@icann.org"
    },
    {
      "indent": 3,
      "text": "John Bond Wikimedia Foundation, Inc. 1 Montgomery Street Suite 1600 San Francisco, CA 94104 United States of America Email: ietf-wikimedia@johnbond.org",
      "zh-CHS": "约翰邦德维基米达基金会，公司1蒙哥马利街套房1600旧金山，CA 94104美利坚合众国电子邮件：IETF-wikimedia@johnbond.org"
    }
  ]
}