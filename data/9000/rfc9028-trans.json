{
  "title": {
    "text": "RFC 9028: Native NAT Traversal Mode for the Host Identity Protocol",
    "zh-CHS": "RFC 9028"
  },
  "number": 9028,
  "created_at": "2021-10-28 02:53:25.216377+08:00",
  "updated_by": "",
  "contents": [
    {
      "indent": 0,
      "text": "+--------------+\n               |    Control   |\n+--------+     | Relay Server |      +--------+\n| Data   |     +----+-----+---+      | Data   |\n| Relay  |         /       \\         | Relay  |\n| Server |        /         \\        | Server |\n+--------+       /           \\       +--------+\n                /             \\\n               /               \\\n              /                 \\\n             /  <- Signaling ->  \\\n            /                     \\\n      +-------+                +-------+\n      |  NAT  |                |  NAT  |\n      +-------+                +-------+\n       /                              \\\n      /                                \\\n +-------+                           +-------+\n | Init- |                           | Resp- |\n | iator |                           | onder |\n +-------+                           +-------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Control/Data                                           Control/Data\nRelay Client (Initiator)                   Relay Server (Responder)\n|   1. UDP(I1)                                                    |\n+---------------------------------------------------------------->|\n|                                                                 |\n|   2. UDP(R1(REG_INFO(RELAY_UDP_HIP,[RELAY_UDP_ESP])))           |\n|<----------------------------------------------------------------+\n|                                                                 |\n|   3. UDP(I2(REG_REQ(RELAY_UDP_HIP),[RELAY_UDP_ESP]))            |\n+---------------------------------------------------------------->|\n|                                                                 |\n|   4. UDP(R2(REG_RES(RELAY_UDP_HIP,[RELAY_UDP_ESP]), REG_FROM,   |\n|          [RELAYED_ADDRESS]))                                    |\n|<----------------------------------------------------------------+\n|                                                                 |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Initiator                                                  Responder\n| 1. UDP(I1)                                                       |\n+----------------------------------------------------------------->|\n|                                                                  |\n| 2. UDP(R1(.., NAT_TRAVERSAL_MODE(ICE-HIP-UDP), ..))              |\n|<-----------------------------------------------------------------+\n|                                                                  |\n| 3. UDP(I2(.., NAT_TRAVERSAL_MODE(ICE-HIP-UDP), ENC(LOC_SET), ..))|\n+----------------------------------------------------------------->|\n|                                                                  |\n| 4. UDP(R2(.., ENC(LOC_SET), ..))                                 |\n|<-----------------------------------------------------------------+\n|                                                                  |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Initiator                  Control Relay Server             Responder\n| 1. UDP(I1)                       |                                |\n+--------------------------------->| 2. UDP(I1(RELAY_FROM))         |\n|                                  +------------------------------->|\n|                                  |                                |\n|                                  | 3. UDP(R1(RELAY_TO, NAT_TM,    |\n|                                  |        TA_P))                  |\n| 4. UDP(R1(RELAY_TO, NAT_TM,      |<-------------------------------+\n|        TA_P))                    |                                |\n|<---------------------------------+                                |\n|                                  |                                |\n| 5. UDP(I2(ENC(LOC_SET)),         |                                |\n|        NAT_TM, TA_P))            |                                |\n+--------------------------------->| 6. UDP(I2(ENC(LOC_SET),        |\n|                                  |      RELAY_FROM, NAT_TM, TA_P))|\n|                                  +------------------------------->|\n|                                  |                                |\n|                                  | 7. UDP(R2(ENC(LOC_SET),        |\n| 8. UDP(R2(ENC(LOC_SET),          |        RELAY_TO))              |\n|        RELAY_TO))                |<-------------------------------+\n|<---------------------------------+                                |\n|                                  |                                |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Initiator  NAT1                                 NAT2        Responder\n|             | 1. UDP(UPDATE(SEQ, CAND_PRIO,      |                |\n|             |        ECHO_REQ_SIGN))             |                |\n|             X<-----------------------------------+----------------+\n|             |                                    |                |\n| 2. UDP(UPDATE(SEQ, ECHO_REQ_SIGN, CAND_PRIO))    |                |\n+-------------+------------------------------------+--------------->|\n|             |                                    |                |\n| 3. UDP(UPDATE(ACK, ECHO_RESP_SIGN, MAPPED_ADDR)) |                |\n|<------------+------------------------------------+----------------+\n|             |                                    |                |\n| 4. UDP(UPDATE(SEQ, ECHO_REQ_SIGN, CAND_PRIO))    |                |\n|<------------+------------------------------------+----------------+\n|             |                                    |                |\n| 5. UDP(UPDATE(ACK, ECHO_RESP_SIGN, MAPPED_ADDR)) |                |\n+-------------+------------------------------------+--------------->|\n|             |                                    |                |\n| 6. Other connectivity checks using UPDATE over UDP                |\n|<------------+------------------------------------+---------------->\n|             |                                    |                |\n| 7. UDP(UPDATE(SEQ, ECHO_REQ_SIGN, CAND_PRIO, NOMINATE))           |\n+-------------+------------------------------------+--------------->|\n|             |                                    |                |\n| 8. UDP(UPDATE(SEQ, ACK, ECHO_REQ_SIGN, ECHO_RESP_SIGN,            |\n|           NOMINATE))                             |                |\n|<------------+------------------------------------+----------------+\n|             |                                    |                |\n| 9. UDP(UPDATE(ACK, ECHO_RESP_SIGN))              |                |\n+-------------+------------------------------------+--------------->+\n|             |                                    |                |\n| 10. ESP data traffic over UDP                     |               |\n+<------------+------------------------------------+--------------->+\n|             |                                    |                |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Mobile Host               Control Relay Server              Peer Host\n| 1. UDP(UPDATE(ESP_INFO,          |                                |\n|          ENC(LOC_SET), SEQ))     |                                |\n+--------------------------------->| 2. UDP(UPDATE(ESP_INFO,        |\n|                                  |          ENC(LOC_SET), SEQ,    |\n|                                  |          RELAY_FROM))          |\n|                                  +------------------------------->|\n|                                  |                                |\n|                                  | 3. UDP(UPDATE(ESP_INFO, SEQ,   |\n|                                  |          ACK, ECHO_REQ_SIGN,   |\n|                                  |          RELAY_TO))            |\n| 4. UDP(UPDATE(ESP_INFO, SEQ,     |<-------------------------------+\n|          ACK, ECHO_REQ_SIGN,     |                                |\n|          RELAY_TO))              |                                |\n|<---------------------------------+                                |\n|                                  |                                |\n| 5. UDP(UPDATE(ACK,               |                                |\n|          ECHO_RESP_SIGNED))      |                                |\n+--------------------------------->| 6. UDP(UPDATE(ACK,             |\n|                                  |          ECHO_RESP_SIGNED,     |\n|                                  |          RELAY_FROM))          |\n|                                  +------------------------------->|\n|                                  |                                |\n|                   7. connectivity checks over UDP                 |\n+<----------------------------------------------------------------->+\n|                                  |                                |\n|                      8. ESP data over UDP                         |\n+<----------------------------------------------------------------->+\n|                                  |                                |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|        Source Port            |       Destination Port        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|           Length              |           Checksum            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                       32 bits of zeroes                       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n~                    HIP Header and Parameters                  ~\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|           Reserved            |            Mode ID #1         |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|           Mode ID #2          |            Mode ID #3         |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|           Mode ID #n          |             Padding           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                            Min Ta                             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Port              |    Protocol   |     Reserved  |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n|                            Address                            |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |            Length             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n| Traffic Type  |  Locator Type | Locator Length|  Reserved   |P|\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                       Locator Lifetime                        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                            Locator                            |\n|                                                               |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n.                                                               .\n.                                                               .\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n| Traffic Type  |  Loc Type = 2 | Locator Length|  Reserved   |P|\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                       Locator Lifetime                        |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|     Transport Port            |  Transp. Proto|     Kind      |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                           Priority                            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                              SPI                              |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                            Address                            |\n|                                                               |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Port              |    Protocol   |    Reserved   |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n|                            Address                            |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|            RPort              |             PPort             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|   Protocol    |          Reserved                             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n|                            RAddress                           |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                                                               |\n|                            PAddress                           |\n|                                                               |\n|                                                               |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                              OSPI                             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                              ISPI                             |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                            Priority                           |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": " 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             Type              |             Length            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|                           Reserved                            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+",
      "raw": true,
      "zh-CHS": " "
    }
  ]
}