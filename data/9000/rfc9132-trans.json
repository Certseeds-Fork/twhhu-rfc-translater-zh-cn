{
  "title": {
    "text": "RFC 9132: Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel Specification",
    "zh-CHS": "RFC 9132"
  },
  "number": 9132,
  "created_at": "2021-10-28 03:03:25.741610+08:00",
  "updated_by": "",
  "contents": [
    {
      "indent": 0,
      "text": "Network\n   Resource          CPE Router      Access Network      __________\n+-------------+   +--------------+   +-------------+    /          \\\n|             |   |              |   |             |    | Internet |\n| DOTS Client +---+ DOTS Gateway +---+ DOTS Server +----+          |\n|             |   |              |   |             |    |          |\n+-------------+   +--------------+   +-------------+    \\__________/",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "   Network                                          DDoS Mitigation\n   Resource          CPE Router        _________        Service\n+-------------+   +--------------+    /         \\   +-------------+\n|             |   |              |   |          |   |             |\n| DOTS Client +---+ DOTS Gateway +---+ Internet +---+ DOTS Server |\n|             |   |              |   |          |   |             |\n+-------------+   +--------------+    \\_________/   +-------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "+---------------------+\n| DOTS Signal Channel |\n+---------------------+\n|         CoAP        |\n+----------+----------+\n|   TLS    |   DTLS   |\n+----------+----------+\n|   TCP    |   UDP    |\n+----------+----------+\n|          IP         |\n+---------------------+",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "+-----------+                                         +-----------+\n|DOTS Client|                                         |DOTS Server|\n+-----------+                                         +-----------+\n      |                                                     |\n   T0 |--DTLS ClientHello, IPv6 ---->X                      |\n   T1 |--DTLS ClientHello, IPv4 ---->X                      |\n   T2 |--TCP SYN, IPv6-------------->X                      |\n   T3 |--TCP SYN, IPv4------------------------------------->|\n      |<-TCP SYNACK-----------------------------------------|\n      |--TCP ACK------------------------------------------->|\n      |<------------Establish TLS Session------------------>|\n      |----------------DOTS signal------------------------->|\n      |                                                     |",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 1,
      "text": "Note: * Retransmission messages are not shown. * T1-T0=T2-T1=T3-T2= Connection Attempt Delay.",
      "zh-CHS": "注：*未显示重传消息。*T1-T0=T2-T1=T3-T2=连接尝试延迟。"
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=123\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  ...\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  \"ietf-dots-signal-channel:mitigation-scope\": {\n    \"scope\": [\n      {\n        \"target-prefix\": [\n           \"string\"\n         ],\n        \"target-port-range\": [\n           {\n             \"lower-port\": number,\n             \"upper-port\": number\n           }\n         ],\n         \"target-protocol\": [\n           number\n         ],\n         \"target-fqdn\": [\n           \"string\"\n         ],\n         \"target-uri\": [\n           \"string\"\n         ],\n         \"alias-name\": [\n           \"string\"\n         ],\n        \"lifetime\": number,\n        \"trigger-mitigation\": true|false\n      }\n    ]\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cdid=7eeaf349529eb55ed50113\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=123\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  \"ietf-dots-signal-channel:mitigation-scope\": {\n    \"scope\": [\n      {\n        \"target-prefix\": [\n           \"2001:db8:6401::1/128\",\n           \"2001:db8:6401::2/128\"\n         ],\n        \"target-port-range\": [\n          {\n            \"lower-port\": 80\n          },\n          {\n            \"lower-port\": 443\n          },\n          {\n             \"lower-port\": 8080\n          }\n         ],\n         \"target-protocol\": [\n           6\n         ],\n        \"lifetime\": 3600\n      }\n    ]\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "A1                                      # map(1)\n   01                                   # unsigned(1)\n   A1                                   # map(1)\n      02                                # unsigned(2)\n      81                                # array(1)\n         A4                             # map(4)\n            06                          # unsigned(6)\n            82                          # array(2)\n               74                       # text(20)\n                  323030313A6462383A363430313A3A312F313238\n               74                       # text(20)\n                  323030313A6462383A363430313A3A322F313238\n            07                          # unsigned(7)\n            83                          # array(3)\n               A1                       # map(1)\n                  08                    # unsigned(8)\n                  18 50                 # unsigned(80)\n               A1                       # map(1)\n                  08                    # unsigned(8)\n                  19 01BB               # unsigned(443)\n               A1                       # map(1)\n                  08                    # unsigned(8)\n                  19 1F90               # unsigned(8080)\n            0A                          # unsigned(10)\n            81                          # array(1)\n               06                       # unsigned(6)\n            0E                          # unsigned(14)\n            19 0E10                     # unsigned(3600)",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cdid=7eeaf349529eb55ed50113\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=123\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  ...\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:mitigation-scope\": {\n     \"scope\": [\n        {\n          \"mid\": 123,\n          \"lifetime\": 3600\n        }\n      ]\n   }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "(1) Request with a conflicting 'cuid'",
      "zh-CHS": "(1) 具有冲突“cuid”的请求"
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=12\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "(2) Message body of the 4.09 (Conflict) response from the DOTS server",
      "zh-CHS": "(2) 来自DOTS服务器的4.09（冲突）响应的消息正文"
    },
    {
      "indent": 2,
      "text": "{\n  \"ietf-dots-signal-channel:mitigation-scope\": {\n     \"scope\": [\n        {\n          \"conflict-information\": {\n            \"conflict-cause\": \"cuid-collision\"\n           }\n        }\n      ]\n   }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "(3) Request with a new 'cuid'",
      "zh-CHS": "(3) 具有新“cuid”的请求"
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=f30d281ce6b64fc5a0b91e\"\nUri-Path: \"mid=12\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: GET (Code=0.01)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nObserve: 0",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: GET (Code=0.01)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=12332\"\nObserve: 0",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:mitigation-scope\": {\n    \"scope\": [\n      {\n        \"mid\": 12332,\n        \"mitigation-start\": \"1507818434\",\n        \"target-prefix\": [\n             \"2001:db8:6401::1/128\",\n             \"2001:db8:6401::2/128\"\n        ],\n        \"target-protocol\": [\n          17\n        ],\n        \"lifetime\": 1756,\n        \"status\": \"attack-successfully-mitigated\",\n        \"bytes-dropped\": \"134334555\",\n        \"bps-dropped\": \"43344\",\n        \"pkts-dropped\": \"333334444\",\n        \"pps-dropped\": \"432432\"\n      },\n      {\n        \"mid\": 12333,\n        \"mitigation-start\": \"1507818393\",\n        \"target-prefix\": [\n             \"2001:db8:6401::1/128\",\n             \"2001:db8:6401::2/128\"\n        ],\n        \"target-protocol\": [\n          6\n        ],\n        \"lifetime\": 1755,\n        \"status\": \"attack-stopped\",\n        \"bytes-dropped\": \"0\",\n        \"bps-dropped\": \"0\",\n        \"pkts-dropped\": \"0\",\n        \"pps-dropped\": \"0\"\n      }\n    ]\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "+-----------+                              +-----------+\n|DOTS Client|                              |DOTS Server|\n+-----------+                              +-----------+\n      |                                          |\n      |  GET /<mid>                              |\n      |  Token: 0x4a                             | Registration\n      |  Observe: 0                              |\n      +----------------------------------------->|\n      |                                          |\n      |  2.05 Content                            |\n      |  Token: 0x4a                             | Notification of\n      |  Observe: 12                             | the current state\n      |  status: \"attack-mitigation-in-progress\" |\n      |<-----------------------------------------+\n      |                                          |\n      |  2.05 Content                            |\n      |  Token: 0x4a                             | Notification upon\n      |  Observe: 44                             | a state change\n      |  status: \"attack-successfully-mitigated\" |\n      |<-----------------------------------------+\n      |                                          |\n      |  2.05 Content                            |\n      |  Token: 0x4a                             | Notification upon\n      |  Observe: 60                             | a state change\n      |  status: \"attack-stopped\"                |\n      |<-----------------------------------------+\n      |                                          |\n                         ...",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=123\"\nIf-Match:\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 3,
      "text": "{\n \"ietf-dots-signal-channel:mitigation-scope\": {\n   \"scope\": [\n     {\n       \"target-prefix\": [\n          \"2001:db8:6401::1/128\",\n          \"2001:db8:6401::2/128\"\n        ],\n       \"target-port-range\": [\n         {\n           \"lower-port\": 80\n         },\n         {\n           \"lower-port\": 443\n         },\n         {\n            \"lower-port\": 8080\n         }\n       ],\n       \"target-protocol\": [\n          6\n       ],\n       \"attack-status\": \"under-attack\"\n     }\n   ]\n }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: DELETE (Code=0.04)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"mitigate\"\nUri-Path: \"cuid=dz6pHjaADkaFTbjr0JGBpw\"\nUri-Path: \"mid=123\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: GET (Code=0.01) Uri-Path: \".well-known\" Uri-Path: \"dots\" Uri-Path: \"config\"",
      "zh-CHS": "Header:GET（Code=0.01）Uri路径：“.well-known”Uri路径：“dots”Uri路径：“config”"
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:signal-config\": {\n    \"mitigating-config\": {\n      \"heartbeat-interval\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"missing-hb-allowed\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"probing-rate\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"max-retransmit\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"ack-timeout\": {\n        \"max-value-decimal\": \"string\",\n        \"min-value-decimal\": \"string\",\n        \"current-value-decimal\": \"string\"\n      },\n      \"ack-random-factor\": {\n        \"max-value-decimal\": \"string\",\n        \"min-value-decimal\": \"string\",\n        \"current-value-decimal\": \"string\"\n      }\n    },\n    \"idle-config\": {\n      \"heartbeat-interval\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"missing-hb-allowed\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"probing-rate\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"max-retransmit\": {\n        \"max-value\": number,\n        \"min-value\": number,\n        \"current-value\": number\n      },\n      \"ack-timeout\": {\n        \"max-value-decimal\": \"string\",\n        \"min-value-decimal\": \"string\",\n        \"current-value-decimal\": \"string\"\n      },\n      \"ack-random-factor\": {\n        \"max-value-decimal\": \"string\",\n        \"min-value-decimal\": \"string\",\n        \"current-value-decimal\": \"string\"\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:signal-config\": {\n    \"mitigating-config\": {\n      \"heartbeat-interval\": {\n        \"max-value\": 240,\n        \"min-value\": 15,\n        \"current-value\": 30\n      },\n      \"missing-hb-allowed\": {\n        \"max-value\": 20,\n        \"min-value\": 3,\n        \"current-value\": 15\n      },\n      \"probing-rate\": {\n        \"max-value\": 20,\n        \"min-value\": 5,\n        \"current-value\": 15\n      },\n      \"max-retransmit\": {\n        \"max-value\": 15,\n        \"min-value\": 2,\n        \"current-value\": 3\n      },\n      \"ack-timeout\": {\n        \"max-value-decimal\": \"30.00\",\n        \"min-value-decimal\": \"1.00\",\n        \"current-value-decimal\": \"2.00\"\n      },\n      \"ack-random-factor\": {\n        \"max-value-decimal\": \"4.00\",\n        \"min-value-decimal\": \"1.10\",\n        \"current-value-decimal\": \"1.50\"\n      }\n    },\n    \"idle-config\": {\n      \"heartbeat-interval\": {\n        \"max-value\": 240,\n        \"min-value\": 15,\n        \"current-value\": 30\n      },\n      \"missing-hb-allowed\": {\n        \"max-value\": 20,\n        \"min-value\": 3,\n        \"current-value\": 15\n      },\n      \"probing-rate\": {\n        \"max-value\": 20,\n        \"min-value\": 5,\n        \"current-value\": 15\n      },\n      \"max-retransmit\": {\n        \"max-value\": 15,\n        \"min-value\": 2,\n        \"current-value\": 3\n      },\n      \"ack-timeout\": {\n        \"max-value-decimal\": \"30.00\",\n        \"min-value-decimal\": \"1.00\",\n        \"current-value-decimal\": \"2.00\"\n      },\n      \"ack-random-factor\": {\n        \"max-value-decimal\": \"4.00\",\n        \"min-value-decimal\": \"1.10\",\n        \"current-value-decimal\": \"1.50\"\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"config\"\nUri-Path: \"sid=123\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n ...\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  \"ietf-dots-signal-channel:signal-config\": {\n    \"mitigating-config\": {\n      \"heartbeat-interval\": {\n        \"current-value\": number\n      },\n      \"missing-hb-allowed\": {\n        \"current-value\": number\n      },\n      \"probing-rate\": {\n        \"current-value\": number\n      },\n      \"max-retransmit\": {\n        \"current-value\": number\n      },\n      \"ack-timeout\": {\n        \"current-value-decimal\": \"string\"\n      },\n      \"ack-random-factor\": {\n        \"current-value-decimal\": \"string\"\n      }\n    },\n    \"idle-config\": {\n      \"heartbeat-interval\": {\n        \"current-value\": number\n      },\n      \"missing-hb-allowed\": {\n        \"current-value\": number\n      },\n      \"probing-rate\": {\n        \"current-value\": number\n      },\n      \"max-retransmit\": {\n        \"current-value\": number\n      },\n      \"ack-timeout\": {\n        \"current-value-decimal\": \"string\"\n      },\n      \"ack-random-factor\": {\n        \"current-value-decimal\": \"string\"\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"config\"\nUri-Path: \"sid=123\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "{\n  \"ietf-dots-signal-channel:signal-config\": {\n    \"mitigating-config\": {\n      \"heartbeat-interval\": {\n        \"current-value\": 30\n      },\n      \"missing-hb-allowed\": {\n        \"current-value\": 15\n      },\n      \"probing-rate\": {\n        \"current-value\": 15\n      },\n      \"max-retransmit\": {\n        \"current-value\": 3\n      },\n      \"ack-timeout\": {\n        \"current-value-decimal\": \"2.00\"\n      },\n      \"ack-random-factor\": {\n        \"current-value-decimal\": \"1.50\"\n      }\n    },\n    \"idle-config\": {\n      \"heartbeat-interval\": {\n        \"current-value\": 0\n      },\n      \"max-retransmit\": {\n        \"current-value\": 3\n      },\n      \"ack-timeout\": {\n        \"current-value-decimal\": \"2.00\"\n      },\n      \"ack-random-factor\": {\n        \"current-value-decimal\": \"1.50\"\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "Header: DELETE (Code=0.04)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"config\"\nUri-Path: \"sid=123\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:redirected-signal\": {\n    \"alt-server\": \"string\",\n    \"alt-server-record\": [\n       \"string\"\n    ]\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "{\n  \"ietf-dots-signal-channel:redirected-signal\": {\n    \"alt-server\": \"alt-server.example\",\n    \"alt-server-record\": [\n       \"2001:db8:6401::1\",\n       \"2001:db8:6401::2\"\n    ]\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Header: PUT (Code=0.03)\nUri-Path: \".well-known\"\nUri-Path: \"dots\"\nUri-Path: \"hb\"\nContent-Format: \"application/dots+cbor\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "{\n  \"ietf-dots-signal-channel:heartbeat\": {\n     \"peer-hb-status\": true\n   }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Header: (Code=2.04)",
      "zh-CHS": "标题：（代码=2.04）"
    },
    {
      "indent": 0,
      "text": "module: ietf-dots-signal-channel",
      "zh-CHS": "模块：ietf dots信号通道"
    },
    {
      "indent": 0,
      "text": "  structure dots-signal:\n    +-- (message-type)?\n       +--:(mitigation-scope)\n       |  +-- scope* []\n       |     +-- target-prefix*                inet:ip-prefix\n       |     +-- target-port-range* [lower-port]\n       |     |  +-- lower-port    inet:port-number\n       |     |  +-- upper-port?   inet:port-number\n       |     +-- target-protocol*              uint8\n       |     +-- target-fqdn*                  inet:domain-name\n       |     +-- target-uri*                   inet:uri\n       |     +-- alias-name*                   string\n       |     +-- lifetime?                     union\n       |     +-- trigger-mitigation?           boolean\n       |     +-- (direction)?\n       |        +--:(server-to-client-only)\n       |        |  +-- mid?                    uint32\n       |        |  +-- mitigation-start?       uint64\n       |        |  +-- status?\n       |        |  |       iana-dots-signal:status\n       |        |  +-- conflict-information\n       |        |  |  +-- conflict-status?\n       |        |  |  |       iana-dots-signal:conflict-status\n       |        |  |  +-- conflict-cause?\n       |        |  |  |       iana-dots-signal:conflict-cause\n       |        |  |  +-- retry-timer?       uint32\n       |        |  |  +-- conflict-scope\n       |        |  |     +-- target-prefix*       inet:ip-prefix\n       |        |  |     +-- target-port-range* [lower-port]\n       |        |  |     |  +-- lower-port    inet:port-number\n       |        |  |     |  +-- upper-port?   inet:port-number\n       |        |  |     +-- target-protocol*     uint8\n       |        |  |     +-- target-fqdn*         inet:domain-name\n       |        |  |     +-- target-uri*          inet:uri\n       |        |  |     +-- alias-name*          string\n       |        |  |     +-- acl-list* [acl-name]\n       |        |  |     |  +-- acl-name    leafref\n       |        |  |     |  +-- acl-type?   leafref\n       |        |  |     +-- mid?                 uint32\n       |        |  +-- bytes-dropped?\n       |        |  |       yang:zero-based-counter64\n       |        |  +-- bps-dropped?            yang:gauge64\n       |        |  +-- pkts-dropped?\n       |        |  |       yang:zero-based-counter64\n       |        |  +-- pps-dropped?            yang:gauge64\n       |        +--:(client-to-server-only)\n       |           +-- attack-status?\n       |                   iana-dots-signal:attack-status\n       +--:(signal-config)\n       |  +-- mitigating-config\n       |  |  +-- heartbeat-interval\n       |  |  |  +-- (direction)?\n       |  |  |  |  +--:(server-to-client-only)\n       |  |  |  |     +-- max-value?   uint16\n       |  |  |  |     +-- min-value?   uint16\n       |  |  |  +-- current-value?     uint16\n       |  |  +-- missing-hb-allowed\n       |  |  |  +-- (direction)?\n       |  |  |  |  +--:(server-to-client-only)\n       |  |  |  |     +-- max-value?   uint16\n       |  |  |  |     +-- min-value?   uint16\n       |  |  |  +-- current-value?     uint16\n       |  |  +-- probing-rate\n       |  |  |  +-- (direction)?\n       |  |  |  |  +--:(server-to-client-only)\n       |  |  |  |     +-- max-value?   uint16\n       |  |  |  |     +-- min-value?   uint16\n       |  |  |  +-- current-value?     uint16\n       |  |  +-- max-retransmit\n       |  |  |  +-- (direction)?\n       |  |  |  |  +--:(server-to-client-only)\n       |  |  |  |     +-- max-value?   uint16\n       |  |  |  |     +-- min-value?   uint16\n       |  |  |  +-- current-value?     uint16\n       |  |  +-- ack-timeout\n       |  |  |  +-- (direction)?\n       |  |  |  |  +--:(server-to-client-only)\n       |  |  |  |     +-- max-value-decimal?   decimal64\n       |  |  |  |     +-- min-value-decimal?   decimal64\n       |  |  |  +-- current-value-decimal?     decimal64\n       |  |  +-- ack-random-factor\n       |  |     +-- (direction)?\n       |  |     |  +--:(server-to-client-only)\n       |  |     |     +-- max-value-decimal?   decimal64\n       |  |     |     +-- min-value-decimal?   decimal64\n       |  |     +-- current-value-decimal?     decimal64\n       |  +-- idle-config\n       |     +-- heartbeat-interval\n       |     |  +-- (direction)?\n       |     |  |  +--:(server-to-client-only)\n       |     |  |     +-- max-value?   uint16\n       |     |  |     +-- min-value?   uint16\n       |     |  +-- current-value?     uint16\n       |     +-- missing-hb-allowed\n       |     |  +-- (direction)?\n       |     |  |  +--:(server-to-client-only)\n       |     |  |     +-- max-value?   uint16\n       |     |  |     +-- min-value?   uint16\n       |     |  +-- current-value?     uint16\n       |     +-- probing-rate\n       |     |  +-- (direction)?\n       |     |  |  +--:(server-to-client-only)\n       |     |  |     +-- max-value?   uint16\n       |     |  |     +-- min-value?   uint16\n       |     |  +-- current-value?     uint16\n       |     +-- max-retransmit\n       |     |  +-- (direction)?\n       |     |  |  +--:(server-to-client-only)\n       |     |  |     +-- max-value?   uint16\n       |     |  |     +-- min-value?   uint16\n       |     |  +-- current-value?     uint16\n       |     +-- ack-timeout\n       |     |  +-- (direction)?\n       |     |  |  +--:(server-to-client-only)\n       |     |  |     +-- max-value-decimal?   decimal64\n       |     |  |     +-- min-value-decimal?   decimal64\n       |     |  +-- current-value-decimal?     decimal64\n       |     +-- ack-random-factor\n       |        +-- (direction)?\n       |        |  +--:(server-to-client-only)\n       |        |     +-- max-value-decimal?   decimal64\n       |        |     +-- min-value-decimal?   decimal64\n       |        +-- current-value-decimal?     decimal64\n       +--:(redirected-signal)\n       |  +-- (direction)?\n       |     +--:(server-to-client-only)\n       |        +-- alt-server           inet:domain-name\n       |        +-- alt-server-record*   inet:ip-address\n       +--:(heartbeat)\n          +-- peer-hb-status             boolean\n<CODE BEGINS> file \"iana-dots-signal-channel@2021-09-02.yang\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "module iana-dots-signal-channel {\n  yang-version 1.1;\n  namespace \"urn:ietf:params:xml:ns:yang:iana-dots-signal-channel\";\n  prefix iana-dots-signal;",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "organization \"IANA\"; contact \"Internet Assigned Numbers Authority",
      "zh-CHS": "“IANA”组织；联系“互联网分配号码管理局”"
    },
    {
      "indent": 2,
      "text": " Postal: ICANN 12025 Waterfront Drive, Suite 300 Los Angeles, CA 90094-2536 United States of America Tel: +1 310 301 5800 <mailto:iana@iana.org>\"; description \"This module contains a collection of YANG data types defined by IANA and used for DOTS signal channel protocol.",
      "zh-CHS": "邮政：ICANN 12025 Waterfront Drive，加利福尼亚州洛杉矶300号套房90094-2536美利坚合众国电话：+1 310 301 5800<mailto:iana@iana.org>“说明”此模块包含IANA定义的用于DOTS信号通道协议的数据类型集合。"
    },
    {
      "indent": 5,
      "text": "Copyright (c) 2021 IETF Trust and the persons identified as authors of the code. All rights reserved.",
      "zh-CHS": "版权所有（c）2021 IETF信托基金和被确定为代码作者的人员。版权所有。"
    },
    {
      "indent": 5,
      "text": "Redistribution and use in source and binary forms, with or without modification, is permitted pursuant to, and subject to the license terms contained in, the Simplified BSD License set forth in Section 4.c of the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info).",
      "zh-CHS": "根据IETF信托有关IETF文件的法律规定第4.c节规定的简化BSD许可证中包含的许可条款，允许以源代码和二进制格式重新分发和使用，无论是否修改(http://trustee.ietf.org/license-info)."
    },
    {
      "indent": 5,
      "text": "This version of this YANG module is part of RFC 9132; see the RFC itself for full legal notices.\";",
      "zh-CHS": "该模块的此版本是RFC 9132的一部分；有关完整的法律通知，请参见RFC本身。“；"
    },
    {
      "indent": 2,
      "text": "revision 2021-09-02 {\n  description\n    \"Updated the prefix used for the module.\";\n  reference\n    \"RFC 9132: Distributed Denial-of-Service Open Threat\n               Signaling (DOTS) Signal Channel Specification\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "revision 2020-05-28 {\n  description\n    \"Initial revision.\";\n  reference\n    \"RFC 8782: Distributed Denial-of-Service Open Threat\n               Signaling (DOTS) Signal Channel Specification\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "typedef status {\n  type enumeration {\n    enum attack-mitigation-in-progress {\n      value 1;\n      description\n        \"Attack mitigation setup is in progress (e.g., changing\n         the network path to reroute the inbound traffic\n         to DOTS mitigator).\";\n    }\n    enum attack-successfully-mitigated {\n      value 2;\n      description\n        \"Attack is being successfully mitigated (e.g., traffic\n         is redirected to a DDoS mitigator and attack\n         traffic is dropped).\";\n    }\n    enum attack-stopped {\n      value 3;\n      description\n        \"Attack has stopped and the DOTS client can\n         withdraw the mitigation request.\";\n    }\n    enum attack-exceeded-capability {\n      value 4;\n      description\n        \"Attack has exceeded the mitigation provider\n         capability.\";\n    }\n    enum dots-client-withdrawn-mitigation {\n      value 5;\n      description\n        \"DOTS client has withdrawn the mitigation\n         request and the mitigation is active but\n         terminating.\";\n    }\n    enum attack-mitigation-terminated {\n      value 6;\n      description\n        \"Attack mitigation is now terminated.\";\n    }\n    enum attack-mitigation-withdrawn {\n      value 7;\n      description\n        \"Attack mitigation is withdrawn.\";\n    }\n    enum attack-mitigation-signal-loss {\n      value 8;\n      description\n        \"Attack mitigation will be triggered\n         for the mitigation request only when\n         the DOTS signal channel session is lost.\";\n    }\n  }\n  description\n    \"Enumeration for status reported by the DOTS server.\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "typedef conflict-status {\n  type enumeration {\n    enum request-inactive-other-active {\n      value 1;\n      description\n        \"DOTS server has detected conflicting mitigation\n         requests from different DOTS clients.\n         This mitigation request is currently inactive\n         until the conflicts are resolved.  Another\n         mitigation request is active.\";\n    }\n    enum request-active {\n      value 2;\n      description\n        \"DOTS server has detected conflicting mitigation\n         requests from different DOTS clients.\n         This mitigation request is currently active.\";\n    }\n    enum all-requests-inactive {\n      value 3;\n      description\n        \"DOTS server has detected conflicting mitigation\n         requests from different DOTS clients.  All\n         conflicting mitigation requests are inactive.\";\n    }\n  }\n  description\n    \"Enumeration for conflict status.\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "typedef conflict-cause {\n  type enumeration {\n    enum overlapping-targets {\n      value 1;\n      description\n        \"Overlapping targets. conflict-scope provides\n         more details about the exact conflict.\";\n    }\n    enum conflict-with-acceptlist {\n      value 2;\n      description\n        \"Conflicts with an existing accept-list.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "         This code is returned when the DDoS mitigation\n         detects that some of the source addresses/prefixes\n         listed in the accept-list ACLs are actually\n         attacking the target.\";\n    }\n    enum cuid-collision {\n      value 3;\n      description\n        \"Conflicts with the cuid used by another\n         DOTS client.\";\n    }\n  }\n  description\n    \"Enumeration for conflict causes.\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "  typedef attack-status {\n    type enumeration {\n      enum under-attack {\n        value 1;\n        description\n          \"The DOTS client determines that it is still under\n           attack.\";\n      }\n      enum attack-successfully-mitigated {\n        value 2;\n        description\n          \"The DOTS client determines that the attack is\n           successfully mitigated.\";\n      }\n    }\n    description\n      \"Enumeration for attack status codes.\";\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "<CODE ENDS><CODE BEGINS> file \"ietf-dots-signal-channel@2021-09-02.yang\"",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "module ietf-dots-signal-channel {\n  yang-version 1.1;\n  namespace \"urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel\";\n  prefix dots-signal;",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "import ietf-inet-types {\n  prefix inet;\n  reference\n    \"Section 4 of RFC 6991\";\n}\nimport ietf-yang-types {\n  prefix yang;\n  reference\n    \"Section 3 of RFC 6991\";\n}\nimport ietf-dots-data-channel {\n  prefix data-channel;\n  reference\n    \"RFC 8783: Distributed Denial-of-Service Open Threat Signaling\n               (DOTS) Data Channel Specification\";\n}\nimport iana-dots-signal-channel {\n  prefix iana-dots-signal;\n  reference\n    \"RFC 9132: Distributed Denial-of-Service Open Threat Signaling\n               (DOTS) Signal Channel Specification\";\n}\nimport ietf-yang-structure-ext {\n  prefix sx;\n  reference\n    \"RFC 8791: YANG Data Structure Extensions\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "organization\n  \"IETF DDoS Open Threat Signaling (DOTS) Working Group\";\ncontact\n  \"WG Web:   <https://datatracker.ietf.org/wg/dots/>\n   WG List:  <mailto:dots@ietf.org>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Editor:  Mohamed Boucadair\n         <mailto:mohamed.boucadair@orange.com>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Editor:  Jon Shallow\n         <mailto:supjps-ietf@jpshallow.com>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Author:  Konda, Tirumaleswar Reddy.K\n         <mailto:kondtir@gmail.com>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Author:  Prashanth Patil\n         <mailto:praspati@cisco.com>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 5,
      "text": "Author:  Andrew Mortensen\n         <mailto:amortensen@arbor.net>",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": " Author: Nik Teague <mailto:nteague@ironmountain.co.uk>\"; description \"This module contains YANG definition for the signaling messages exchanged between a DOTS client and a DOTS server.",
      "zh-CHS": "作者：Nik Teague<mailto:nteague@ironmountain.co.uk>“说明”此模块包含DOTS客户端和DOTS服务器之间交换的信令消息的定义。"
    },
    {
      "indent": 5,
      "text": "Copyright (c) 2021 IETF Trust and the persons identified as authors of the code. All rights reserved.",
      "zh-CHS": "版权所有（c）2021 IETF信托基金和被确定为代码作者的人员。版权所有。"
    },
    {
      "indent": 5,
      "text": "Redistribution and use in source and binary forms, with or without modification, is permitted pursuant to, and subject to the license terms contained in, the Simplified BSD License set forth in Section 4.c of the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info).",
      "zh-CHS": "根据IETF信托有关IETF文件的法律规定第4.c节规定的简化BSD许可证中包含的许可条款，允许以源代码和二进制格式重新分发和使用，无论是否修改(http://trustee.ietf.org/license-info)."
    },
    {
      "indent": 5,
      "text": "This version of this YANG module is part of RFC 9132; see the RFC itself for full legal notices.\";",
      "zh-CHS": "该模块的此版本是RFC 9132的一部分；有关完整的法律通知，请参见RFC本身。“；"
    },
    {
      "indent": 2,
      "text": "revision 2021-09-02 { description \"Updated revision to comply with RFC 8791.",
      "zh-CHS": "版本2021-09-02{说明“更新版本以符合RFC 8791。"
    },
    {
      "indent": 2,
      "text": "     This version is not backward compatible with the version\n     published in RFC 8782.\";\n  reference\n    \"RFC 9132: Distributed Denial-of-Service Open Threat\n               Signaling (DOTS) Signal Channel Specification\";\n}\nrevision 2020-05-28 {\n  description\n    \"Initial revision.\";\n  reference\n    \"RFC 8782: Distributed Denial-of-Service Open Threat\n               Signaling (DOTS) Signal Channel Specification\";\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "/*\n * Groupings\n */",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "grouping mitigation-scope {\n  description\n    \"Specifies the scope of the mitigation request.\";\n  list scope {\n    description\n      \"The scope of the request.\";\n    uses data-channel:target;\n    leaf-list alias-name {\n      type string;\n      description\n        \"An alias name that points to a resource.\";\n    }\n    leaf lifetime {\n      type union {\n        type uint32;\n        type int32 {\n          range \"-1\";\n        }\n      }\n      units \"seconds\";\n      default \"3600\";\n      description\n        \"Indicates the lifetime of the mitigation request.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 11,
      "text": "A lifetime of '0' in a mitigation request is an invalid value.",
      "zh-CHS": "缓解请求中的生存期“0”是无效值。"
    },
    {
      "indent": 11,
      "text": "A lifetime of negative one (-1) indicates indefinite lifetime for the mitigation request.",
      "zh-CHS": "生存期为负1（-1）表示缓解请求的生存期不确定。"
    },
    {
      "indent": 11,
      "text": "Lifetime is mandatory in a mitigation request.",
      "zh-CHS": "生存期在缓解请求中是必需的。"
    },
    {
      "indent": 6,
      "text": "     The DOTS server must always indicate the actual lifetime\n     in the response to an accepted mitigation request and the\n     remaining lifetime in status messages sent to the\n     DOTS client.\";\n}\nleaf trigger-mitigation {\n  type boolean;\n  default \"true\";\n  description\n    \"If set to 'false', DDoS mitigation will not be\n     triggered unless the DOTS signal channel\n     session is lost.\";\n}\nchoice direction {\n  description\n    \"Indicates the communication direction in which the\n     data nodes can be included.\";\n  case server-to-client-only {\n    description\n      \"These data nodes appear only in a mitigation message\n       sent from the server to the client.\";\n    leaf mid {\n      type uint32;\n      description\n        \"Mitigation request identifier.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 10,
      "text": "     This identifier must be unique for each mitigation\n     request bound to the DOTS client.\";\n}\nleaf mitigation-start {\n  type uint64;\n  description\n    \"Mitigation start time is represented in seconds\n     relative to 1970-01-01T00:00:00Z in UTC time.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 10,
      "text": "     This is a mandatory attribute when an attack\n     mitigation is active.  It must not be returned for\n     a mitigation with 'status' code set to 8.\";\n}\nleaf status {\n  type iana-dots-signal:status;\n  description\n    \"Indicates the status of a mitigation request.\n     It must be included in responses only.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 8,
      "text": "       This is a mandatory attribute if a mitigation\n       request is accepted and processed by the server.\";\n  }\n  container conflict-information {\n    description\n      \"Indicates that a conflict is detected.\";\n    leaf conflict-status {\n      type iana-dots-signal:conflict-status;\n      description\n        \"Indicates the conflict status.\";\n    }\n    leaf conflict-cause {\n      type iana-dots-signal:conflict-cause;\n      description\n        \"Indicates the cause of the conflict.\";\n    }\n    leaf retry-timer {\n      type uint32;\n      units \"seconds\";\n      description\n        \"The DOTS client must not resend the\n         same request that has a conflict before the expiry\n         of this timer.\";\n    }\n    container conflict-scope {\n      description\n        \"Provides more information about the conflict\n         scope.\";\n      uses data-channel:target {\n        when \"/dots-signal/scope/conflict-information/\"\n           + \"conflict-cause = 'overlapping-targets'\";\n      }\n      leaf-list alias-name {\n        when \"../../conflict-cause = 'overlapping-targets'\";\n        type string;\n        description\n          \"Conflicting alias-name.\";\n      }\n      list acl-list {\n        when \"../../conflict-cause =\"\n           + \" 'conflict-with-acceptlist'\";\n        key \"acl-name\";\n        description\n          \"List of conflicting ACLs, as defined in the DOTS\n           data channel.  These ACLs are uniquely defined by\n           cuid and acl-name.\";\n        leaf acl-name {\n          type leafref {\n            path \"/data-channel:dots-data\"\n               + \"/data-channel:dots-client\"\n               + \"/data-channel:acls\"\n               + \"/data-channel:acl/data-channel:name\";\n          }\n          description\n            \"Reference to the conflicting ACL name bound to\n             a DOTS client.\";\n        }\n        leaf acl-type {\n          type leafref {\n            path \"/data-channel:dots-data\"\n               + \"/data-channel:dots-client\"\n               + \"/data-channel:acls\"\n               + \"/data-channel:acl/data-channel:type\";\n          }\n          description\n            \"Reference to the conflicting ACL type bound to\n             a DOTS client.\";\n        }\n      }\n      leaf mid {\n        when \"../../conflict-cause = 'overlapping-targets'\";\n        type uint32;\n        description\n          \"Reference to the conflicting 'mid' bound to\n           the same DOTS client.\";\n      }\n    }\n  }\n  leaf bytes-dropped {\n    type yang:zero-based-counter64;\n    units \"bytes\";\n    description\n      \"The total dropped byte count for the mitigation\n       request since the attack mitigation was triggered.\n       The count wraps around when it reaches the maximum\n       value of counter64 for dropped bytes.\";\n  }\n  leaf bps-dropped {\n    type yang:gauge64;\n    units \"bytes per second\";\n    description\n      \"The average number of dropped bytes per second for\n       the mitigation request since the attack\n       mitigation was triggered.  This should be over\n       five-minute intervals (that is, measuring bytes\n       into five-minute buckets and then averaging these\n       buckets over the time since the mitigation was\n       triggered).\";\n  }\n  leaf pkts-dropped {\n    type yang:zero-based-counter64;\n    description\n      \"The total number of dropped packet count for the\n       mitigation request since the attack mitigation was\n       triggered.  The count wraps around when it reaches\n       the maximum value of counter64 for dropped packets.\";\n  }\n  leaf pps-dropped {\n    type yang:gauge64;\n    units \"packets per second\";\n    description\n      \"The average number of dropped packets per second\n       for the mitigation request since the attack\n       mitigation was triggered.  This should be over\n       five-minute intervals (that is, measuring packets\n       into five-minute buckets and then averaging these\n       buckets over the time since the mitigation was\n       triggered).\";\n  }\n}\ncase client-to-server-only {\n  description\n    \"These data nodes appear only in a mitigation message\n     sent from the client to the server.\";\n  leaf attack-status {\n    type iana-dots-signal:attack-status;\n    description\n      \"Indicates the status of an attack as seen by the\n       DOTS client.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "             This is a mandatory attribute when a client\n             performs an efficacy update.\";\n        }\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "grouping config-parameters {\n  description\n    \"Subset of DOTS signal channel session configuration.\";\n  container heartbeat-interval {\n    description\n      \"DOTS agents regularly send heartbeats to each other\n       after mutual authentication is successfully\n       completed in order to keep the DOTS signal channel\n       open.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value {\n          type uint16;\n          units \"seconds\";\n          description\n            \"Maximum acceptable heartbeat-interval value.\";\n        }\n        leaf min-value {\n          type uint16;\n          units \"seconds\";\n          description\n            \"Minimum acceptable heartbeat-interval value.\";\n        }\n      }\n    }\n    leaf current-value {\n      type uint16;\n      units \"seconds\";\n      default \"30\";\n      description\n        \"Current heartbeat-interval value.",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "         '0' means that heartbeat mechanism is deactivated.\";\n    }\n  }\n  container missing-hb-allowed {\n    description\n      \"Maximum number of missing heartbeats allowed.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value {\n          type uint16;\n          description\n            \"Maximum acceptable missing-hb-allowed value.\";\n        }\n        leaf min-value {\n          type uint16;\n          description\n            \"Minimum acceptable missing-hb-allowed value.\";\n        }\n      }\n    }\n    leaf current-value {\n      type uint16;\n      default \"15\";\n      description\n        \"Current missing-hb-allowed value.\";\n    }\n  }\n  container probing-rate {\n    description\n      \"The limit for sending Non-confirmable messages with\n       no response.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value {\n          type uint16;\n          units \"byte/second\";\n          description\n            \"Maximum acceptable probing-rate value.\";\n        }\n        leaf min-value {\n          type uint16;\n          units \"byte/second\";\n          description\n            \"Minimum acceptable probing-rate value.\";\n        }\n      }\n    }\n    leaf current-value {\n      type uint16;\n      units \"byte/second\";\n      default \"5\";\n      description\n        \"Current probing-rate value.\";\n    }\n  }\n  container max-retransmit {\n    description\n      \"Maximum number of retransmissions of a Confirmable\n       message.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value {\n          type uint16;\n          description\n            \"Maximum acceptable max-retransmit value.\";\n        }\n        leaf min-value {\n          type uint16;\n          description\n            \"Minimum acceptable max-retransmit value.\";\n        }\n      }\n    }\n    leaf current-value {\n      type uint16;\n      default \"3\";\n      description\n        \"Current max-retransmit value.\";\n    }\n  }\n  container ack-timeout {\n    description\n      \"Initial retransmission timeout value.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value-decimal {\n          type decimal64 {\n            fraction-digits 2;\n          }\n          units \"seconds\";\n          description\n            \"Maximum ack-timeout value.\";\n        }\n        leaf min-value-decimal {\n          type decimal64 {\n            fraction-digits 2;\n          }\n          units \"seconds\";\n          description\n            \"Minimum ack-timeout value.\";\n        }\n      }\n    }\n    leaf current-value-decimal {\n      type decimal64 {\n        fraction-digits 2;\n      }\n      units \"seconds\";\n      default \"2\";\n      description\n        \"Current ack-timeout value.\";\n    }\n  }\n  container ack-random-factor {\n    description\n      \"Random factor used to influence the timing of\n       retransmissions.\";\n    choice direction {\n      description\n        \"Indicates the communication direction in which the\n         data nodes can be included.\";\n      case server-to-client-only {\n        description\n          \"These data nodes appear only in a mitigation message\n           sent from the server to the client.\";\n        leaf max-value-decimal {\n          type decimal64 {\n            fraction-digits 2;\n          }\n          description\n            \"Maximum acceptable ack-random-factor value.\";\n        }\n        leaf min-value-decimal {\n          type decimal64 {\n            fraction-digits 2;\n          }\n          description\n            \"Minimum acceptable ack-random-factor value.\";\n        }\n      }\n    }\n    leaf current-value-decimal {\n      type decimal64 {\n        fraction-digits 2;\n      }\n      default \"1.5\";\n      description\n        \"Current ack-random-factor value.\";\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "grouping signal-config {\n  description\n    \"DOTS signal channel session configuration.\";\n  container mitigating-config {\n    description\n      \"Configuration parameters to use when a mitigation\n       is active.\";\n    uses config-parameters;\n  }\n  container idle-config {\n    description\n      \"Configuration parameters to use when no mitigation\n       is active.\";\n    uses config-parameters;\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "grouping redirected-signal {\n  description\n    \"Grouping for the redirected signaling.\";\n  choice direction {\n    description\n      \"Indicates the communication direction in which the\n       data nodes can be included.\";\n    case server-to-client-only {\n      description\n        \"These data nodes appear only in a mitigation message\n         sent from the server to the client.\";\n      leaf alt-server {\n        type inet:domain-name;\n        mandatory true;\n        description\n          \"FQDN of an alternate server.\";\n      }\n      leaf-list alt-server-record {\n        type inet:ip-address;\n        description\n          \"List of records for the alternate server.\";\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "/*\n * DOTS Signal Channel Structure\n */",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 2,
      "text": "sx:structure dots-signal { description \"Main structure for DOTS signal message.",
      "zh-CHS": "结构dots信号{description“dots信号消息的主要结构。"
    },
    {
      "indent": 0,
      "text": "       A DOTS signal message can be a mitigation, a configuration,\n       a redirected, or a heartbeat signal message.\";\n    choice message-type {\n      description\n        \"Can be a mitigation, a configuration, a redirect, or\n         a heartbeat message.\";\n      case mitigation-scope {\n        description\n          \"Mitigation scope of a mitigation message.\";\n        uses mitigation-scope;\n      }\n      case signal-config {\n        description\n          \"Configuration message.\";\n        uses signal-config;\n      }\n      case redirected-signal {\n        description\n          \"Redirected signaling.\";\n        uses redirected-signal;\n      }\n      case heartbeat {\n        description\n          \"DOTS heartbeats.\";\n        leaf peer-hb-status {\n          type boolean;\n          mandatory true;\n          description\n            \"Indicates whether a DOTS agent receives heartbeats\n             from its peer.  The value is set to 'true' if the\n             DOTS agent is receiving heartbeat messages\n             from its peer.\";\n        }\n      }\n    }\n  }\n}",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "<CODE ENDS> DOTS Client DOTS Server",
      "zh-CHS": "<CODE ENDS>DOTS客户端DOTS服务器"
    },
    {
      "indent": 4,
      "text": "ClientHello\n(0-RTT DOTS signal message)\n                          -------->\n                                                ServerHello\n                                      {EncryptedExtensions}\n                                                 {Finished}\n                          <--------   [DOTS signal message]\n(end_of_early_data)\n{Finished}                -------->\n[DOTS signal message]     <------->   [DOTS signal message]",
      "raw": true,
      "zh-CHS": " "
    },
    {
      "indent": 0,
      "text": "Note that: () Indicates messages protected 0-RTT keys {} Indicates messages protected using handshake keys [] Indicates messages protected using 1-RTT keys",
      "zh-CHS": "注意：（）表示受0-RTT密钥保护的消息{}表示使用握手密钥保护的消息[]表示使用1-RTT密钥保护的消息"
    },
    {
      "indent": 0,
      "text": "+---------------------------------------------+\n|       example.com domain       +---------+  |\n|                                | AAA     |  |\n| +---------------+              | Server  |  |\n| | Application   |              +------+--+  |\n| | server        +<---------------+    ^     |\n| | (DOTS client) |                |    |     |\n| +---------------+                |    |     |\n|                                  V    V     |   example.net domain\n|                            +-----+----+--+  |    +---------------+\n| +--------------+           |             |  |    |               |\n| |   Guest      +<----x---->+    DOTS     +<----->+    DOTS       |\n| | (DOTS client)|           |    gateway  |  |    |    server     |\n| +--------------+           |             |  |    |               |\n|                            +----+--------+  |    +---------------+\n|                                 ^           |\n|                                 |           |\n| +----------------+              |           |\n| | DDoS detector  |              |           |\n| | (DOTS client)  +<-------------+           |\n| +----------------+                          |\n+---------------------------------------------+",
      "raw": true,
      "zh-CHS": " "
    }
  ]
}